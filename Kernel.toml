# Rux 内核配置文件
#
# 这个文件定义了内核的编译选项和功能特性
# 修改后运行 `cargo build` 重新编译内核

[general]
# 内核名称
name = "Rux"
# 版本号
version = "0.1.0"
# 开发者信息
authors = ["Rux Developers"]

[platform]
# 目标平台: "aarch64", "x86_64", "riscv64"
default_platform = "riscv64"
# 启用的平台
enable_aarch64 = true
enable_x86_64 = false
enable_riscv64 = true

[memory]
# 内核堆大小 (MB)
kernel_heap_size = 16
# 物理内存大小 (MB)
physical_memory = 2048
# 页大小
page_size = 4096
# 用户栈大小 (MB)
user_stack_size = 8
# 最大页表数量（fork 需要复制整个页表）
max_page_tables = 1024

[smp]
# 启用多核支持 (SMP)
enable_smp = true
# 最大 CPU 数量
max_cpus = 4

[scheduler]
# 启用调度器
enable_scheduler = true
# 默认时间片 (毫秒)
default_time_slice_ms = 100
# 时间片滴答数
time_slice_ticks = 10

[network]
# 启用网络协议栈
enable_network = true
# 以太网 MTU
eth_mtu = 1500
# TCP 套接字表大小
tcp_socket_table_size = 64
# UDP 套接字表大小
udp_socket_table_size = 64
# ARP 缓存大小
arp_cache_size = 64
# 路由表大小
route_table_size = 64
# IPv4 默认 TTL
ip_default_ttl = 64

[boot]
# 启用图形输出
graphics = false
# 启用早期调试输出
early_debug = true
# 启用自检
self_test = false

[drivers]
# 驱动支持
enable_uart = true
enable_timer = true
enable_gic = false
enable_virtio = false
enable_pci = false
# VirtIO 网络设备探测
enable_virtio_net_probe = true

# 子功能使能
[features]
# 网络协议栈子功能
enable_tcp = true
enable_udp = true
enable_arp = true
enable_ipv4 = true
enable_ethernet = true
# 系统功能
enable_signal = true
enable_vm = true
# 文件系统功能
enable_vfs = true
enable_pipe = true

# 调试选项
[debug]
# 启用调试输出
debug_output = true
# 启用性能分析
profiling = false
# 启用内存跟踪
memory_trace = false
# 启用中断跟踪
irq_trace = false
# 日志级别: "error", "warn", "info", "debug", "trace"
log_level = "info"

# 性能调优
[performance]
# 优化级别: 0-3
opt_level = 3
# 启用LTO (链接时优化)
lto = true
# 代码生成单元 (1 = 更好的优化, 更大的二进制)
codegen_units = 1
# 启用本地符号
strip = true

# 安全选项
[security]
# 启用栈保护
stack_protector = false
# 启用边界检查
bounds_check = true
# 启用溢出检查
overflow_check = true
