# Rux å†…æ ¸é¡¹ç›®ç»“æ„

æœ¬æ–‡æ¡£æè¿° Rux å†…æ ¸é¡¹ç›®çš„ç›®å½•ç»“æ„å’Œæ–‡ä»¶ç»„ç»‡ã€‚

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

**æœ€åæ›´æ–°**: 2026-02-11

### æ€»ä½“ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **Rust æºæ–‡ä»¶æ€»æ•°** | 126 ä¸ª |
| **æ€»ä»£ç è¡Œæ•°** | **37,484 è¡Œ** |
| **å†…æ ¸å¤§å° (debug)** | ~3 MB |

### æ¨¡å—ä»£ç è¡Œæ•°åˆ†å¸ƒ

| æ¨¡å— | ä»£ç è¡Œæ•° | å æ¯” | è¯´æ˜ |
|------|----------|------|------|
| **fs/** | 9,020 | 24.1% | æ–‡ä»¶ç³»ç»Ÿ |
| **tests/** | 5,885 | 15.7% | å•å…ƒæµ‹è¯• |
| **arch/** | 6,129 | 16.4% | æ¶æ„ç›¸å…³ (RISC-V) |
| **drivers/** | 4,472 | 11.9% | è®¾å¤‡é©±åŠ¨ |
| **net/** | 3,626 | 9.7% | ç½‘ç»œåè®®æ ˆ |
| **process/** | 2,048 | 5.5% | è¿›ç¨‹ç®¡ç† |
| **sched/** | 1,416 | 3.8% | è¿›ç¨‹è°ƒåº¦ |
| **mm/** | 1,224 | 3.3% | å†…å­˜ç®¡ç† |
| **sync/** | 699 | 1.9% | åŒæ­¥åŸè¯­ |
| **å…¶ä»–** | 965 | 2.6% | ä¸»å…¥å£ã€é…ç½®ç­‰ |

### æ ¸å¿ƒæ–‡ä»¶ Top 20

| æ–‡ä»¶ | è¡Œæ•° | æ¨¡å— | è¯´æ˜ |
|------|------|------|------|
| [arch/riscv64/syscall.rs](../../kernel/src/arch/riscv64/syscall.rs) | 3,400 | arch | RISC-V ç³»ç»Ÿè°ƒç”¨å¤„ç† |
| [fs/vfs.rs](../../kernel/src/fs/vfs.rs) | 1,823 | fs | è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ |
| [fs/ext4/mod.rs](../../kernel/src/fs/ext4/mod.rs) | 1,651 | fs | ext4 æ–‡ä»¶ç³»ç»Ÿ |
| [drivers/intc/gicv3.rs](../../kernel/src/drivers/intc/gicv3.rs) | 1,465 | drivers | GICv3 ä¸­æ–­æ§åˆ¶å™¨ |
| [arch/riscv64/mm.rs](../../kernel/src/arch/riscv64/mm.rs) | 1,420 | arch | RISC-V å†…å­˜ç®¡ç† |
| [net/tcp.rs](../../kernel/src/net/tcp.rs) | 1,067 | net | TCP åè®® |
| [fs/dentry.rs](../../kernel/src/fs/dentry.rs) | 1,012 | fs | ç›®å½•é¡¹ç¼“å­˜ |
| [fs/ext4/file.rs](../../kernel/src/fs/ext4/file.rs) | 930 | fs | ext4 æ–‡ä»¶æ“ä½œ |
| [net/buffer.rs](../../kernel/src/net/buffer.rs) | 887 | net | ç½‘ç»œç¼“å†²åŒº (SkBuff) |
| [fs/path.rs](../../kernel/src/fs/path.rs) | 874 | fs | è·¯å¾„è§£æ |
| [fs/inode.rs](../../kernel/src/fs/inode.rs) | 826 | fs | Inode ç¼“å­˜ |
| [net/ipv4/mod.rs](../../kernel/src/net/ipv4/mod.rs) | 802 | net | IPv4 åè®® |
| [process/task.rs](../../kernel/src/process/task.rs) | 798 | process | ä»»åŠ¡æ§åˆ¶å— |
| [drivers/net/virtio_net.rs](../../kernel/src/drivers/net/virtio_net.rs) | 514 | drivers | VirtIO ç½‘å¡é©±åŠ¨ |
| [fs/ext4/allocator.rs](../../kernel/src/fs/ext4/allocator.rs) | 507 | fs | ext4 åˆ†é…å™¨ |
| [sched/sched.rs](../../kernel/src/sched/sched.rs) | 506 | sched | è°ƒåº¦å™¨ + fork |
| [arch/riscv64/trap.rs](../../kernel/src/arch/riscv64/trap.rs) | 446 | arch | å¼‚å¸¸å¤„ç† |
| [fs/vfs_ops.rs](../../kernel/src/fs/vfs_ops.rs) | 438 | fs | VFS æ“ä½œ |
| [fs/rootfs.rs](../../kernel/src/fs/rootfs.rs) | 409 | fs | Root æ–‡ä»¶ç³»ç»Ÿ |
| [net/ethernet.rs](../../kernel/src/net/ethernet.rs) | 396 | net | ä»¥å¤ªç½‘å±‚ |

### æµ‹è¯•æ–‡ä»¶ç»Ÿè®¡

| æµ‹è¯•æ¨¡å— | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° | çŠ¶æ€ |
|----------|--------|----------|------|
| **åŸºç¡€æµ‹è¯•** | 5 | ~1,200 | âœ… |
| **å†…å­˜æµ‹è¯•** | 4 | ~800 | âœ… |
| **è¿›ç¨‹æµ‹è¯•** | 8 | ~1,400 | âœ… |
| **æ–‡ä»¶ç³»ç»Ÿæµ‹è¯•** | 9 | ~1,200 | âœ… |
| **IPC æµ‹è¯•** | 4 | ~500 | âœ… |
| **ç½‘ç»œæµ‹è¯•** | 4 | ~600 | âœ… |
| **é©±åŠ¨æµ‹è¯•** | 3 | ~500 | âœ… |
| **å…¶ä»–æµ‹è¯•** | 6 | ~685 | âœ… |
| **æ€»è®¡** | **43** | **5,885** | **99% é€šè¿‡** |

---

## ç›®å½•ç»“æ„

```
Rux/
â”œâ”€â”€ build/                  # æ„å»ºå’Œé…ç½®å·¥å…·
â”‚   â”œâ”€â”€ Makefile           # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ menuconfig.sh      # äº¤äº’å¼é…ç½®å·¥å…·
â”‚   â””â”€â”€ config-demo.sh     # é…ç½®æ¼”ç¤ºè„šæœ¬
â”‚
â”œâ”€â”€ test/                   # æµ‹è¯•å’Œè°ƒè¯•è„šæœ¬
â”‚   â”œâ”€â”€ test_suite.sh      # å®Œæ•´æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ test_qemu.sh       # QEMU æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ run.sh             # å¿«é€Ÿè¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ run_unit_tests.sh  # å•å…ƒæµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ debug.sh           # GDB è°ƒè¯•è„šæœ¬
â”‚
â”œâ”€â”€ docs/                   # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ CONFIG.md          # é…ç½®ç³»ç»Ÿæ–‡æ¡£
â”‚   â”œâ”€â”€ TODO.md            # å¼€å‘è·¯çº¿å›¾
â”‚   â”œâ”€â”€ QUICKREF.md        # å¿«é€Ÿå‚è€ƒ
â”‚   â”œâ”€â”€ architecture/      # æ¶æ„æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ riscv64.md     # RISC-V æ¶æ„è¯´æ˜
â”‚   â”‚   â””â”€â”€ structure.md   # æœ¬æ–‡ä»¶ - ç›®å½•ç»“æ„è¯´æ˜
â”‚   â”œâ”€â”€ development/       # å¼€å‘æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ changelog.md   # å˜æ›´æ—¥å¿—
â”‚   â”‚   â””â”€â”€ user-programs.md # ç”¨æˆ·ç¨‹åºæŒ‡å—
â”‚   â”œâ”€â”€ progress/          # è¿›åº¦æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ roadmap.md     # å¼€å‘è·¯çº¿å›¾
â”‚   â”œâ”€â”€ tests/             # æµ‹è¯•æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ unit-test-report.md # å•å…ƒæµ‹è¯•æŠ¥å‘Š
â”‚   â””â”€â”€ guides/            # æŒ‡å—æ–‡æ¡£
â”‚
â”œâ”€â”€ kernel/                 # å†…æ ¸æºä»£ç 
â”‚   â”œâ”€â”€ src/               # Rust æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ arch/         # æ¶æ„ç›¸å…³ä»£ç 
â”‚   â”‚   â”‚   â””â”€â”€ riscv64/  # RISC-V æ¶æ„å®ç°
â”‚   â”‚   â”‚       â”œâ”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚       â”œâ”€â”€ boot.S       # å¯åŠ¨ä»£ç  (æ±‡ç¼–)
â”‚   â”‚   â”‚       â”œâ”€â”€ trap.S       # å¼‚å¸¸å‘é‡è¡¨ (æ±‡ç¼–)
â”‚   â”‚   â”‚       â”œâ”€â”€ boot.rs      # åˆå§‹åŒ–
â”‚   â”‚   â”‚       â”œâ”€â”€ trap.rs      # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚       â”œâ”€â”€ syscall.rs   # ç³»ç»Ÿè°ƒç”¨å¤„ç† (3,400è¡Œ)
â”‚   â”‚   â”‚       â”œâ”€â”€ mm.rs        # å†…å­˜ç®¡ç† (1,420è¡Œ)
â”‚   â”‚   â”‚       â”œâ”€â”€ smp.rs       # å¤šæ ¸æ”¯æŒ
â”‚   â”‚   â”‚       â”œâ”€â”€ ipi.rs       # å¤„ç†å™¨é—´ä¸­æ–­
â”‚   â”‚   â”‚       â”œâ”€â”€ context.rs   # ä¸Šä¸‹æ–‡åˆ‡æ¢
â”‚   â”‚   â”‚       â””â”€â”€ cpu.rs       # CPU æ“ä½œ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ drivers/      # è®¾å¤‡é©±åŠ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # é©±åŠ¨æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ intc/        # ä¸­æ–­æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ plic.rs     # RISC-V PLIC é©±åŠ¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ clint.rs    # RISC-V CLINT é©±åŠ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ timer/       # å®šæ—¶å™¨é©±åŠ¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ riscv64.rs  # RISC-V å®šæ—¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ virtio/      # VirtIO æ¡†æ¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs      # VirtIO æ¨¡å—
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ queue.rs    # VirtQueue å®ç°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ probe.rs    # è®¾å¤‡æ¢æµ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ blkdev/      # å—è®¾å¤‡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mod.rs      # VirtIO-blk é©±åŠ¨
â”‚   â”‚   â”‚   â””â”€â”€ net/         # ç½‘ç»œè®¾å¤‡
â”‚   â”‚   â”‚       â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚       â”œâ”€â”€ space.rs    # ç½‘ç»œè®¾å¤‡åŸºç±»
â”‚   â”‚   â”‚       â”œâ”€â”€ loopback.rs # å›ç¯è®¾å¤‡
â”‚   â”‚   â”‚       â””â”€â”€ virtio_net.rs # VirtIO-net é©±åŠ¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ mm/           # å†…å­˜ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ page.rs      # é¡µç®¡ç† (PhysFrame/VirtPage)
â”‚   â”‚   â”‚   â”œâ”€â”€ allocator.rs # å †åˆ†é…å™¨ (BuddyAllocator)
â”‚   â”‚   â”‚   â”œâ”€â”€ pagemap.rs   # é¡µè¡¨ç®¡ç† (å¹³å°æ— å…³æ¥å£)
â”‚   â”‚   â”‚   â””â”€â”€ vma.rs       # è™šæ‹Ÿå†…å­˜åŒºåŸŸ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ fs/           # æ–‡ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ vfs.rs       # è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ (1,823è¡Œ)
â”‚   â”‚   â”‚   â”œâ”€â”€ vfs_ops.rs   # VFS æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ file.rs      # æ–‡ä»¶æè¿°ç¬¦
â”‚   â”‚   â”‚   â”œâ”€â”€ inode.rs     # Inode ç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ dentry.rs    # ç›®å½•é¡¹ç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ buffer.rs    # å—ç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ mount.rs     # æŒ‚è½½ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ superblock.rs # è¶…çº§å—
â”‚   â”‚   â”‚   â”œâ”€â”€ path.rs      # è·¯å¾„è§£æ
â”‚   â”‚   â”‚   â”œâ”€â”€ rootfs.rs    # Root æ–‡ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ pipe.rs      # ç®¡é“å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ char_dev.rs  # å­—ç¬¦è®¾å¤‡
â”‚   â”‚   â”‚   â”œâ”€â”€ elf.rs       # ELF åŠ è½½å™¨
â”‚   â”‚   â”‚   â””â”€â”€ ext4/        # ext4 æ–‡ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”‚       â”œâ”€â”€ mod.rs      # ext4 ä¸»æ¨¡å—
â”‚   â”‚   â”‚       â”œâ”€â”€ superblock.rs # è¶…çº§å—è§£æ
â”‚   â”‚   â”‚       â”œâ”€â”€ inode.rs    # Inode ç»“æ„
â”‚   â”‚   â”‚       â”œâ”€â”€ allocator.rs # å—/Inode åˆ†é…å™¨
â”‚   â”‚   â”‚       â””â”€â”€ file.rs     # æ–‡ä»¶æ“ä½œ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ net/          # ç½‘ç»œåè®®æ ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # ç½‘ç»œæ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ buffer.rs    # SkBuff (ç½‘ç»œç¼“å†²åŒº)
â”‚   â”‚   â”‚   â”œâ”€â”€ socket.rs    # Socket å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ethernet.rs  # ä»¥å¤ªç½‘å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ arp.rs       # ARP åè®®
â”‚   â”‚   â”‚   â”œâ”€â”€ ipv4/        # IPv4 åè®®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.rs   # è·¯ç”±è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ tcp.rs       # TCP åè®®
â”‚   â”‚   â”‚   â””â”€â”€ udp.rs       # UDP åè®®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ process/      # è¿›ç¨‹ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ task.rs      # ä»»åŠ¡æ§åˆ¶å—
â”‚   â”‚   â”‚   â”œâ”€â”€ pid.rs       # PID åˆ†é…å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ usermod.rs   # ç”¨æˆ·æ¨¡å¼ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ wait.rs      # wait4 ç³»ç»Ÿè°ƒç”¨
â”‚   â”‚   â”‚   â””â”€â”€ signal.rs    # ä¿¡å·å¤„ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ sched/        # è¿›ç¨‹è°ƒåº¦
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ sched.rs     # è°ƒåº¦å™¨ + fork (506è¡Œ)
â”‚   â”‚   â”‚   â””â”€â”€ pid.rs       # PID ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ sync/         # åŒæ­¥åŸè¯­
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ mutex.rs     # Mutex é”
â”‚   â”‚   â”‚   â”œâ”€â”€ semaphore.rs # ä¿¡å·é‡ (411è¡Œ)
â”‚   â”‚   â”‚   â””â”€â”€ condvar.rs   # æ¡ä»¶å˜é‡ (260è¡Œ)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ tests/        # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs       # æµ‹è¯•æ¡†æ¶å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ boundary.rs  # è¾¹ç•Œæ¡ä»¶æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ listhead.rs  # åŒå‘é“¾è¡¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ path.rs      # è·¯å¾„è§£ææµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ file_flags.rs # æ–‡ä»¶æ ‡å¿—æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ fdtable.rs   # æ–‡ä»¶æè¿°ç¬¦è¡¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ heap_allocator.rs # å †åˆ†é…å™¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ page_allocator.rs # é¡µåˆ†é…å™¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.rs # è°ƒåº¦å™¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ signal.rs    # ä¿¡å·å¤„ç†æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ smp.rs       # å¤šæ ¸æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ process_tree.rs # è¿›ç¨‹æ ‘æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ fork.rs      # fork æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ execve.rs    # execve æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ wait4.rs     # wait4 æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ getpid.rs    # getpid æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ user_syscall.rs # ç”¨æˆ·ç³»ç»Ÿè°ƒç”¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ preemptive_scheduler.rs # æŠ¢å å¼è°ƒåº¦æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ sleep_wakeup.rs # ç¡çœ å”¤é†’æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ virtio_queue.rs # VirtIO é˜Ÿåˆ—æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ dcache.rs    # ç›®å½•é¡¹ç¼“å­˜æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ fstat.rs     # fstat æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ fcntl.rs     # fcntl æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ link.rs      # link æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ mkdir_unlink.rs # mkdir/unlink æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ ext4_allocator.rs # ext4 åˆ†é…å™¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ ext4_file_write.rs # ext4 å†™å…¥æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ ext4_indirect_blocks.rs # ext4 é—´æ¥å—æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ standard_alloc.rs # æ ‡å‡†åˆ†é…å™¨æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ network.rs   # ç½‘ç»œæµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ tcp_handshake.rs # TCP æ¡æ‰‹æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ virtio_net.rs # VirtIO-net æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ smp_schedule.rs # SMP è°ƒåº¦æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ pipe2.rs     # pipe2 æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ signal_procmask.rs # ä¿¡å·æ©ç æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ ipc_poll.rs  # poll æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ ipc_epoll.rs # epoll æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ ipc_eventfd.rs # eventfd æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ mem_mmap.rs  # mmap æµ‹è¯•
â”‚   â”‚   â”‚   â””â”€â”€ mem_cow.rs   # COW æµ‹è¯•
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ console.rs    # æ§åˆ¶å° (UART)
â”‚   â”‚   â”œâ”€â”€ config.rs     # è‡ªåŠ¨ç”Ÿæˆçš„é…ç½® (ä¸è¦æ‰‹åŠ¨ç¼–è¾‘)
â”‚   â”‚   â”œâ”€â”€ main.rs       # å†…æ ¸å…¥å£
â”‚   â”‚   â””â”€â”€ print.rs      # æ‰“å°å®
â”‚   â”‚
â”‚   â”œâ”€â”€ build.rs          # æ„å»ºè„šæœ¬ (ç”Ÿæˆ config.rs)
â”‚   â””â”€â”€ Cargo.toml        # å†…æ ¸ crate é…ç½®
â”‚
â”œâ”€â”€ .cargo/                 # Cargo é…ç½®
â”‚   â””â”€â”€ config.toml       # Cargo å·¥å…·é…ç½®
â”‚
â”œâ”€â”€ target/                 # ç¼–è¯‘è¾“å‡º (gitå¿½ç•¥)
â”‚   â””â”€â”€ riscv64gc-unknown-none-elf/
â”‚       â”œâ”€â”€ debug/        # Debug æ„å»º
â”‚       â””â”€â”€ release/      # Release æ„å»º
â”‚
â”œâ”€â”€ Kernel.toml            # å†…æ ¸é…ç½®æ–‡ä»¶
â”œâ”€â”€ Cargo.toml             # å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ Cargo.lock             # ä¾èµ–é”å®š
â”œâ”€â”€ Makefile               # é¡¹ç›®æ ¹ Makefile
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ CLAUDE.md              # AI åŠ©æ‰‹å¼€å‘æŒ‡å—
â”œâ”€â”€ LICENSE                # è®¸å¯è¯ (MIT)
â””â”€â”€ .gitignore             # Git å¿½ç•¥è§„åˆ™
```

---

## ç›®å½•è¯´æ˜

### build/ - æ„å»ºå·¥å…·ç›®å½•

åŒ…å«æ‰€æœ‰ä¸æ„å»ºã€é…ç½®ç›¸å…³çš„è„šæœ¬å’Œå·¥å…·ï¼š

- **Makefile** - ä¸»æ„å»ºè„šæœ¬ï¼Œæä¾›ç¼–è¯‘ã€è¿è¡Œã€æµ‹è¯•ç­‰å‘½ä»¤
- **menuconfig.sh** - äº¤äº’å¼é…ç½®èœå•ï¼ˆç±»ä¼¼ Linux kernel menuconfigï¼‰
- **config-demo.sh** - é…ç½®ç³»ç»Ÿæ¼”ç¤ºè„šæœ¬

### test/ - æµ‹è¯•ç›®å½•

åŒ…å«æ‰€æœ‰æµ‹è¯•å’Œè°ƒè¯•è„šæœ¬ï¼š

- **run.sh** - å¿«é€Ÿè¿è¡Œå†…æ ¸
- **run_unit_tests.sh** - è¿è¡Œå…¨é‡å•å…ƒæµ‹è¯•
- **test_qemu.sh** - QEMU åŸºæœ¬åŠŸèƒ½æµ‹è¯•
- **test_suite.sh** - å®Œæ•´çš„æµ‹è¯•å¥—ä»¶
- **debug.sh** - GDB è°ƒè¯•è„šæœ¬

### docs/ - æ–‡æ¡£ç›®å½•

é¡¹ç›®æ–‡æ¡£ï¼ŒæŒ‰ç±»å‹ç»„ç»‡ï¼š

#### architecture/ - æ¶æ„æ–‡æ¡£
- **riscv64.md** - RISC-V æ¶æ„è¯¦ç»†è¯´æ˜
- **structure.md** - æœ¬æ–‡ä»¶ï¼Œç›®å½•ç»“æ„è¯´æ˜

#### development/ - å¼€å‘æ–‡æ¡£
- **changelog.md** - å˜æ›´æ—¥å¿—å’Œç‰ˆæœ¬å†å²
- **user-programs.md** - ç”¨æˆ·ç¨‹åºå¼€å‘æŒ‡å—

#### progress/ - è¿›åº¦æ–‡æ¡£
- **roadmap.md** - å¼€å‘è·¯çº¿å›¾å’ŒåŠŸèƒ½æ¸…å•

#### tests/ - æµ‹è¯•æ–‡æ¡£
- **unit-test-report.md** - å…¨é‡å•å…ƒæµ‹è¯•è¯¦ç»†æŠ¥å‘Š

### kernel/ - å†…æ ¸æºç 

å†…æ ¸çš„æ ¸å¿ƒæºä»£ç ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ã€‚

#### kernel/src/arch/ - æ¶æ„ç›¸å…³ä»£ç 

**é‡è¦**: å½“å‰**ä»…æ”¯æŒ RISC-V 64ä½æ¶æ„**ã€‚

```
kernel/src/arch/
â””â”€â”€ riscv64/         # RISC-V æ¶æ„å®ç°ï¼ˆé»˜è®¤ä¸”å”¯ä¸€æ”¯æŒçš„å¹³å°ï¼‰
    â”œâ”€â”€ boot.rs      # åˆå§‹åŒ– (17è¡Œ)
    â”œâ”€â”€ trap.rs      # å¼‚å¸¸å¤„ç† (446è¡Œ)
    â”œâ”€â”€ syscall.rs   # ç³»ç»Ÿè°ƒç”¨ (3,400è¡Œ - æœ€å¤§çš„å•æ–‡ä»¶)
    â”œâ”€â”€ mm.rs        # æ¶æ„ç›¸å…³å†…å­˜ç®¡ç† (1,420è¡Œ)
    â”œâ”€â”€ smp.rs       # å¤šæ ¸æ”¯æŒ (178è¡Œ)
    â”œâ”€â”€ ipi.rs       # å¤„ç†å™¨é—´ä¸­æ–­ (127è¡Œ)
    â”œâ”€â”€ context.rs   # ä¸Šä¸‹æ–‡åˆ‡æ¢ (269è¡Œ)
    â”œâ”€â”€ cpu.rs       # CPU æ“ä½œ (136è¡Œ)
    â””â”€â”€ mod.rs       # æ¨¡å—å¯¼å‡º (92è¡Œ)
```

**æ¶æ„æ”¯æŒçŠ¶æ€**:
- âœ… **RISC-V 64ä½ (RV64GC)** - å®Œå…¨æ”¯æŒï¼Œå½“å‰é»˜è®¤å¹³å°
- âŒ **ARM64 (aarch64)** - å·²ç§»é™¤ï¼Œä»£ç ä¸åœ¨å½“å‰ä»“åº“ä¸­
- âŒ **x86_64** - æœªå®ç°

#### kernel/src/drivers/ - è®¾å¤‡é©±åŠ¨ç¨‹åº

è®¾å¤‡é©±åŠ¨æŒ‰ç±»å‹ç»„ç»‡ï¼š

| å­ç›®å½• | åŠŸèƒ½ | ä¸»è¦æ–‡ä»¶ | ä»£ç é‡ |
|--------|------|----------|--------|
| **intc/** | ä¸­æ–­æ§åˆ¶å™¨ | plic.rs, clint.rs | ~500 è¡Œ |
| **timer/** | å®šæ—¶å™¨ | riscv64.rs | ~150 è¡Œ |
| **virtio/** | VirtIO æ¡†æ¶ | mod.rs, queue.rs, probe.rs | ~900 è¡Œ |
| **blkdev/** | å—è®¾å¤‡ | mod.rs (VirtIO-blk) | ~250 è¡Œ |
| **net/** | ç½‘ç»œè®¾å¤‡ | space.rs, loopback.rs, virtio_net.rs | ~1,000 è¡Œ |

#### kernel/src/mm/ - å†…å­˜ç®¡ç†ä»£ç 

| æ–‡ä»¶ | åŠŸèƒ½ | ä»£ç é‡ |
|------|------|--------|
| **page.rs** | ç‰©ç†é¡µ/è™šæ‹Ÿé¡µç®¡ç† | ~400 è¡Œ |
| **allocator.rs** | Buddy å †åˆ†é…å™¨ | ~300 è¡Œ |
| **pagemap.rs** | é¡µè¡¨ç®¡ç†ï¼ˆå¹³å°æ— å…³æ¥å£ï¼‰ | ~80 è¡Œ |
| **vma.rs** | è™šæ‹Ÿå†…å­˜åŒºåŸŸ | ~300 è¡Œ |

#### kernel/src/fs/ - æ–‡ä»¶ç³»ç»Ÿ

**æœ€å¤§çš„æ¨¡å—**ï¼ˆ9,020 è¡Œï¼Œå  24.1%ï¼‰ï¼š

| æ–‡ä»¶ | åŠŸèƒ½ | ä»£ç é‡ |
|------|------|--------|
| **vfs.rs** | è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ | 1,823 è¡Œ |
| **ext4/mod.rs** | ext4 æ–‡ä»¶ç³»ç»Ÿ | 1,651 è¡Œ |
| **dentry.rs** | ç›®å½•é¡¹ç¼“å­˜ | 1,012 è¡Œ |
| **ext4/file.rs** | ext4 æ–‡ä»¶æ“ä½œ | 930 è¡Œ |
| **path.rs** | è·¯å¾„è§£æ | 874 è¡Œ |
| **inode.rs** | Inode ç¼“å­˜ | 826 è¡Œ |
| **vfs_ops.rs** | VFS æ“ä½œ | 438 è¡Œ |
| **rootfs.rs** | Root æ–‡ä»¶ç³»ç»Ÿ | 409 è¡Œ |
| å…¶ä»– (buffer, mount, pipe, elf ç­‰) | - | ~2,000 è¡Œ |

#### kernel/src/net/ - ç½‘ç»œåè®®æ ˆ

| æ–‡ä»¶ | åŠŸèƒ½ | ä»£ç é‡ |
|------|------|--------|
| **tcp.rs** | TCP åè®® | 1,067 è¡Œ |
| **buffer.rs** | SkBuff | 887 è¡Œ |
| **ipv4/mod.rs** | IPv4 åè®® | 802 è¡Œ |
| **ethernet.rs** | ä»¥å¤ªç½‘å±‚ | 396 è¡Œ |
| å…¶ä»– (socket, arp, udp ç­‰) | - | ~500 è¡Œ |

#### kernel/src/process/ - è¿›ç¨‹ç®¡ç†

| æ–‡ä»¶ | åŠŸèƒ½ | ä»£ç é‡ |
|------|------|--------|
| **task.rs** | ä»»åŠ¡æ§åˆ¶å— | 798 è¡Œ |
| **signal.rs** | ä¿¡å·å¤„ç† | ~400 è¡Œ |
| **usermod.rs** | ç”¨æˆ·æ¨¡å¼ç®¡ç† | ~300 è¡Œ |
| **wait.rs** | wait4 ç³»ç»Ÿè°ƒç”¨ | ~200 è¡Œ |
| **pid.rs** | PID åˆ†é…å™¨ | ~100 è¡Œ |

#### kernel/src/sched/ - è¿›ç¨‹è°ƒåº¦

| æ–‡ä»¶ | åŠŸèƒ½ | ä»£ç é‡ |
|------|------|--------|
| **sched.rs** | è°ƒåº¦å™¨ + fork + COW | 506 è¡Œ |
| **pid.rs** | PID ç®¡ç† | ~100 è¡Œ |

#### kernel/src/sync/ - åŒæ­¥åŸè¯­

| æ–‡ä»¶ | åŠŸèƒ½ | ä»£ç é‡ |
|------|------|--------|
| **semaphore.rs** | ä¿¡å·é‡ | 411 è¡Œ |
| **condvar.rs** | æ¡ä»¶å˜é‡ | 260 è¡Œ |
| **mutex.rs** | Mutex é” | ~100 è¡Œ |

#### kernel/src/tests/ - å•å…ƒæµ‹è¯•

**43 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œ5,885 è¡Œä»£ç **ï¼Œè¯¦è§ [å•å…ƒæµ‹è¯•æŠ¥å‘Š](../tests/unit-test-report.md)ã€‚

---

## ä½¿ç”¨æŒ‡å—

### ç¼–è¯‘å†…æ ¸

ä»é¡¹ç›®æ ¹ç›®å½•ï¼š

```bash
make build
# æˆ–ç›´æ¥ä½¿ç”¨ Cargoï¼ˆé»˜è®¤ RISC-Vï¼‰
cargo build --package rux --features riscv64
```

### é…ç½®å†…æ ¸

```bash
make menuconfig
# æˆ–ç›´æ¥ç¼–è¾‘ Kernel.toml
vim Kernel.toml
```

### è¿è¡Œå†…æ ¸

```bash
make run
# æˆ–
./test/run.sh
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œå…¨é‡å•å…ƒæµ‹è¯•
./test/run_unit_tests.sh

# æˆ–è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./test/test_suite.sh
```

### è°ƒè¯•å†…æ ¸

```bash
make debug
# æˆ–
./test/debug.sh
```

---

## æ·»åŠ æ–°æ–‡ä»¶

### æ–°é©±åŠ¨

åœ¨ `kernel/src/drivers/` ä¸‹åˆ›å»ºæ–°æ¨¡å—ï¼š

1. åˆ›å»ºç›®å½•ï¼Œå¦‚ `drivers/block/`
2. åˆ›å»º `kernel/src/drivers/block/mod.rs`
3. åœ¨ `kernel/src/drivers/mod.rs` ä¸­æ·»åŠ  `pub mod block;`
4. å¯¼å‡ºéœ€è¦çš„æ¥å£ï¼š`pub use block::*;`

### æ–°æµ‹è¯•

åœ¨ `kernel/src/tests/` ä¸‹æ·»åŠ æ–°æ–‡ä»¶ï¼š

1. åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼Œå¦‚ `tests/new_feature.rs`
2. åœ¨ `kernel/src/tests/mod.rs` ä¸­æ·»åŠ  `pub mod new_feature;`
3. è¿è¡Œæµ‹è¯•éªŒè¯åŠŸèƒ½

### æ–°æ¶æ„æ”¯æŒ

**æ³¨æ„**: å½“å‰ä»…æ”¯æŒ RISC-V 64ä½ã€‚æ·»åŠ æ–°æ¶æ„ï¼ˆå¦‚ x86_64ï¼‰éœ€è¦ï¼š

1. åœ¨ `kernel/src/arch/` ä¸‹åˆ›å»ºæ–°ç›®å½•ï¼Œå¦‚ `arch/x86_64/`
2. å®ç°å¿…è¦çš„æ¥å£ï¼ˆboot, trap, syscall, mm ç­‰ï¼‰
3. åœ¨ `kernel/Cargo.toml` ä¸­æ·»åŠ å¯¹åº”çš„ feature
4. æ·»åŠ å¯¹åº”çš„é“¾æ¥è„šæœ¬

---

## æ³¨æ„äº‹é¡¹

1. **config.rs æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„** - ä¸è¦æ‰‹åŠ¨ç¼–è¾‘ `kernel/src/config.rs`ï¼Œå®ƒç”± `kernel/build.rs` æ ¹æ® `Kernel.toml` è‡ªåŠ¨ç”Ÿæˆã€‚

2. **å¹³å°é™åˆ¶** - å½“å‰ä»…æ”¯æŒ RISC-V 64ä½æ¶æ„ã€‚ARM64 æ”¯æŒå·²ç§»é™¤ï¼Œx86_64 æœªå®ç°ã€‚

3. **æµ‹è¯•è¦†ç›–** - 43 ä¸ªæµ‹è¯•æ¨¡å—ï¼Œ203 ä¸ªæµ‹è¯•é¡¹ï¼Œ99% é€šè¿‡ç‡ã€‚

4. **ä»£ç è§„èŒƒ** - éµå¾ª Linux å†…æ ¸è®¾è®¡åŸåˆ™ï¼ŒPOSIX/ABI å®Œå…¨å…¼å®¹ã€‚

5. **æ¨¡å—å¯¼å‡º** - æ·»åŠ æ–°æ¨¡å—æ—¶ï¼Œç¡®ä¿åœ¨çˆ¶æ¨¡å—çš„ `mod.rs` ä¸­æ­£ç¡®å¯¼å‡ºéœ€è¦çš„æ¥å£ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v4.0
**æœ€åæ›´æ–°**: 2026-02-11
**ç»´æŠ¤è€…**: Rux å¼€å‘å›¢é˜Ÿ
