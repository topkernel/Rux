# Rux å¼€å‘è·¯çº¿å›¾ä¸TODO

## é¡¹ç›®æ¦‚è§ˆ

**å½“å‰çŠ¶æ€**ï¼šPhase 10 å®Œæˆ âœ… - RISC-V 64ä½æ¶æ„æ”¯æŒ

**æœ€åæ›´æ–°**ï¼š2025-02-06

**é»˜è®¤å¹³å°**ï¼šRISC-V 64ä½ï¼ˆRV64GCï¼‰

**æœ€æ–°æˆå°±**ï¼š
- âœ… **RISC-V 64ä½æ¶æ„æ”¯æŒ** (2025-02-06)
  - å®Œæ•´çš„å¯åŠ¨æµç¨‹ï¼ˆboot.rsï¼‰
  - S-mode å¼‚å¸¸å¤„ç†ï¼ˆtrap.rsã€trap.Sï¼‰
  - ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆcontext.rsï¼‰
  - ç³»ç»Ÿè°ƒç”¨å¤„ç†ï¼ˆsyscall.rsï¼‰
  - CPU æ“ä½œï¼ˆcpu.rsï¼‰
  - UART é©±åŠ¨ï¼ˆns16550aï¼‰
  - é“¾æ¥å™¨è„šæœ¬ï¼ˆlinker.ldï¼‰
  - **RISC-V ç°åœ¨æ˜¯é»˜è®¤æ„å»ºç›®æ ‡**
- âœ… **S-mode CSR æ­£ç¡®ä½¿ç”¨** (2025-02-06)
  - mstatus â†’ sstatus
  - mepc â†’ sepc
  - mtval â†’ stval
  - mtvec â†’ stvec
  - mcause â†’ scause
  - mret â†’ sret
- âœ… **OpenSBI é›†æˆ** (2025-02-06)
  - æ­£ç¡®çš„å†…å­˜å¸ƒå±€ï¼ˆå†…æ ¸ 0x80200000ï¼‰
  - M-modeï¼ˆOpenSBIï¼‰å’Œ S-modeï¼ˆå†…æ ¸ï¼‰æƒé™åˆ†ç¦»
  - è‡ªåŠ¨åŠ è½½ OpenSBI firmware

**å‰æœŸæˆå°±**ï¼š
- âœ… **Per-CPU è¿è¡Œé˜Ÿåˆ—** (2025-02-04)
  - å…¨å±€ RQ æ”¹ä¸º per-CPU æ•°ç»„ï¼ˆMAX_CPUS=4ï¼‰
  - this_cpu_rq() / cpu_rq() è®¿é—®å‡½æ•°
  - init_per_cpu_rq() åˆå§‹åŒ–å‡½æ•°
  - æ¬¡æ ¸è°ƒåº¦å™¨è‡ªåŠ¨åˆå§‹åŒ–
- âœ… **å¯åŠ¨é¡ºåºä¼˜åŒ–** (2025-02-04)
  - å‚è€ƒ Linux ARM64 å†…æ ¸å¯åŠ¨é¡ºåº
  - GIC åˆå§‹åŒ–æå‰åˆ° scheduler/VFS ä¹‹å‰
  - æ¬¡æ ¸å®Œå–„åˆå§‹åŒ–ï¼ˆrunqueueã€æ ˆã€IRQï¼‰
  - åˆ›å»º BOOT_SEQUENCE.md è¯¦ç»†æ–‡æ¡£
- âœ… **SMP åŒæ ¸å¯åŠ¨æˆåŠŸ** (2025-02-04)
  - PSCI CPU å”¤é†’æœºåˆ¶
  - Per-CPU æ ˆç®¡ç†
  - æ¬¡æ ¸å¯åŠ¨å…¥å£ç‚¹
  - CPU æ•°é‡æ£€æµ‹
  - æ¬¡æ ¸ runqueue åˆå§‹åŒ–
- âœ… **GICv3 ä¸­æ–­æ§åˆ¶å™¨** (2025-02-04)
  - æœ€å°åˆå§‹åŒ–å®Œæˆ
  - ç³»ç»Ÿå¯„å­˜å™¨è®¿é—®ï¼ˆICC_IAR1_EL1, ICC_EOIR1_EL1ï¼‰
  - Spurious interrupt å¤„ç† (IRQ 1023)
  - ä¸­æ–­å±è”½/æ¢å¤æœºåˆ¶
  - æ­£ç¡®çš„åˆå§‹åŒ–é¡ºåºï¼ˆMMU â†’ GIC â†’ SMPï¼‰
- âœ… **IPI (æ ¸é—´ä¸­æ–­)** (2025-02-04)
  - åŸºäº SGI çš„ IPI å‘é€ï¼ˆICC_SGI1R_EL1ï¼‰
  - IPI å¤„ç†æ¡†æ¶
  - Reschedule/Stop IPI ç±»å‹
- âœ… **MMU å¤šçº§é¡µè¡¨** (2025-02-04)
  - 3 çº§é¡µè¡¨ç»“æ„ï¼ˆ4KB é¡µé¢ï¼‰
  - MMU æˆåŠŸå¯ç”¨
  - æ’ç­‰æ˜ å°„å’Œç”¨æˆ·ç©ºé—´æ˜ å°„
- âœ… **ä¸­æ–­é£æš´ä¿®å¤** (2025-02-04)
  - IRQ æ—¶åºæ§åˆ¶ä¼˜åŒ–
  - åœ¨ SMP åˆå§‹åŒ–å®Œæˆåå¯ç”¨ IRQ
- âœ… **å…¨é¢ä»£ç å®¡æŸ¥** (2025-02-04)
  - å‘ç°å¹¶è®°å½• 15 ä¸ªé—®é¢˜
  - æ¸…ç† 50+ å¤„è°ƒè¯•è¾“å‡º
  - æ¡ä»¶ç¼–è¯‘ä¼˜åŒ–ï¼ˆ#[cfg(debug_assertions)]ï¼‰
- âœ… **æµ‹è¯•è„šæœ¬å®Œå–„** (2025-02-04)
  - test_suite.sh - å®Œæ•´æµ‹è¯•å¥—ä»¶
  - test_smp.sh - SMP åŠŸèƒ½æµ‹è¯•
  - test_ipi.sh - IPI åŠŸèƒ½æµ‹è¯•
  - test_qemu.sh - QEMU é…ç½®æµ‹è¯•
- âœ… æˆåŠŸè§£å†³ alloc crate ç¬¦å·å¯è§æ€§é—®é¢˜
- âœ… **Buddy System å†…å­˜åˆ†é…å™¨** (2025-02-04)
  - å®Œæ•´çš„ä¼™ä¼´ç³»ç»Ÿå®ç°
  - æ”¯æŒå†…å­˜é‡Šæ”¾å’Œä¼™ä¼´åˆå¹¶
  - O(log n) åˆ†é…/é‡Šæ”¾å¤æ‚åº¦
  - æœ€å¤§æ”¯æŒ 4GB å†…å­˜å—
  - åŸºäº 4KB é¡µé¢çš„åˆ†é…
  - çº¿ç¨‹å®‰å…¨ï¼ˆåŸå­æ“ä½œï¼‰
- âœ… å®ç°è‡ªå®šä¹‰é›†åˆç±»å‹ (SimpleBox/SimpleVec/SimpleString/SimpleArc)
- âœ… VFS æ¡†æ¶å°±ç»ªå¹¶æˆåŠŸåˆå§‹åŒ–
- âœ… RootFS å†…å­˜æ–‡ä»¶ç³»ç»Ÿå®Œæ•´å®ç°

**å·²çŸ¥å¾…ä¿®å¤é—®é¢˜**ï¼ˆè¯¦è§ [CODE_REVIEW.md](CODE_REVIEW.md)ï¼‰ï¼š

**ğŸ”´ ä¸¥é‡ä¼˜å…ˆçº§**ï¼š
- ~~**å†…å­˜åˆ†é…å™¨æ— æ³•é‡Šæ”¾å†…å­˜**~~ - âœ… å·²è§£å†³ï¼šBuddy System å®ç°å®Œæˆ
- ~~**å…¨å±€å•é˜Ÿåˆ—è°ƒåº¦å™¨**~~ - âœ… **å·²å®Œæˆ (2025-02-04)**
  - âœ… Per-CPU è¿è¡Œé˜Ÿåˆ—å®ç°
  - âœ… è´Ÿè½½å‡è¡¡æœºåˆ¶å®ç°
  - âœ… ä»»åŠ¡è¿ç§»ç®—æ³•
  - âœ… å¤šæ ¸è°ƒåº¦å®Œæˆ

**é«˜ä¼˜å…ˆçº§**ï¼š
- ~~â³ SimpleArc Clone æ”¯æŒ~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰
- ~~â³ RootFS write_data offset bug~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰

**ä¸­ä¼˜å…ˆçº§**ï¼š
- ~~â³ VFS å‡½æ•°æŒ‡é’ˆå®‰å…¨æ€§~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰
- ~~â³ Dentry/Inode ç¼“å­˜æœºåˆ¶~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰
- â³ Task ç»“æ„ä½“è¿‡å¤§ï¼ˆ660+ bytesï¼‰

**ä½ä¼˜å…ˆçº§**ï¼š
- â³ å‘½åçº¦å®šä¸ä¸€è‡´
- â³ IPI æµ‹è¯•ä»£ç æ¸…ç†
- â³ CpuContext åˆ†ç¦»ï¼ˆå†…æ ¸/ç”¨æˆ·å¯„å­˜å™¨ï¼‰
- ~~â³ è·¯å¾„è§£æå®Œå–„ï¼ˆç¬¦å·é“¾æ¥ã€ç›¸å¯¹è·¯å¾„ï¼‰~~ âœ… **å·²å®Œæˆ (2025-02-04)**
  - ~~âœ… è·¯å¾„è§„èŒƒåŒ– (path_normalize)~~ å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
  - ~~âœ… `.` å’Œ `..` æ”¯æŒ~~ å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
  - ~~âœ… ç¬¦å·é“¾æ¥è§£æ~~ å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
  - â³ ç›¸å¯¹è·¯å¾„å®Œæ•´æ”¯æŒï¼ˆéœ€è¦å½“å‰å·¥ä½œç›®å½•ï¼‰
- ~~â³ æ–‡ä»¶ç³»ç»Ÿæ“ä½œå®Œå–„~~ âœ… **å·²å®Œæˆ (2025-02-04)**
  - ~~âœ… mkdir() - åˆ›å»ºç›®å½•~~ å·²å®Œæˆ
  - ~~âœ… unlink() - åˆ é™¤æ–‡ä»¶~~ å·²å®Œæˆ
  - ~~âœ… rmdir() - åˆ é™¤ç›®å½•~~ å·²å®Œæˆ
  - â³ rename() - é‡å‘½åï¼ˆéƒ¨åˆ†å®ç°ï¼Œè¿”å› ENOSYSï¼‰

---

## Phase 1: åŸºç¡€æ¡†æ¶ âœ… **å·²å®Œæˆ**

### âœ… å·²å®Œæˆé¡¹ç›®

- [x] **é¡¹ç›®ç»“æ„æ­å»º**
  - [x] Workspace é…ç½®
  - [x] å†…æ ¸ crate é…ç½®ï¼ˆno_stdï¼‰
  - [x] äº¤å‰ç¼–è¯‘é…ç½®ï¼ˆaarch64-unknown-noneï¼‰
  - [x] é“¾æ¥å™¨è„šæœ¬
  - [x] æ„å»ºå’Œæµ‹è¯•è„šæœ¬

- [x] **å¹³å°å¯åŠ¨ä»£ç  (aarch64)**
  - [x] æ±‡ç¼–å¯åŠ¨ä»£ç  (`arch/aarch64/boot.S`)
  - [x] å¼‚å¸¸çº§åˆ«æ£€æµ‹å’Œå¤„ç†ï¼ˆEL1/EL2/EL3ï¼‰
  - [x] æ ˆè®¾ç½®
  - [x] BSS æ®µæ¸…é›¶
  - [x] ä¸ Rust ä»£ç çš„é“¾æ¥

- [x] **UART é©±åŠ¨**
  - [x] PL011 UART é©±åŠ¨å®ç°
  - [x] å­—ç¬¦è¾“å…¥/è¾“å‡º
  - [x] æ³¢ç‰¹ç‡é…ç½®
  - [x] `println!` å®å®ç°

- [x] **åŸºç¡€å†…å­˜ç®¡ç†**
  - [x] é¡µå¸§ç®¡ç†ï¼ˆPhysFrameã€VirtPageï¼‰
  - [x] é¡µè¡¨é¡¹ç»“æ„ï¼ˆPageTableEntryï¼‰
  - [x] MMU åŸºç¡€ä»£ç ï¼ˆaarch64ï¼‰
  - [x] å †åˆ†é…å™¨ï¼ˆé“¾è¡¨åˆ†é…å™¨ï¼‰

**éªŒè¯çŠ¶æ€**ï¼š
```
$ ./run.sh
Hello from Rust!
Rux Kernel v0.1.0 starting...
```

---

## Phase 2: ä¸­æ–­ä¸è¿›ç¨‹ **è¿›è¡Œä¸­**

### ğŸ”„ å½“å‰ä»»åŠ¡

#### 2.0 è¿›ç¨‹ç®¡ç†åŸºç¡€ âœ… **å·²å®Œæˆ**
- [x] **EL0 åˆ‡æ¢æœºåˆ¶** (`process/usermod.rs`, `arch/aarch64/context.rs`)
- [x] **EL0 åˆ‡æ¢æœºåˆ¶** (`process/usermod.rs`, `arch/aarch64/context.rs`)
  - [x] é€šè¿‡ `eret` æŒ‡ä»¤ä» EL1 åˆ‡æ¢åˆ° EL0
  - [x] SPSR å’Œ ELR_EL1 æ­£ç¡®è®¾ç½®
  - [x] ç”¨æˆ·æ ˆï¼ˆSP_EL0ï¼‰æ­£ç¡®è®¾ç½®
  - [x] ç”¨æˆ·ä»£ç å¯ä»¥åœ¨ EL0 æ­£å¸¸æ‰§è¡Œ
  - [x] éªŒè¯æµ‹è¯•ï¼šNOPã€B . ç­‰æŒ‡ä»¤æ­£å¸¸å·¥ä½œ

- [x] **ç³»ç»Ÿè°ƒç”¨æ¡†æ¶éªŒè¯** (`arch/aarch64/syscall.rs`)
  - [x] ç³»ç»Ÿè°ƒç”¨å¤„ç†ç¨‹åºï¼ˆ`syscall_handler`ï¼‰æ­£å¸¸å·¥ä½œ
  - [x] ç³»ç»Ÿè°ƒç”¨åˆ†å‘æœºåˆ¶æ­£ç¡®
  - [x] `sys_read` ç­‰ç³»ç»Ÿè°ƒç”¨å®ç°æ­£å¸¸
  - [x] ä»å†…æ ¸ç›´æ¥è°ƒç”¨ç³»ç»Ÿè°ƒç”¨éªŒè¯æˆåŠŸ

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**éªŒè¯çŠ¶æ€**ï¼š
```
Testing direct syscall call from kernel...
[SVC:00]
sys_read: invalid fd
Syscall returned error (expected)
```

**å·²çŸ¥é—®é¢˜**ï¼š
- HLT/SVC æŒ‡ä»¤ä» EL0 è§¦å‘ SError è€Œä¸æ˜¯åŒæ­¥å¼‚å¸¸
  - å¼‚å¸¸ç±»å‹ï¼š0x0B (SError from EL0 32-bit)
  - ESR_EL1ï¼šEC=0x00 (Trapped WFI/WFE)
  - è¿™å¯èƒ½æ˜¯ QEMU ç‰¹æœ‰è¡Œä¸ºæˆ–é…ç½®é—®é¢˜
  - ç³»ç»Ÿè°ƒç”¨æ¡†æ¶æœ¬èº«å·²éªŒè¯å¯æ­£å¸¸å·¥ä½œ

#### 2.0.1 è¿›ç¨‹åˆ›å»º (fork) âœ… **å·²å®Œæˆ (2025-02-03)**
- [x] **fork ç³»ç»Ÿè°ƒç”¨** (`arch/aarch64/syscall.rs`, `process/sched.rs`)
  - [x] `sys_fork` (ç³»ç»Ÿè°ƒç”¨å· 57) - åˆ›å»ºå­è¿›ç¨‹
  - [x] `sys_vfork` (ç³»ç»Ÿè°ƒç”¨å· 58) - åˆ›å»ºå…±äº«åœ°å€ç©ºé—´çš„å­è¿›ç¨‹
  - [x] é™æ€ä»»åŠ¡æ± å®ç°ï¼ˆé¿å…æ ˆåˆ†é…é—®é¢˜ï¼‰
  - [x] `Task::new_task_at()` å‡½æ•°ç”¨äºåœ¨æŒ‡å®šä½ç½®æ„é€  Task
  - [x] **éªŒè¯æˆåŠŸ**ï¼šæˆåŠŸåˆ›å»ºå­è¿›ç¨‹ï¼ŒPID = 2

**éªŒè¯çŠ¶æ€**ï¼š
```
Testing fork syscall...
do_fork: start
do_fork: allocated pool slot
do_fork: creating task at pool slot
Task::new_task_at: start
Task::new_task_at: writing fields
Task::new_task_at: done
do_fork: task created at pool slot
do_fork: done
Fork success: child PID = 00000002
```

**å…³é”®æ”¹è¿›**ï¼š
- ä½¿ç”¨é™æ€ä»»åŠ¡æ± ï¼ˆ`TASK_POOL`ï¼‰ä»£æ›¿å †åˆ†é…
- ä»»åŠ¡æ± å¤§å°ï¼š16 ä¸ªæ§½ä½
- æ¯ä¸ªæ§½ä½ï¼š512 å­—èŠ‚ï¼ˆè¶³å¤Ÿå­˜å‚¨ Task ç»“æ„ä½“ï¼‰

#### 2.0.2 æ–‡ä»¶ç³»ç»Ÿç³»ç»Ÿè°ƒç”¨ âœ… **éƒ¨åˆ†å®Œæˆ (2025-02-03)**
- [x] **æ–‡ä»¶æè¿°ç¬¦ç®¡ç†** (`fs/file.rs`, `arch/aarch64/syscall.rs`)
  - [x] `sys_close` (ç³»ç»Ÿè°ƒç”¨å· 3) - å…³é—­æ–‡ä»¶æè¿°ç¬¦
  - [x] `sys_lseek` (ç³»ç»Ÿè°ƒç”¨å· 8) - é‡å®šä½æ–‡ä»¶è¯»å†™ä½ç½®
  - [x] `sys_dup` (ç³»ç»Ÿè°ƒç”¨å· 32) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦
  - [x] `sys_dup2` (ç³»ç»Ÿè°ƒç”¨å· 33) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦åˆ°æŒ‡å®šä½ç½®
  - [x] `close_file_fd()` å‡½æ•° - å…³é—­æ–‡ä»¶æè¿°ç¬¦çš„åº•å±‚å®ç°

**å·²å®Œæˆç³»ç»Ÿè°ƒç”¨åˆ—è¡¨**ï¼š
- âœ… sys_read (0) - ä»æ–‡ä»¶æè¿°ç¬¦è¯»å–
- âœ… sys_write (1) - å†™å…¥åˆ°æ–‡ä»¶æè¿°ç¬¦
- âœ… sys_openat (2/245) - æ‰“å¼€æ–‡ä»¶
- âœ… sys_close (3) - å…³é—­æ–‡ä»¶æè¿°ç¬¦
- âœ… sys_lseek (8) - é‡å®šä½æ–‡ä»¶è¯»å†™ä½ç½®
- âœ… sys_pipe (22) - åˆ›å»ºç®¡é“
- âœ… sys_dup (32) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦
- âœ… sys_dup2 (33) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦åˆ°æŒ‡å®šä½ç½®
- âœ… sys_sigaction (48) - è®¾ç½®ä¿¡å·å¤„ç†å‡½æ•°
- âœ… sys_fork (57) - åˆ›å»ºå­è¿›ç¨‹
- âœ… sys_vfork (58) - åˆ›å»ºå…±äº«åœ°å€ç©ºé—´çš„å­è¿›ç¨‹
- âœ… sys_execve (59) - æ‰§è¡Œæ–°ç¨‹åº
- âœ… sys_exit (60) - é€€å‡ºè¿›ç¨‹
- âœ… sys_wait4 (61) - ç­‰å¾…å­è¿›ç¨‹
- âœ… sys_kill (62) - å‘é€ä¿¡å·
- âœ… sys_getpid (110) - è·å–è¿›ç¨‹ ID
- âœ… sys_getppid (110) - è·å–çˆ¶è¿›ç¨‹ ID
- âœ… sys_getuid (102) - è·å–ç”¨æˆ· ID
- âœ… sys_getgid (104) - è·å–ç»„ ID
- âœ… sys_geteuid (107) - è·å–æœ‰æ•ˆç”¨æˆ· ID
- âœ… sys_getegid (108) - è·å–æœ‰æ•ˆç»„ ID

**å¾…å®ç°**ï¼š
- â³ sys_readv/sys_writev - å‘é‡è¯»å†™
- â³ sys_pread64/sys_pwrite64 - å¸¦åç§»é‡çš„è¯»å†™
- â³ sys_select/poll/epoll - I/O å¤šè·¯å¤ç”¨
- â³ sys_ioctl - è®¾å¤‡æ§åˆ¶
- â³ sys_fcntl - æ–‡ä»¶æ§åˆ¶æ“ä½œ

#### 2.1 ä¸­æ–­å’Œå¼‚å¸¸å¤„ç†æ¡†æ¶ âœ… **å¤§éƒ¨åˆ†å®Œæˆ**
- [x] **å¼‚å¸¸å‘é‡è¡¨** (`arch/aarch64/trap.S`)
  - [x] åŒæ­¥å¼‚å¸¸å¤„ç†
  - [x] IRQ å¤„ç†
  - [x] FIQ å¤„ç†
  - [x] SError å¤„ç†
  - [x] æ ˆå¸§å¸ƒå±€ä¿®å¤ï¼ˆelr/esr/spsr ä½ç½®ï¼‰
  - [x] å¯„å­˜å™¨æ¢å¤ä¿®å¤
- [x] **ä¸­æ–­æ§åˆ¶å™¨** (`drivers/intc/gicv3.rs`)
  - [x] GICv3 é©±åŠ¨åˆå§‹åŒ–
  - [x] ä¸­æ–­ä½¿èƒ½/ç¦ç”¨
  - [x] ä¸­æ–­åˆ†å‘
- [x] **å¼‚å¸¸å¤„ç†æ¡†æ¶** (`arch/aarch64/trap.rs`)
  - [x] ä¸Šä¸‹æ–‡ä¿å­˜/æ¢å¤
  - [x] å¼‚å¸¸åˆ†å‘
  - [x] ç³»ç»Ÿè°ƒç”¨å…¥å£
  - [x] SVC ç³»ç»Ÿè°ƒç”¨å¤„ç†
  - [x] å¼‚å¸¸ç±»å‹è¯†åˆ«å’Œè°ƒè¯•è¾“å‡º
- [x] **å®šæ—¶å™¨é©±åŠ¨** (`drivers/timer/armv8.rs`)
  - [x] ARMv8 æ¶æ„å®šæ—¶å™¨
  - [x] å‘¨æœŸæ€§ä¸­æ–­
  - [x] æ—¶é—´æˆ³è®¡æ•°å™¨

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**ä¾èµ–å…³ç³»**ï¼šè¿›ç¨‹è°ƒåº¦ä¾èµ–äºä¸­æ–­æ¡†æ¶

---

#### 2.2 è¿›ç¨‹è°ƒåº¦å™¨ âœ… **åŸºç¡€æ¡†æ¶å®Œæˆ**
- [x] **è°ƒåº¦å™¨æ¡†æ¶** (`process/sched.rs`)
  - [x] è°ƒåº¦å™¨æ¥å£å®šä¹‰
  - [x] å°±ç»ªé˜Ÿåˆ—ç®¡ç†
  - [x] Round Robin è°ƒåº¦ç®—æ³•
- [x] **è¿›ç¨‹æ§åˆ¶å—** (`process/mod.rs`)
  - [x] PCB ç»“æ„å®šä¹‰
  - [x] è¿›ç¨‹çŠ¶æ€ç®¡ç†
  - [x] è¿›ç¨‹åˆ›å»º/é”€æ¯
- [x] **ä¸Šä¸‹æ–‡åˆ‡æ¢** (`arch/aarch64/context.rs`)
  - [x] ä¿å­˜é€šç”¨å¯„å­˜å™¨
  - [x] ä¿å­˜ç‰¹æ®Šå¯„å­˜å™¨ï¼ˆSPã€ELRã€SPSRï¼‰
  - [x] åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹
  - [x] switch_to_user å‡½æ•°
- [ ] **è°ƒåº¦ç­–ç•¥** (`process/sched_rr.rs`, `process/sched_cfs.rs`)
  - [x] Round Robin è°ƒåº¦
  - [ ] å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ˆCFSï¼‰
  - [ ] å®æ—¶è°ƒåº¦ç­–ç•¥

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**ä¾èµ–å…³ç³»**ï¼šç³»ç»Ÿè°ƒç”¨ä¾èµ–äºè¿›ç¨‹ç®¡ç†

---

#### 2.3 è¿›ç¨‹åœ°å€ç©ºé—´ ğŸ”„ **è¿›è¡Œä¸­**
- [x] **åœ°å€ç©ºé—´ç®¡ç†** (`mm/vma.rs`)
  - [x] VMAï¼ˆè™šæ‹Ÿå†…å­˜åŒºåŸŸï¼‰ç»“æ„
  - [x] åœ°å€ç©ºé—´å¸ƒå±€
  - [ ] mmap/munmap æ”¯æŒ
- [x] **é¡µè¡¨ç®¡ç†** (`arch/aarch64/mm.rs`)
  - [x] é¡µè¡¨åˆ›å»º/é”€æ¯
  - [x] é¡µè¡¨æ¡ç›®ç»“æ„
  - [x] é¡µè¡¨æ˜ å°„è®¾ç½®
  - [ ] é¡µè¡¨å–æ¶ˆæ˜ å°„
  - [ ] å†™æ—¶å¤åˆ¶
- [ ] **å†…å­˜æ˜ å°„** (`mm/mmap.rs`)
  - [ ] åŒ¿åæ˜ å°„
  - [ ] æ–‡ä»¶æ˜ å°„
  - [ ] å…±äº«æ˜ å°„
- [ ] **ç¼ºé¡µå¼‚å¸¸å¤„ç†** (`mm/fault.rs`)
  - [ ] ç¼ºé¡µå¼‚å¸¸å¤„ç†
  - [ ] å»¶è¿Ÿåˆ†é…
  - [ ] å†™æ—¶å¤åˆ¶

**âš ï¸ MMU ä½¿èƒ½é—®é¢˜ - å·²å†³å®šæš‚æ—¶ç¦ç”¨**

**é—®é¢˜æè¿°**ï¼š
- å†…æ ¸åœ¨ `msr sctlr_el1, x0` æŒ‡ä»¤åæŒ‚èµ·
- é¡µè¡¨æè¿°ç¬¦æ ¼å¼å·²ä¿®å¤ï¼ˆAPã€SHã€AttrIndx å­—æ®µï¼‰
- MAIR é…ç½®å·²ä¿®å¤ï¼ˆNormal memory at AttrIdx 0, Device memory at AttrIdx 1ï¼‰
- æ’ç­‰æ˜ å°„å·²è®¾ç½®ï¼ˆ0x40000000-0x7FFFFFFFï¼‰
- TLB åˆ·æ–°å·²æ·»åŠ 
- ä½† MMU å¯ç”¨åç«‹å³æŒ‚èµ·ï¼Œæ— å¼‚å¸¸è¾“å‡º

**è°ƒæŸ¥ç»“æœ**ï¼š
1. é¡µè¡¨æ¡ç›®æ ¼å¼å·²æŒ‰ ARMv8 è§„èŒƒä¿®æ­£
2. T0SZ å€¼å·²ä¿®æ­£ï¼ˆå°è¯•è¿‡ T0SZ=16 å’Œ T0SZ=0ï¼‰
3. é€šè¿‡ GDB è°ƒè¯•å‘ç°é€’å½’å¼‚å¸¸é—®é¢˜ï¼ˆå¼‚å¸¸å¤„ç†ç¨‹åºæœ¬èº«è§¦å‘å¼‚å¸¸ï¼‰
4. å¯¹äº 64 ä½ VAï¼ˆT0SZ=0ï¼‰ï¼ŒEntry[0] æ˜ å°„åˆ° 0x0000_0000ï¼Œä¸åŒ…å«å†…æ ¸ä»£ç 

**å†³å®š**ï¼š
- **æš‚æ—¶ç¦ç”¨ MMU**ï¼Œå…ˆå®ç°å…¶ä»–ä¸ä¾èµ– MMU çš„åŠŸèƒ½
- å†…æ ¸å½“å‰åœ¨ MMU ç¦ç”¨çŠ¶æ€ä¸‹è¿è¡Œæ­£å¸¸
- ç³»ç»Ÿè°ƒç”¨ã€è¿›ç¨‹è°ƒåº¦ç­‰åŠŸèƒ½å¯ä»¥ç»§ç»­å¼€å‘
- ç­‰å¾…æ›´å¤šåŠŸèƒ½å®ç°åå†é‡æ–°å®¡è§† MMU é—®é¢˜

**å½“å‰çŠ¶æ€**ï¼š
- MMU å·²åœ¨ `mm.rs::init()` ä¸­æ˜ç¡®ç¦ç”¨
- å†…æ ¸å¯æ­£å¸¸å¯åŠ¨ã€å¤„ç†ä¸­æ–­ã€æ‰§è¡Œç³»ç»Ÿè°ƒç”¨
- æ‰€æœ‰éå†…å­˜æ˜ å°„ç›¸å…³çš„åŠŸèƒ½å¯ä»¥æ­£å¸¸å·¥ä½œ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šå»¶åè‡³ Phase 4 æˆ– Phase 5

---

#### 2.2 è¿›ç¨‹è°ƒåº¦å™¨
- [ ] **è°ƒåº¦å™¨æ¡†æ¶** (`process/scheduler.rs`)
  - [ ] è°ƒåº¦å™¨æ¥å£å®šä¹‰
  - [ ] å°±ç»ªé˜Ÿåˆ—ç®¡ç†
  - [ ] è°ƒåº¦ç®—æ³•ï¼ˆRound Robinã€CFSï¼‰
- [ ] **è¿›ç¨‹æ§åˆ¶å—** (`process/pcb.rs`)
  - [ ] PCB ç»“æ„å®šä¹‰
  - [ ] è¿›ç¨‹çŠ¶æ€ç®¡ç†
  - [ ] è¿›ç¨‹åˆ›å»º/é”€æ¯
- [ ] **ä¸Šä¸‹æ–‡åˆ‡æ¢** (`arch/aarch64/context.S`)
  - [ ] ä¿å­˜é€šç”¨å¯„å­˜å™¨
  - [ ] ä¿å­˜ç‰¹æ®Šå¯„å­˜å™¨ï¼ˆSPã€ELRã€SPSRï¼‰
  - [ ] åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹
- [ ] **è°ƒåº¦ç­–ç•¥** (`process/sched_rr.rs`, `process/sched_cfs.rs`)
  - [ ] Round Robin è°ƒåº¦
  - [ ] å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ˆCFSï¼‰
  - [ ] å®æ—¶è°ƒåº¦ç­–ç•¥

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š3-5 å¤©

**ä¾èµ–å…³ç³»**ï¼šç³»ç»Ÿè°ƒç”¨ä¾èµ–äºè¿›ç¨‹ç®¡ç†

---

#### 2.3 è¿›ç¨‹åœ°å€ç©ºé—´
- [ ] **åœ°å€ç©ºé—´ç®¡ç†** (`mm/vma.rs`)
  - [ ] VMAï¼ˆè™šæ‹Ÿå†…å­˜åŒºåŸŸï¼‰ç»“æ„
  - [ ] åœ°å€ç©ºé—´å¸ƒå±€
  - [ ] mmap/munmap æ”¯æŒ
- [ ] **é¡µè¡¨ç®¡ç†** (`mm/page_table.rs`)
  - [ ] é¡µè¡¨åˆ›å»º/é”€æ¯
  - [ ] é¡µè¡¨æ˜ å°„/å–æ¶ˆæ˜ å°„
  - [ ] é¡µè¡¨å…±äº«ï¼ˆå†™æ—¶å¤åˆ¶ï¼‰
- [ ] **å†…å­˜æ˜ å°„** (`mm/mmap.rs`)
  - [ ] åŒ¿åæ˜ å°„
  - [ ] æ–‡ä»¶æ˜ å°„
  - [ ] å…±äº«æ˜ å°„
- [ ] **ç¼ºé¡µå¼‚å¸¸å¤„ç†** (`mm/fault.rs`)
  - [ ] ç¼ºé¡µå¼‚å¸¸å¤„ç†
  - [ ] å»¶è¿Ÿåˆ†é…
  - [ ] å†™æ—¶å¤åˆ¶

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š3-4 å¤©

---

## Phase 3: ç³»ç»Ÿè°ƒç”¨ä¸éš”ç¦» ğŸ”„ **è¿›è¡Œä¸­ (2025-02-03)**

### 3.1 ç³»ç»Ÿè°ƒç”¨æ¥å£ âœ… **éƒ¨åˆ†å®Œæˆ**

- [x] **ç³»ç»Ÿè°ƒç”¨æ¡†æ¶** (`arch/aarch64/syscall.rs`)
  - [x] ç³»ç»Ÿè°ƒç”¨è¡¨
  - [x] å‚æ•°è§£æ
  - [x] è¿”å›å€¼å¤„ç†

- [x] **ç³»ç»Ÿè°ƒç”¨å®ç°** - 25+ ç³»ç»Ÿè°ƒç”¨å·²å®ç°
  - [x] è¿›ç¨‹ç›¸å…³ï¼š`fork` (57)ã€`vfork` (58)ã€`execve` (59)ã€`exit` (60)ã€`wait4` (61)ã€`getpid` (39)ã€`getppid` (110)
  - [x] æ–‡ä»¶ç›¸å…³ï¼š`read` (0)ã€`write` (1)ã€`openat` (2/245)ã€`close` (3)ã€`lseek` (8)ã€`pipe` (22)ã€`dup` (32)ã€`dup2` (33)
  - [x] å†…å­˜ç›¸å…³ï¼š`brk` (12)ã€`mmap` (9)ã€`munmap` (11)
  - [x] å…¶ä»–ï¼š`ioctl` (16)ã€`uname` (63)ã€`getuid` (102)ã€`getgid` (104)ã€`geteuid` (107)ã€`getegid` (108)

- [x] **ç”¨æˆ·/å†…æ ¸éš”ç¦»**
  - [x] åœ°å€éªŒè¯ï¼š`verify_user_ptr()`ã€`verify_user_ptr_array()`
  - [x] å‚æ•°å¤åˆ¶ï¼š`copy_user_string()`ã€`copy_from_user()`
  - [x] ç»“æœå¤åˆ¶ï¼š`copy_to_user()`
  - [x] ç”¨æˆ·ç©ºé—´åœ°å€èŒƒå›´å®šä¹‰ï¼ˆUSER_SPACE_ENDï¼‰

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**å¾…å®ç°**ï¼š
- â³ `gettimeofday` - è·å–æ—¶é—´
- â³ `mprotect` - ä¿®æ”¹å†…å­˜ä¿æŠ¤
- â³ `mincore` - æŸ¥è¯¢é¡µé¢çŠ¶æ€
- â³ `madvise` - å†…å­˜å»ºè®®
- â³ `readv`/`writev` - å‘é‡ I/O
- â³ `select`/`poll` - I/O å¤šè·¯å¤ç”¨

---

### 3.2 ä¿¡å·å¤„ç† âœ… **éƒ¨åˆ†å®Œæˆ (2025-02-04)**

- [x] **ä¿¡å·æ¡†æ¶** (`kernel/src/signal.rs`)
  - [x] ä¿¡å·å®šä¹‰ï¼ˆLinux å…¼å®¹ï¼ŒSignal æšä¸¾ï¼‰
  - [x] ä¿¡å·æ©ç ï¼ˆSignalStruct.maskï¼‰
  - [x] ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆSigActionï¼‰
  - [x] å¾…å¤„ç†ä¿¡å·é˜Ÿåˆ—ï¼ˆSigPendingï¼‰
  - [x] **SigInfo ç»“æ„** - å¸¦é™„åŠ ä¿¡æ¯çš„ä¿¡å·
  - [x] **SigQueue** - ä¿¡å·é˜Ÿåˆ—ï¼ˆhead/tail æŒ‡é’ˆï¼‰
  - [x] **sigqueue()** - å‘é€å¸¦ siginfo çš„ä¿¡å·
  - [x] **sigprocmask()** - ä¿¡å·æ©ç æ“ä½œ
  - [x] **rt_sigaction()** - ä¿¡å·å¤„ç†å‡½æ•°è®¾ç½®

- [x] **ä¿¡å·å‘é€**
  - [x] `kill` ç³»ç»Ÿè°ƒç”¨ (62)
  - [x] `sigaction` ç³»ç»Ÿè°ƒç”¨ (48) - ä½¿ç”¨ rt_sigaction
  - [x] `rt_sigprocmask` ç³»ç»Ÿè°ƒç”¨ (14) - ä½¿ç”¨ sigprocmask
  - [x] ä¿¡å·é˜Ÿåˆ—ï¼ˆSigPendingï¼‰
  - [x] ä¿¡å·ä¼ é€’æœºåˆ¶ï¼ˆSigPending::add()ï¼‰
  - [x] **å¸¦ siginfo çš„ä¿¡å·å‘é€**ï¼ˆsigqueueï¼‰

- [x] **ä¿¡å·å¤„ç†å’Œäº¤ä»˜**
  - [x] `rt_sigreturn` ç³»ç»Ÿè°ƒç”¨ (15)
  - [x] **ä¿¡å·äº¤ä»˜ï¼ˆdo_signalï¼‰** âœ… å·²å®Œæˆ (2025-02-04)
  - [x] **ä¿¡å·å¤„ç†å‡½æ•°è°ƒç”¨** âœ… å·²å®Œæˆ (2025-02-04)
  - [x] **å®Œæ•´çš„ sigreturn å®ç°ï¼ˆä¸Šä¸‹æ–‡æ¢å¤ï¼‰** âœ… å·²å®Œæˆ (2025-02-04)

**å®Œæˆæ—¶é—´**ï¼š2025-02-04ï¼ˆä¿¡å·äº¤ä»˜æœºåˆ¶å®Œæˆï¼‰

**å·²å®ç°**ï¼ˆ2025-02-04ï¼‰ï¼š
- âœ… **sigqueue()** - å‘é€å¸¦ siginfo çš„ä¿¡å·
- âœ… **sigprocmask()** - ä¿¡å·æ©ç æ“ä½œ
- âœ… **rt_sigaction()** - ä¿¡å·å¤„ç†å‡½æ•°è®¾ç½®
- âœ… **ç³»ç»Ÿè°ƒç”¨é›†æˆ**
  - sys_sigaction ä½¿ç”¨ rt_sigaction
  - sys_rt_sigprocmask ä½¿ç”¨ sigprocmask
- âœ… **ä¿¡å·å¸§æ„å»ºï¼ˆsetup_frameï¼‰** âœ… å·²å®Œæˆ (2025-02-04)
  - ä¿å­˜ä¸Šä¸‹æ–‡åˆ° UContext
  - è®¾ç½®ä¿¡å·å¤„ç†å‡½æ•°å‚æ•°
  - è®¾ç½®ä¿¡å·è¿”å›æ¡©ä»£ç ï¼ˆsvc #0x80ï¼‰
  - ä¿å­˜åŸå§‹ PC ç”¨äºè¿”å›
- âœ… **ä¿¡å·ä¸Šä¸‹æ–‡æ¢å¤ï¼ˆrestore_sigcontextï¼‰** âœ… å·²å®Œæˆ (2025-02-04)
  - æ¢å¤æ‰€æœ‰ä¿å­˜çš„å¯„å­˜å™¨
  - æ¢å¤ PC åˆ°ä¿¡å·ä¸­æ–­å‰çš„ä½ç½®
  - æ¢å¤ä¿¡å·æ©ç 
  - æ¸…é™¤ä¿¡å·å¸§

**å¾…å®ç°**ï¼š
- â³ ä¿¡å·æ ˆï¼ˆsigaltstackï¼‰- å·²æœ‰æ¡†æ¶ï¼Œå¾…å®Œå–„
- â³ ä¿¡å·å¸§å†™å…¥ç”¨æˆ·ç©ºé—´ - å½“å‰ä¿å­˜åœ¨å†…æ ¸ç©ºé—´

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šåŸºæœ¬å®Œæˆï¼Œå¾…ç”¨æˆ·ç©ºé—´å†…å­˜ç®¡ç†å®Œå–„

---

## Phase 4: æ–‡ä»¶ç³»ç»Ÿ ğŸ”„ **è¿›è¡Œä¸­ (2025-02-03)**

### 4.1 VFS è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ
- [x] **VFS æ¡†æ¶** (`fs/vfs.rs`)
  - [x] VFS åˆå§‹åŒ– (ä½¿ç”¨ SimpleArc)
  - [x] æ–‡ä»¶ç³»ç»Ÿæ¥å£æ¡†æ¶
  - [x] åŸºç¡€æ–‡ä»¶æ“ä½œ (file_open, file_close, file_read, file_write)
  - [x] æ–‡ä»¶æ§åˆ¶æ¥å£ (file_fcntl)
  - [x] I/O å¤šè·¯å¤ç”¨æ¥å£ (io_poll)
- [x] **æ–‡ä»¶æè¿°ç¬¦ç®¡ç†** (`fs/file.rs`)
  - [x] FdTable å®ç°
  - [x] fd åˆ†é…/é‡Šæ”¾ (alloc_fd, close_fd)
  - [x] fd å¤åˆ¶ (dup_fd)
  - [x] æ–‡ä»¶å¯¹è±¡ (File) å’Œæ–‡ä»¶æ“ä½œ (FileOps)
- [x] **è·¯å¾„è§£æ** (`fs/path.rs`)
  - [x] è·¯å¾„åè§£æ (filename_parentname, path_lookup)
  - [x] ç»å¯¹è·¯å¾„/ç›¸å¯¹è·¯å¾„åˆ¤æ–­
  - [x] è·¯å¾„ç»„ä»¶è¿­ä»£å™¨ (PathComponents)
  - [x] çˆ¶ç›®å½•å’Œæ–‡ä»¶åè·å– (parent, file_name)
  - [ ] ç¬¦å·é“¾æ¥è§£æ (TODO: follow_link)
- [x] **VFS æ ¸å¿ƒå¯¹è±¡**
  - [x] File ç»“æ„å’Œ FileOps (fs/file.rs)
  - [x] Inode ç»“æ„å’Œ INodeOps (fs/inode.rs) - å·²å®ç°ï¼Œä½¿ç”¨ alloc::sync::Arc
  - [x] Dentry ç»“æ„ (fs/dentry.rs) - å·²å®ç°ï¼Œä½¿ç”¨ alloc::sync::Arc
  - [ ] éœ€è¦å°† Inode/Dentry æ›´æ–°ä¸ºä½¿ç”¨ SimpleArc
- [x] **æ–‡ä»¶ç³»ç»Ÿæ³¨å†Œæœºåˆ¶** (`fs/superblock.rs`)
  - [x] FileSystemType æ–‡ä»¶ç³»ç»Ÿç±»å‹
  - [x] FsRegistry æ–‡ä»¶ç³»ç»Ÿæ³¨å†Œè¡¨
  - [x] SuperBlock è¶…çº§å—ç»“æ„
  - [x] FsContext æŒ‚è½½ä¸Šä¸‹æ–‡
  - [x] register_filesystem/unregister_filesystem
  - [x] get_fs_type æŸ¥æ‰¾æ–‡ä»¶ç³»ç»Ÿç±»å‹
  - [x] do_mount/do_umount æŒ‚è½½å¸è½½æ“ä½œ
- [x] **æŒ‚è½½ç‚¹ç®¡ç†** (`fs/mount.rs`)
  - [x] VfsMount æŒ‚è½½ç‚¹ç»“æ„
  - [x] MntNamespace æŒ‚è½½å‘½åç©ºé—´
  - [x] MntFlags/MsFlags æŒ‚è½½æ ‡å¿—
  - [x] add_mount/remove_mount æŒ‚è½½ç‚¹æ“ä½œ
  - [x] find_mount/list_mounts æŒ‚è½½ç‚¹æŸ¥è¯¢
  - [x] MountTreeIter æŒ‚è½½ç‚¹éå†
  - [x] get_init_namespace åˆå§‹å‘½åç©ºé—´
- [x] **RootFS å†…å­˜æ–‡ä»¶ç³»ç»Ÿ** (`fs/rootfs.rs`) ğŸ†•
  - [x] RootFSNode æ–‡ä»¶èŠ‚ç‚¹ï¼ˆç›®å½•/å¸¸è§„æ–‡ä»¶ï¼‰
  - [x] RootFSSuperBlock RootFS è¶…çº§å—
  - [x] create_file åˆ›å»ºæ–‡ä»¶
  - [x] lookup æŸ¥æ‰¾æ–‡ä»¶
  - [x] list_dir åˆ—å‡ºç›®å½•
  - [x] read_data/write_data æ–‡ä»¶è¯»å†™
  - [x] ROOTFS_FS_TYPE æ–‡ä»¶ç³»ç»Ÿç±»å‹
  - [x] init_rootfs RootFS åˆå§‹åŒ–
  - [x] æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°å‘½åç©ºé—´
  - [x] VfsMount æ·»åŠ è¶…çº§å—æŒ‡é’ˆ (mnt_sb)

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š5-7 å¤©

**å½“å‰çŠ¶æ€**ï¼šVFS æ ¸å¿ƒæ¡†æ¶å·²å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬æ–‡ä»¶æè¿°ç¬¦ç®¡ç†ã€è·¯å¾„è§£æã€æ–‡ä»¶ç³»ç»Ÿæ³¨å†Œã€è¶…çº§å—ç®¡ç†ã€æŒ‚è½½ç‚¹ç®¡ç†å’Œ RootFS å†…å­˜æ–‡ä»¶ç³»ç»Ÿã€‚ä¸‹ä¸€æ­¥æ˜¯å®Œæˆæ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å’Œé›†æˆã€‚

---

### 4.2 ext4 æ–‡ä»¶ç³»ç»Ÿ
- [ ] **ext4 å®ç°** (`fs/ext4/`)
  - [ ] è¶…çº§å—è¯»å–
  - [ ] inode å’Œå—ä½å›¾
  - [ ] ç›®å½•è§£æ
  - [ ] æ–‡ä»¶è¯»å–/å†™å…¥
  - [ ] æ—¥å¿—ï¼ˆjournalingï¼‰
- [ ] **ç¼“å­˜ç®¡ç†** (`fs/cache.rs`)
  - [ ] inode ç¼“å­˜
  - [ ] å—ç¼“å­˜
  - [ ] ç›®å½•é¡¹ç¼“å­˜

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 4.3 btrfs æ–‡ä»¶ç³»ç»Ÿ
- [ ] **btrfs å®ç°** (`fs/btrfs/`)
  - [ ] B-tree ç»“æ„
  - [ ] å¿«ç…§
  - [ ] å†™æ—¶å¤åˆ¶
  - [ ] å‹ç¼©

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š10-14 å¤©ï¼ˆå¯é€‰ï¼‰

---

## Phase 5: SMP æ”¯æŒ âœ… **å·²å®Œæˆ (2025-02-04)**

### 5.1 åŒæ ¸å¯åŠ¨ âœ… **å·²å®Œæˆ**
- [x] **æ¬¡æ ¸å¯åŠ¨å…¥å£ç‚¹** (`arch/aarch64/boot.S`)
  - [x] æ¬¡æ ¸å…¥å£ç‚¹ (secondary_entry)
  - [x] MPIDR è¯»å–å’Œ CPU ID åˆ¤æ–­
  - [x] Per-CPU æ ˆé€‰æ‹©
  - [x] è·³è½¬åˆ° Rust æ¬¡æ ¸å…¥å£
- [x] **SMP æ•°æ®ç»“æ„** (`arch/aarch64/smp.rs`)
  - [x] SmpData å…¨å±€æ•°æ®
  - [x] CpuBootInfo per-CPU ä¿¡æ¯
  - [x] CPU çŠ¶æ€ç®¡ç† (Unknown/Booting/Running)
  - [x] æ´»åŠ¨ CPU è®¡æ•° (get_active_cpu_count)
- [x] **Per-CPU æ ˆç®¡ç†**
  - [x] é“¾æ¥å™¨è„šæœ¬åˆ†é…æ ˆç©ºé—´
  - [x] æ¯ä¸ª CPU 16KB æ ˆ
  - [x] æ”¯æŒ 4 ä¸ª CPU
- [x] **PSCI CPU å”¤é†’** (`arch/aarch64/smp.rs`)
  - [x] PSCI_CPU_ON SMC/HVC è°ƒç”¨
  - [x] æ¬¡æ ¸å¯åŠ¨åœ°å€ä¼ é€’
  - [x] CPU 1 æˆåŠŸå¯åŠ¨

**æµ‹è¯•éªŒè¯**ï¼š
```
[SMP: Calling PSCI for CPU 1]
[SMP: PSCI result = 0000000000000000]
[CPU1 up]
SMP: 2 CPUs online
```

### 5.2 GICv3 ä¸­æ–­æ§åˆ¶å™¨ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **GICv3 å®Œå…¨åˆå§‹åŒ–** (`drivers/intc/gicv3.rs`)
  - [x] **Bug ä¿®å¤**: GICD å†…å­˜è®¿é—®é—®é¢˜
    - **é—®é¢˜**: read_volatile() è®¿é—® GICD å¯„å­˜å™¨å¯¼è‡´å†…æ ¸æŒ‚èµ·
    - **åŸå› **: Rust volatile æ“ä½œä¸ MMU æ˜ å°„çš„è®¾å¤‡å†…å­˜äº¤äº’é—®é¢˜
    - **ä¿®å¤**: GicD/GicR read_reg/write_reg æ”¹ç”¨å†…è”æ±‡ç¼– ldr/str
  - [x] GICD å®Œå…¨åˆå§‹åŒ–ï¼ˆæ£€æµ‹åˆ° 32 IRQsï¼‰
  - [x] GICR åˆå§‹åŒ–
  - [x] ICC_IAR1_EL1 - ä¸­æ–­ç¡®è®¤
  - [x] ICC_EOIR1_EL1 - ä¸­æ–­ç»“æŸ
  - [x] ICC_SGI1R_EL1 - SGI å‘é€
- [x] **ä¸­æ–­å¤„ç†** (`arch/aarch64/trap.rs`)
  - [x] IRQ å¤„ç†æ¡†æ¶
  - [x] SGI å¤„ç†ï¼ˆIPIï¼‰
  - [x] Spurious interrupt å¤„ç† (ID 1023)
- [x] **ä¸­æ–­å±è”½/æ¢å¤**
  - [x] mask_irq() - ä¿å­˜å¹¶å±è”½ IRQ
  - [x] restore_irq() - æ¢å¤ IRQ çŠ¶æ€
  - [x] DAIF å¯„å­˜å™¨æ“ä½œ

**æµ‹è¯•éªŒè¯**ï¼š
```
gicd: Step 1 - Reading GICD_CTLR (inline asm)...
gicd: CTLR = 0x00000000
gicd: Step 2 - Reading TYPER...
gicd: 32 IRQs detected
gicd: Step 3 - Enabling GICD...
gicd: GICD initialization complete!
gic: GICD initialized successfully
GIC initialized - IRQ still disabled
IRQ enabled
```

### 5.3 IPI (æ ¸é—´ä¸­æ–­) âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **IPI æ¡†æ¶** (`arch/aarch64/ipi.rs`)
  - [x] IpiType æšä¸¾ (Reschedule/Stop)
  - [x] send_ipi() - å‘é€ IPI
  - [x] handle_ipi() - å¤„ç† IPI
  - [x] smp_send_reschedule() - å‘é€è°ƒåº¦ IPI
- [x] **IPI æµ‹è¯•**
  - [x] CPU 0 â†’ CPU 1 IPI å‘é€æµ‹è¯•
  - [x] IPI æ¥æ”¶éªŒè¯

**æµ‹è¯•éªŒè¯**ï¼š
```
[IPI: Sending IPI 1 to CPU 1]
[IPI: CPU 1 received IPI 1]
[IPI: Reschedule]
```

### 5.4 MMU å¤šçº§é¡µè¡¨ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **3 çº§é¡µè¡¨ç»“æ„** (`arch/aarch64/mm.rs`)
  - [x] é¡µè¡¨åˆ›å»ºå’Œåˆå§‹åŒ–
  - [x] é¡µè¡¨é¡¹æ ¼å¼ (4KB é¡µé¢)
  - [x] æ’ç­‰æ˜ å°„ (0x4000_0000 - 0x7FFF_FFFF)
  - [x] ç”¨æˆ·ç©ºé—´æ˜ å°„ (0x0000_0000 - 0x3FFF_FFFF)
- [x] **MMU å¯ç”¨**
  - [x] TCR_EL1 é…ç½®
  - [x] MAIR_EL1 é…ç½®
  - [x] TTBR0_EL1 è®¾ç½®
  - [x] TLB åˆ·æ–°
  - [x] MMU æˆåŠŸå¯ç”¨

**æŠ€æœ¯è¦ç‚¹**ï¼š
- T0SZ = 16 (48 ä½ VA)
- 3 çº§é¡µè¡¨ (4KB é¡µç²’åº¦)
- Normal memory (AttrIdx 0)
- Device memory (AttrIdx 1)

### 5.5 ä¸­æ–­é£æš´ä¿®å¤ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **IRQ æ—¶åºæ§åˆ¶**
  - [x] å¯åŠ¨æ—¶ç¦ç”¨ IRQ (boot.rs)
  - [x] GIC åˆå§‹åŒ–ï¼ˆIRQ ä»ç„¶ç¦ç”¨ï¼‰
  - [x] SMP å¯åŠ¨ï¼ˆIRQ ä»ç„¶ç¦ç”¨ï¼‰
  - [x] SMP å®Œæˆåå¯ç”¨ IRQ
- [x] **ä¸­æ–­å¤„ç†ä¼˜åŒ–**
  - [x] handle_irq() ä¸­ä½¿ç”¨ä¸­æ–­å±è”½
  - [x] é˜²æ­¢é€’å½’ä¸­æ–­è°ƒç”¨

---

## Phase 6: ä»£ç å®¡æŸ¥ âœ… **å·²å®Œæˆ (2025-02-04)**

### 6.1 å…¨é¢ä»£ç å®¡æŸ¥ âœ… **å·²å®Œæˆ**
- [x] **ä»£ç å®¡æŸ¥** - æ•´ä¸ªé¡¹ç›®å®¡æŸ¥
  - [x] å‘ç°å¹¶è®°å½• 15 ä¸ªé—®é¢˜
  - [x] æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»ï¼ˆä¸¥é‡/ä¸­ç­‰/ä½ï¼‰
  - [x] ä¸ Linux å†…æ ¸å¯¹æ¯”
  - [x] ä¿®å¤æ–¹æ¡ˆè®¾è®¡
- [x] **æ–‡æ¡£æ›´æ–°**
  - [x] CODE_REVIEW.md åˆ›å»º
  - [x] é—®é¢˜è¯¦ç»†è®°å½•
  - [x] ä¿®å¤ä¼˜å…ˆçº§æ’åº
  - [x] BOOT_SEQUENCE.md åˆ›å»º - å¯åŠ¨é¡ºåºåˆ†æä¸ä¼˜åŒ–æ–‡æ¡£
  - [x] Linux ARM64 å¯åŠ¨é¡ºåºå‚è€ƒ
  - [x] å…³é”®åŸåˆ™æ–‡æ¡£ï¼ˆMMU â†’ GIC â†’ SMPï¼‰
  - [x] æ¬¡æ ¸åˆå§‹åŒ–è¯¦ç»†æ­¥éª¤

### 6.2 è°ƒè¯•è¾“å‡ºæ¸…ç† âœ… **å·²å®Œæˆ**
- [x] **æ¸…ç† 50+ å¤„è°ƒè¯•è¾“å‡º**
  - [x] boot.rs - 2 å¤„
  - [x] gicv3.rs - 17 å¤„
  - [x] ipi.rs - 8 å¤„
  - [x] allocator.rs - 1 å¤„
  - [x] main.rs - 20+ å¤„
- [x] **æ¡ä»¶ç¼–è¯‘ä¼˜åŒ–**
  - [x] ä½¿ç”¨ #[cfg(debug_assertions)]
  - [x] åŒºåˆ†è°ƒè¯•å’Œç”Ÿäº§è¾“å‡º
  - [x] ä½¿ç”¨ println!/debug_println! å®

### 6.3 æµ‹è¯•è„šæœ¬å®Œå–„ âœ… **å·²å®Œæˆ**
- [x] **test_suite.sh** - å®Œæ•´æµ‹è¯•å¥—ä»¶
  - [x] é…ç½®æ–‡ä»¶æµ‹è¯•
  - [x] ç¼–è¯‘æµ‹è¯•
  - [x] SMP æµ‹è¯•
  - [x] MMU æµ‹è¯•
  - [x] å†…å­˜é…ç½®æµ‹è¯•
- [x] **test_smp.sh** - SMP åŠŸèƒ½æµ‹è¯•
  - [x] åŒæ ¸å¯åŠ¨éªŒè¯
  - [x] MMU/GIC åˆå§‹åŒ–éªŒè¯
  - [x] ç³»ç»Ÿç¨³å®šæ€§éªŒè¯
- [x] **test_ipi.sh** - IPI åŠŸèƒ½æµ‹è¯•
  - [x] åŒæ ¸å¯åŠ¨æµ‹è¯•
  - [x] GIC åˆå§‹åŒ–æµ‹è¯•
  - [x] IRQ æ§åˆ¶æµ‹è¯•
  - [x] ç³»ç»Ÿç¨³å®šæ€§æµ‹è¯•
- [x] **test_qemu.sh** - QEMU é…ç½®æµ‹è¯•
  - [x] å•æ ¸æµ‹è¯•
  - [x] åŒæ ¸æµ‹è¯•
  - [x] å››æ ¸æµ‹è¯•
  - [x] å†…å­˜é…ç½®æµ‹è¯•

### 6.4 Makefile å¢å¼º âœ… **å·²å®Œæˆ**
- [x] **å¿«æ·å‘½ä»¤**
  - [x] `make smp` - è¿è¡Œ SMP æµ‹è¯•
  - [x] `make ipi` - è¿è¡Œ IPI æµ‹è¯•
  - [x] `make test` - è¿è¡Œæµ‹è¯•å¥—ä»¶
  - [x] `make run` - å¿«é€Ÿè¿è¡Œå†…æ ¸

---

## Phase 7: å†…å­˜ç®¡ç†ä¼˜åŒ– âœ… **å·²å®Œæˆ (2025-02-04)**

### 7.1 Buddy System å†…å­˜åˆ†é…å™¨ âœ… **å·²å®Œæˆ**
- [x] **Buddy System å®ç°** ([kernel/src/mm/buddy_allocator.rs](kernel/src/mm/buddy_allocator.rs))
  - [x] BlockHeader æ•°æ®ç»“æ„ï¼ˆorder, free, prev, nextï¼‰
  - [x] BuddyAllocator ç»“æ„ä½“ï¼ˆ21 ä¸ªç©ºé—²é“¾è¡¨ï¼‰
  - [x] alloc_blocks() - O(log n) åˆ†é…ï¼Œæ”¯æŒå—åˆ†å‰²
  - [x] free_blocks() - é‡Šæ”¾ç®—æ³•ï¼Œæ”¯æŒä¼™ä¼´åˆå¹¶
  - [x] get_buddy() - ä¼™ä¼´åœ°å€è®¡ç®—
  - [x] GlobalAlloc trait å®ç°
- [x] **å†…å­˜å¸ƒå±€è°ƒæ•´**
  - [x] å †åœ°å€ï¼š0x6000_0000ï¼ˆä» 0x8800_0000 è¿ç§»ï¼‰
  - [x] MMU é¡µè¡¨æ˜ å°„ï¼ˆL2 entries 3-10ï¼Œ16MBï¼‰
- [x] **çº¿ç¨‹å®‰å…¨**
  - [x] åŸå­æ“ä½œï¼ˆAtomicUsize, CASï¼‰
  - [x] æ— é”å¹¶å‘è®¿é—®

**æŠ€æœ¯ç‰¹æ€§**ï¼š
- æœ€å°åˆ†é…ï¼š4KB (order 0)
- æœ€å¤§åˆ†é…ï¼š4GB (order 20)
- å †å¤§å°ï¼š16MB
- ç®—æ³•å¤æ‚åº¦ï¼šO(log n)

**æµ‹è¯•éªŒè¯**ï¼š
```
âœ“ Direct alloc works!
âœ“ SimpleVec::push works!
âœ“ SimpleBox works!
âœ“ SimpleString works!
âœ“ SimpleArc works!
âœ“ Fork success: child PID = 2
```

---

## Phase 8: Per-CPU ä¼˜åŒ– âœ… **å·²å®Œæˆ (2025-02-04)**

### 8.1 Per-CPU è¿è¡Œé˜Ÿåˆ— âœ… **å·²å®Œæˆ**
- [x] **è°ƒåº¦å™¨é‡æ„** ([kernel/src/process/sched.rs](kernel/src/process/sched.rs))
  - [x] å…¨å±€ RQ æ”¹ä¸º per-CPU æ•°ç»„ï¼ˆPER_CPU_RQ[4]ï¼‰
  - [x] this_cpu_rq() å‡½æ•° - è·å–å½“å‰ CPU çš„è¿è¡Œé˜Ÿåˆ—
  - [x] cpu_rq(cpu_id) å‡½æ•° - è·å–æŒ‡å®š CPU çš„è¿è¡Œé˜Ÿåˆ—
  - [x] init_per_cpu_rq(cpu_id) å‡½æ•° - åˆå§‹åŒ– per-CPU é˜Ÿåˆ—
  - [x] Per-CPU ä»»åŠ¡é˜Ÿåˆ—
  - [x] æ¬¡æ ¸è°ƒåº¦å™¨åˆå§‹åŒ–ï¼ˆåœ¨ secondary_cpu_start ä¸­è°ƒç”¨ï¼‰
  - [x] schedule() ä½¿ç”¨ this_cpu_rq()
  - [x] **è´Ÿè½½å‡è¡¡** âœ… å·²å®Œæˆ (2025-02-04)
  - [x] è´Ÿè½½æ£€æµ‹æœºåˆ¶ - rq_load() å‡½æ•°
  - [x] ä»»åŠ¡è¿ç§»ï¼ˆsteal taskï¼‰- steal_task() å‡½æ•°
  - [x] è´Ÿè½½å‡è¡¡ç®—æ³• - load_balance() å‡½æ•°
  - [x] é›†æˆåˆ° schedule() è°ƒåº¦å™¨

**å®æ–½æ­¥éª¤**ï¼š
1. âœ… ä¿®æ”¹ RunQueue æ•°æ®ç»“æ„ - å®Œæˆ
2. âœ… å®ç° this_cpu_rq() è®¿é—®å‡½æ•° - å®Œæˆ
3. âœ… åœ¨ SMP åˆå§‹åŒ–æ—¶è°ƒç”¨ init_per_cpu_rq() - å®Œæˆ
4. âœ… æ›´æ–° schedule() å‡½æ•°ä½¿ç”¨ this_cpu_rq() - å®Œæˆ
5. âœ… å®ç°åŸºç¡€è´Ÿè½½å‡è¡¡ - å®Œæˆ

**å®Œæˆæ—¶é—´**ï¼š2025-02-04
**éš¾åº¦**ï¼šâ­â­â­â­ (é«˜)
**ä¼˜å…ˆçº§**ï¼šğŸ”´ ä¸¥é‡ï¼ˆSMP æ€§èƒ½ç“¶é¢ˆï¼‰

**éªŒè¯çŠ¶æ€**ï¼š
```
sched: Initializing CPU 0 runqueue
sched: CPU 0 runqueue [OK]
[CPU1 up]
[CPU1] init: runqueue
sched: Initializing CPU 1 runqueue
sched: CPU 1 runqueue [OK]
[CPU1] init: IRQ enabled
[CPU1] idle: waiting for work
SMP: 2 CPUs online
```

### 8.2 å¿«é€Ÿèƒœåˆ© âœ… **å·²å®Œæˆ (2025-02-04)**

#### Quick Win 1: SimpleArc Clone æ”¯æŒ âœ… **å·²å®Œæˆ**
**é—®é¢˜**ï¼šå¯¼è‡´å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿæ“ä½œè¿”å› `None`
**ä½ç½®**ï¼š[kernel/src/collection.rs:390](kernel/src/collection.rs:390)
**å®æ–½**ï¼šClone trait å·²åœ¨ collection.rs å®ç°
**ä¿®å¤**ï¼š
- RootFSNode::find_child() - ç§»é™¤ TODOï¼Œä½¿ç”¨ child.clone()
- RootFSNode::list_children() - å®ç°æ­£ç¡®çš„å­èŠ‚ç‚¹å…‹éš†
**éªŒè¯**ï¼šâœ… ç¼–è¯‘é€šè¿‡

#### Quick Win 2: RootFS write_data offset bug âœ… **å·²å®Œæˆ**
**é—®é¢˜**ï¼šæ–‡ä»¶å†™å…¥å¿½ç•¥ offset å‚æ•°
**ä½ç½®**ï¼š[kernel/src/fs/rootfs.rs:185](kernel/src/fs/rootfs.rs:185)
**ä¿®å¤**ï¼š
```rust
pub fn write_data(&mut self, offset: usize, data: &[u8]) -> usize {
    if let Some(ref mut existing_data) = self.data {
        let required_size = offset + data.len();
        if existing_data.len() < required_size {
            existing_data.resize(required_size, 0);
        }
        existing_data[offset..offset + data.len()].copy_from_slice(data);
        data.len()
    } else {
        0
    }
}
```
**éªŒè¯**ï¼šâœ… ç¼–è¯‘é€šè¿‡

#### Quick Win 3: Dentry/Inode ç¼“å­˜æœºåˆ¶ âœ… **å·²å®Œæˆ (2025-02-04)**
**é—®é¢˜**ï¼šæ–‡ä»¶ç³»ç»Ÿç¼ºå°‘ç¼“å­˜å¯¼è‡´æ€§èƒ½ä½ä¸‹
**ä½ç½®**ï¼š
- [kernel/src/fs/dentry.rs](kernel/src/fs/dentry.rs) - Dentry ç¼“å­˜
- [kernel/src/fs/inode.rs](kernel/src/fs/inode.rs) - Inode ç¼“å­˜
- [kernel/src/fs/rootfs.rs](kernel/src/fs/rootfs.rs) - RootFS è·¯å¾„ç¼“å­˜

**å®æ–½**ï¼š
- Dentry ç¼“å­˜ (dcache): 256-bucket å“ˆå¸Œè¡¨ï¼ŒFNV-1a å“ˆå¸Œ
- Inode ç¼“å­˜ (icache): 256-bucket å“ˆå¸Œè¡¨ï¼ŒFNV-1a å“ˆå¸Œ
- RootFS è·¯å¾„ç¼“å­˜: RootFS ä¸“ç”¨è·¯å¾„ç¼“å­˜
- ç¼“å­˜ç»Ÿè®¡åŠŸèƒ½ï¼ˆå‘½ä¸­/æœªå‘½ä¸­è®¡æ•°ï¼‰

**éªŒè¯**ï¼šâœ… ç¼–è¯‘é€šè¿‡ï¼Œå†…æ ¸è¿è¡Œæ­£å¸¸

**å®Œæˆæ—¶é—´**ï¼š2025-02-04
**éš¾åº¦**ï¼šâ­â­â­ (ä¸­)
**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ é«˜ï¼ˆå½±å“æ€§èƒ½ï¼‰

#### Quick Win 4: è·¯å¾„è§„èŒƒåŒ– âœ… **å·²å®Œæˆ (2025-02-04)**
**é—®é¢˜**ï¼šè·¯å¾„è§£æç¼ºå°‘è§„èŒƒåŒ–ï¼Œä¸æ”¯æŒ `.` å’Œ `..` ç‰¹æ®Šç›®å½•
**ä½ç½®**ï¼š
- [kernel/src/fs/path.rs](kernel/src/fs/path.rs) - è·¯å¾„è§£ææ¨¡å—
- [kernel/src/fs/rootfs.rs](kernel/src/fs/rootfs.rs) - RootFS æŸ¥æ‰¾é›†æˆ

**å®æ–½**ï¼š
- path_normalize() - è·¯å¾„è§„èŒƒåŒ–å‡½æ•°
  - ç§»é™¤å¤šä½™çš„ `/`
  - å¤„ç† `.` (å½“å‰ç›®å½•)
  - å¤„ç† `..` (çˆ¶ç›®å½•)
  - æ”¯æŒç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„
- RootFS::lookup() é›†æˆè·¯å¾„è§„èŒƒåŒ–
- å®Œæ•´çš„å•å…ƒæµ‹è¯•è¦†ç›–

**éªŒè¯**ï¼šâœ… ç¼–è¯‘é€šè¿‡ï¼Œå†…æ ¸è¿è¡Œæ­£å¸¸

**å®Œæˆæ—¶é—´**ï¼š2025-02-04
**éš¾åº¦**ï¼šâ­â­ (ä½)
**ä¼˜å…ˆçº§**ï¼šğŸŸ¡ é«˜ï¼ˆå½±å“æ­£ç¡®æ€§ï¼‰

---

## Phase 9: ç½‘ç»œä¸é«˜çº§åŠŸèƒ½ â³

---

## Phase 8: ç½‘ç»œä¸é«˜çº§åŠŸèƒ½

### 5.1 ç½‘ç»œåè®®æ ˆ
- [ ] **ç½‘ç»œæ¡†æ¶** (`net/net.rs`)
  - [ ] socket æ¥å£
  - [ ] åè®®æ—ç®¡ç†
  - [ ] ç½‘ç»œè®¾å¤‡æŠ½è±¡
- [ ] **ä»¥å¤ªç½‘é©±åŠ¨** (`drivers/net/virtio-net.rs`)
  - [ ] virtio-net é©±åŠ¨
  - [ ] æ•°æ®åŒ…å‘é€/æ¥æ”¶
  - [ ] ä¸­æ–­å¤„ç†
- [ ] **IP åè®®** (`net/ip.rs`)
  - [ ] IPv4
  - [ ] è·¯ç”±
  - [ ] åˆ†ç‰‡é‡ç»„
- [ ] **TCP/UDP** (`net/tcp.rs`, `net/udp.rs`)
  - [ ] è¿æ¥ç®¡ç†
  - [ ] æ»‘åŠ¨çª—å£
  - [ ] æ‹¥å¡æ§åˆ¶

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š14-21 å¤©

---

### 5.2 IPC æœºåˆ¶
- [ ] **ç®¡é“** (`ipc/pipe.rs`)
  - [ ] åŒ¿åç®¡é“
  - [ ] å‘½åç®¡é“ï¼ˆFIFOï¼‰
- [ ] **æ¶ˆæ¯é˜Ÿåˆ—** (`ipc/msg.rs`)
  - [ ] System V æ¶ˆæ¯é˜Ÿåˆ—
  - [ ] POSIX æ¶ˆæ¯é˜Ÿåˆ—
- [ ] **å…±äº«å†…å­˜** (`ipc/shm.rs`)
  - [ ] System V å…±äº«å†…å­˜
  - [ ] POSIX å…±äº«å†…å­˜
- [ ] **ä¿¡å·é‡** (`ipc/sem.rs`)
  - [ ] System V ä¿¡å·é‡
  - [ ] POSIX ä¿¡å·é‡

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 5.3 åŒæ­¥åŸè¯­
- [ ] **é”æœºåˆ¶** (`sync/lock.rs`)
  - [ ] Mutexï¼ˆè‡ªæ—‹é”ï¼‰
  - [ ] RwLockï¼ˆè¯»å†™é”ï¼‰
  - [ ] SeqLockï¼ˆåºåˆ—é”ï¼‰
  - [ ] RCUï¼ˆè¯»-æ‹·è´-æ›´æ–°ï¼‰
- [ ] **å¹¶å‘åŸè¯­** (`sync/atomic.rs`)
  - [ ] Atomic ç±»å‹
  - [ ] å†…å­˜å±éšœ
  - [ ] åŸå­æ“ä½œ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š3-5 å¤©

---

## Phase 6: å¤šå¹³å°æ”¯æŒ

### 6.1 x86_64 å¹³å°
- [ ] **x86_64 å¯åŠ¨ä»£ç **
  - [ ] æ±‡ç¼–å¯åŠ¨ä»£ç 
  - [ ] é•¿æ¨¡å¼è®¾ç½®
- [ ] **x86_64 å†…å­˜ç®¡ç†**
  - [ ] é¡µè¡¨è®¾ç½®ï¼ˆ4çº§é¡µè¡¨ï¼‰
  - [ ] MMU é…ç½®
- [ ] **x86_64 ä¸­æ–­å¤„ç†**
  - [ ] IDT è®¾ç½®
  - [ ] ä¸­æ–­å¤„ç†
- [ ] **x86_64 é©±åŠ¨**
  - [ ] UARTï¼ˆ8250/16550ï¼‰
  - [ ] APIC
  - [ ] HPET å®šæ—¶å™¨

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š10-14 å¤©

---

### 6.2 riscv64 å¹³å°
- [ ] **riscv64 å¯åŠ¨ä»£ç **
- [ ] **riscv64 å†…å­˜ç®¡ç†**
- [ ] **riscv64 ä¸­æ–­å¤„ç†**
- [ ] **riscv64 é©±åŠ¨**

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

## Phase 7: è®¾å¤‡é©±åŠ¨

### 7.1 PCIe æ”¯æŒ
- [ ] **PCIe æšä¸¾** (`drivers/pci/`)
  - [ ] PCI æ€»çº¿æšä¸¾
  - [ ] è®¾å¤‡é…ç½®
  - [ ] èµ„æºåˆ†é…
- [ ] **PCIe é©±åŠ¨æ¡†æ¶**
  - [ ] é©±åŠ¨æ³¨å†Œ
  - [ ] è®¾å¤‡åŒ¹é…
  - [ ] èµ„æºæ˜ å°„

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 7.2 å­˜å‚¨æ§åˆ¶å™¨
- [ ] **AHCI é©±åŠ¨** (`drivers/ahci.rs`)
  - [ ] SATA æ§åˆ¶å™¨
  - [ ] å‘½ä»¤é˜Ÿåˆ—
  - [ ] DMA æ”¯æŒ
- [ ] **NVMe é©±åŠ¨** (`drivers/nvme.rs`)
  - [ ] NVMe æ§åˆ¶å™¨
  - [ ] å‘½ä»¤æäº¤å’Œå®Œæˆ
  - [ ] å¤šé˜Ÿåˆ—æ”¯æŒ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 7.3 å›¾å½¢å’Œè¾“å…¥
- [ ] **å¸§ç¼“å†²** (`drivers/framebuffer.rs`)
  - [ ] vesafb/efifb
  - [ ] å›¾å½¢æ¨¡å¼è®¾ç½®
- [ ] **é”®ç›˜é©±åŠ¨** (`drivers/keyboard.rs`)
  - [ ] PS/2 é”®ç›˜
  - [ ] USB é”®ç›˜
- [ ] **é¼ æ ‡é©±åŠ¨** (`drivers/mouse.rs`)

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š5-7 å¤©ï¼ˆå¯é€‰ï¼‰

---

## Phase 8: ç”¨æˆ·ç©ºé—´

### 8.1 ç”¨æˆ·ç©ºé—´å·¥å…·
- [ ] **init è¿›ç¨‹**
  - [ ] PID 1 init
  - [ ] å¯åŠ¨è„šæœ¬è§£æ
  - [ ] è¿›ç¨‹ç®¡ç†
- [ ] **shell**
  - [ ] åŸºç¡€å‘½ä»¤æ”¯æŒ
  - [ ] ç®¡é“å’Œé‡å®šå‘
  - [ ] ä½œä¸šæ§åˆ¶
- [ ] **åŸºç¡€å‘½ä»¤**
  - [ ] `ls`ã€`cd`ã€`pwd`
  - [ ] `cat`ã€`echo`ã€`cp`ã€`mv`
  - [ ] `mkdir`ã€`rm`
  - [ ] `ps`ã€`top`ã€`kill`

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 8.2 ç”¨æˆ·ç©ºé—´åº“
- [ ] **libc å…¼å®¹å±‚**
  - [ ] musl libc ç§»æ¤
  - [ ] æ ‡å‡†åº“å‡½æ•°
- [ ] **åŠ¨æ€é“¾æ¥å™¨**
  - [ ] ELF åŠ è½½å™¨
  - [ ] åŠ¨æ€é“¾æ¥
  - [ ] ç¬¦å·è§£æ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š14-21 å¤©

---

## Phase 9: ä¼˜åŒ–ä¸å®Œå–„

### 9.1 æ€§èƒ½ä¼˜åŒ–
- [ ] **æ€§èƒ½åˆ†æ**
  - [ ] ç«ç„°å›¾ç”Ÿæˆ
  - [ ] çƒ­ç‚¹åˆ†æ
- [ ] **å…³é”®è·¯å¾„ä¼˜åŒ–**
  - [ ] è°ƒåº¦å™¨ä¼˜åŒ–
  - [ ] å†…å­˜åˆ†é…ä¼˜åŒ–
  - [ ] ç³»ç»Ÿè°ƒç”¨ä¼˜åŒ–
- [ ] **å¹¶å‘ä¼˜åŒ–**
  - [ ] æ— é”ç®—æ³•
  - [ ] æ‰¹é‡å¤„ç†
  - [ ] ä¸­æ–­åˆå¹¶

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šæŒç»­è¿›è¡Œ**

---

### 9.2 ç¨³å®šæ€§æå‡
- [ ] **é”™è¯¯å¤„ç†**
  - [ ] é”™è¯¯æ¢å¤
  - [ ] æ•…éšœéš”ç¦»
  - [ ] å†…æ ¸è½¬å‚¨
- [ ] **æµ‹è¯•è¦†ç›–**
  - [ ] å•å…ƒæµ‹è¯•
  - [ ] é›†æˆæµ‹è¯•
  - [ ] å‹åŠ›æµ‹è¯•
- [ ] **è°ƒè¯•å·¥å…·**
  - [ ] å†…æ ¸è°ƒè¯•å™¨
  - [ ] è¿è¡Œæ—¶è·Ÿè¸ª
  - [ ] æ€§èƒ½å‰–æ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šæŒç»­è¿›è¡Œ**

---

### 9.3 æ–‡æ¡£å®Œå–„
- [ ] **ç”¨æˆ·æ–‡æ¡£**
  - [ ] å®‰è£…æŒ‡å—
  - [ ] ä½¿ç”¨æ‰‹å†Œ
  - [ ] æ•…éšœæ’æŸ¥
- [ ] **å¼€å‘è€…æ–‡æ¡£**
  - [ ] æ¶æ„è®¾è®¡
  - [ ] API æ–‡æ¡£
  - [ ] è´¡çŒ®æŒ‡å—
- [ ] **ç¤ºä¾‹ä»£ç **
  - [ ] é©±åŠ¨å¼€å‘ç¤ºä¾‹
  - [ ] åº”ç”¨ç¨‹åºç¤ºä¾‹

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šæŒç»­è¿›è¡Œ

---

## è¿›åº¦è¿½è¸ª

### å®Œæˆåº¦ç»Ÿè®¡

| Phase | æè¿° | å®Œæˆåº¦ | é¢„è®¡å·¥ä½œé‡ |
|-------|------|--------|-----------|
| Phase 1 | åŸºç¡€æ¡†æ¶ | âœ… 100% | 5 å¤© |
| Phase 2 | ä¸­æ–­ä¸è¿›ç¨‹ | âœ… 90% | 10 å¤© |
| Phase 3 | ç³»ç»Ÿè°ƒç”¨ä¸éš”ç¦» | âœ… 80% | 8 å¤© |
| Phase 4 | æ–‡ä»¶ç³»ç»Ÿ | âœ… 75% | 12 å¤© |
| Phase 5 | SMP æ”¯æŒ | âœ… 100% | 7 å¤© |
| Phase 6 | ä»£ç å®¡æŸ¥ | âœ… 100% | 3 å¤© |
| Phase 7 | å†…å­˜ç®¡ç†ä¼˜åŒ– | âœ… 100% | 1 å¤© |
| Phase 8 | Per-CPU ä¼˜åŒ– | âœ… 80% | 1 å¤© |
| Phase 9 | å¿«é€Ÿèƒœåˆ© | â³ 0% | 1.5-3 å¤© |
| Phase 10 | ç½‘ç»œä¸IPC | â³ 0% | 21-31 å¤© |
| Phase 11 | å¤šå¹³å°æ”¯æŒ | â³ 0% | 17-24 å¤© |
| Phase 12 | è®¾å¤‡é©±åŠ¨ | â³ 0% | 12-17 å¤© |
| Phase 13 | ç”¨æˆ·ç©ºé—´ | â³ 0% | 21-31 å¤© |
| Phase 14 | ä¼˜åŒ–ä¸å®Œå–„ | â³ 0% | æŒç»­ |

**æ€»ä½“è¿›åº¦**ï¼šçº¦ 40%ï¼ˆPhase 1-8 åŸºæœ¬å®Œæˆï¼ŒPhase 9 å¿«é€Ÿèƒœåˆ©å¾…å®ç°ï¼‰

---

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**å½“å‰é‡ç‚¹**ï¼ˆWeek 4-5ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰ï¼š

#### âœ… P0 - ä¸¥é‡ä¼˜å…ˆçº§ï¼ˆå·²å®Œæˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

**~~1. Per-CPU è¿è¡Œé˜Ÿåˆ—~~** âœ… **å·²å®Œæˆ (2025-02-04)**
- âœ… åˆ›å»º feature åˆ†æ”¯ï¼š`git checkout -b feat/per-cpu-runqueue`
- âœ… ä¿®æ”¹æ•°æ®ç»“æ„ï¼šå…¨å±€ RQ â†’ per-CPU æ•°ç»„
- âœ… å®ç° `this_cpu_rq()` å‡½æ•°
- âœ… å®ç° `cpu_rq(cpu_id)` å‡½æ•°
- âœ… å®ç° `init_per_cpu_rq(cpu_id)` å‡½æ•°
- âœ… æ¬¡æ ¸è°ƒåº¦å™¨åˆå§‹åŒ–ï¼ˆåœ¨ `secondary_cpu_start` ä¸­è°ƒç”¨ï¼‰
- âœ… æ›´æ–° `schedule()` ä½¿ç”¨ `this_cpu_rq()`
- âœ… è´Ÿè½½å‡è¡¡ï¼ˆä»»åŠ¡çªƒå–ï¼‰ - å·²å®Œæˆ (2025-02-04)
  - rq_load() - è´Ÿè½½æ£€æµ‹
  - find_busiest_cpu() - æŸ¥æ‰¾ç¹å¿™ CPU
  - steal_task() - ä»»åŠ¡è¿ç§»
  - load_balance() - ä¸»å‡½æ•°
- âœ… éªŒè¯ï¼šåŒæ ¸ç‹¬ç«‹è°ƒåº¦ï¼Œæ— æ­»é”ï¼Œè´Ÿè½½å‡è¡¡å·¥ä½œ

**æäº¤è®°å½•**ï¼š
- commit b687710: "ä¼˜åŒ–å¯åŠ¨é¡ºåºï¼šGIC æå‰ï¼Œæ¬¡æ ¸åˆå§‹åŒ–å®Œå–„"
- commit 257dd99: "feat: å®ç°è´Ÿè½½å‡è¡¡æœºåˆ¶ (Load Balancing)"

**å¾…å®Œæˆä¼˜åŒ–**ï¼ˆPhase 10ï¼‰ï¼š
- Dentry/Inode ç¼“å­˜
- ç½‘ç»œåè®®æ ˆ
- IPC æœºåˆ¶

---

#### ğŸ”´ P0 - é«˜ä¼˜å…ˆçº§ï¼ˆå½±å“æ­£ç¡®æ€§ï¼‰

**~~2. SimpleArc Clone æ”¯æŒ~~** âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] Clone trait å·²åœ¨ `collection.rs` å®ç°
- [x] ä¿®å¤ RootFS æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- [x] éªŒè¯ï¼šç¼–è¯‘é€šè¿‡

**~~3. RootFS write_data offset bug~~** âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] ä¿®å¤ `write_data()` å‡½æ•°
- [x] æ”¯æŒä» offset å¼€å§‹å†™å…¥
- [x] éªŒè¯ï¼šç¼–è¯‘é€šè¿‡

---

#### ğŸŸ¢ P2 - ä¸­ä¼˜å…ˆçº§ï¼ˆä¼˜åŒ–å’Œå®‰å…¨ï¼‰

~~**4. VFS å‡½æ•°æŒ‡é’ˆå®‰å…¨æ€§**ï¼ˆ2-3 å¤©ï¼‰~~ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] ä½¿ç”¨å¼•ç”¨å’Œåˆ‡ç‰‡æ›¿ä»£è£¸æŒ‡é’ˆ
- [x] FileOps å’Œ INodeOps æ”¹è¿›
- [x] æ›´æ–°æ‰€æœ‰å®ç°ï¼ˆregã€pipeã€uartï¼‰

**5. Dentry/Inode ç¼“å­˜**ï¼ˆ2-3 å¤©ï¼‰
- [ ] å®ç°å“ˆå¸Œè¡¨ç¼“å­˜
- [ ] LRU æ·˜æ±°ç­–ç•¥

**6. Task ç»“æ„ä½“ä¼˜åŒ–**ï¼ˆ1-2 å¤©ï¼‰
- [ ] CpuContext åˆ†ç¦»
- [ ] ä½¿ç”¨ Box åŒ…è£…å¤§å‹å­—æ®µ
- [ ] ä¼˜åŒ–å­—æ®µå¸ƒå±€

---

#### âš¡ å¿«é€Ÿèƒœåˆ©ï¼ˆ1 å¤©å†…å®Œæˆï¼‰

å¦‚æœæ—¶é—´æœ‰é™ï¼Œå»ºè®®æŒ‰æ­¤é¡ºåºï¼š
1. **RootFS write_data bug**ï¼ˆ30åˆ†é’Ÿï¼‰âœ… å·²å®Œæˆ
2. **SimpleArc Clone**ï¼ˆ1-2å°æ—¶ï¼‰âœ… å·²å®Œæˆ
3. **ELF åŠ è½½å™¨å®Œå–„**ï¼ˆ2-3å°æ—¶ï¼‰âœ… å·²å®Œæˆ (2025-02-04)
   - âœ… PT_LOAD æ®µåŠ è½½å®ç°
   - âœ… BSS æ®µæ¸…é›¶ï¼ˆp_memsz > p_fileszï¼‰
   - âœ… åŠ¨æ€é“¾æ¥å™¨è·¯å¾„æå–ï¼ˆPT_INTERPï¼‰
   - âœ… execve ç³»ç»Ÿè°ƒç”¨ä¸æ–‡ä»¶ç³»ç»Ÿé›†æˆ
   - âœ… ElfLoadInfo ç»“æ„ï¼ˆåŠ è½½ä¿¡æ¯ï¼‰

---

**åç»­ç›®æ ‡**ï¼ˆPhase 8-9 å®Œæˆåï¼‰ï¼š
1. è¿›ç¨‹è°ƒåº¦ç®—æ³•ä¼˜åŒ–ï¼ˆCFSï¼‰
2. å®Œå–„ä¿¡å·å¤„ç†æœºåˆ¶
3. å®Œæ•´çš„ IPC å®ç°

---

## æŠ€æœ¯å€ºåŠ¡

### éœ€è¦é‡æ„çš„éƒ¨åˆ†
- ~~[ ] å®ç°çœŸæ­£çš„å†…å­˜åˆ†é…å™¨~~ âœ… å·²å®Œæˆ - Buddy System å®ç°å®Œæˆ
- ~~[ ] å®ç°Per-CPU è¿è¡Œé˜Ÿåˆ—~~ âœ… å·²å®Œæˆ - Per-CPU æ•°æ®ç»“æ„å®Œæˆ
  - âœ… per-CPU è¿è¡Œé˜Ÿåˆ—æ•°ç»„ï¼ˆPER_CPU_RQ[4]ï¼‰
  - âœ… this_cpu_rq() / cpu_rq() è®¿é—®å‡½æ•°
  - âœ… æ¬¡æ ¸è‡ªåŠ¨åˆå§‹åŒ–
  - â³ è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼ˆPhase 9ï¼‰
- [ ] ç»Ÿä¸€é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] å®Œå–„æ—¥å¿—ç³»ç»Ÿ

### å·²çŸ¥é—®é¢˜

**ğŸ”´ ä¸¥é‡é—®é¢˜**ï¼ˆå¾…ä¿®å¤ï¼‰ï¼š
- ~~[ ] **å†…å­˜åˆ†é…å™¨æ— æ³•é‡Šæ”¾~~ âœ… å·²è§£å†³ - Buddy System å®Œæ•´å®ç°
  - ~~å½“å‰ä½¿ç”¨ bump allocator~~ å·²æ›¿æ¢ä¸º Buddy System
  - ~~dealloc() æ˜¯ç©ºå®ç°~~ å·²æ”¯æŒä¼™ä¼´åˆå¹¶
  - ~~éœ€è¦ï¼šBuddy System / Slab Allocator~~ âœ… Buddy System å·²å®ç°
- ~~[ ] **å…¨å±€å•é˜Ÿåˆ—è°ƒåº¦å™¨~~ âœ… **å·²å®Œæˆ (2025-02-04)** - Per-CPU è¿è¡Œé˜Ÿåˆ— + è´Ÿè½½å‡è¡¡
  - âœ… æ‰€æœ‰ CPU æœ‰ç‹¬ç«‹çš„è¿è¡Œé˜Ÿåˆ—
  - âœ… this_cpu_rq() / cpu_rq() è®¿é—®å‡½æ•°
  - âœ… æ¬¡æ ¸è‡ªåŠ¨åˆå§‹åŒ–
  - âœ… è´Ÿè½½å‡è¡¡æœºåˆ¶å®ç°
  - âœ… ä»»åŠ¡è¿ç§»ç®—æ³•
  - **çŠ¶æ€**ï¼šâœ… å®Œå…¨å®Œæˆï¼ˆPhase 9ï¼‰ï¼ŒSMP è°ƒåº¦åŠŸèƒ½å®Œæ•´

**ğŸŸ¡ ä¸­ç­‰é—®é¢˜**ï¼š
- [x] ~~SimpleArc Clone æ”¯æŒ~~ âœ… å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
- [x] ~~RootFS write_data offset bug~~ âœ… å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
- [x] ~~VFS å‡½æ•°æŒ‡é’ˆå®‰å…¨æ€§~~ âœ… å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
  - ä½¿ç”¨å¼•ç”¨å’Œåˆ‡ç‰‡æ›¿ä»£è£¸æŒ‡é’ˆ
- [ ] Dentry/Inode ç¼“å­˜ - æ€§èƒ½é—®é¢˜
  - **è®¡åˆ’**ï¼šPhase 10 ä¸­ä¼˜å…ˆçº§

**ğŸŸ¢ ä½ä¼˜å…ˆçº§**ï¼š
- [ ] Task ç»“æ„ä½“è¿‡å¤§ï¼ˆ660+ bytesï¼‰
- [ ] å‘½åçº¦å®šä¸ä¸€è‡´
- [ ] IPI æµ‹è¯•ä»£ç æ¸…ç†
- [ ] CpuContext åˆ†ç¦»ï¼ˆå†…æ ¸/ç”¨æˆ·å¯„å­˜å™¨ï¼‰

### å·²è§£å†³é—®é¢˜ âœ…
- [x] **MMU ä½¿èƒ½é—®é¢˜** - å·²è§£å†³ âœ…
  - ä½¿ç”¨ 3 çº§é¡µè¡¨ç»“æ„
  - æ­£ç¡®é…ç½® TCR_EL1ã€MAIR_EL1
  - MMU å·²æˆåŠŸå¯ç”¨
- [x] **GIC åˆå§‹åŒ–æŒ‚èµ·** - å·²è§£å†³ âœ…
  - GICD å†…å­˜è®¿é—®é—®é¢˜ä¿®å¤ï¼ˆ2025-02-04ï¼‰
  - read_volatile() â†’ å†…è”æ±‡ç¼– ldr/str
  - GICD/GICR å®Œå…¨åˆå§‹åŒ–ï¼ˆ32 IRQsï¼‰
  - ä½¿ç”¨å†…è”æ±‡ç¼–æ›¿ä»£ Rust volatile æ“ä½œ
- [x] **ä¸­æ–­é£æš´** - å·²è§£å†³ âœ…
  - ä¼˜åŒ– IRQ å¯ç”¨æ—¶åº
  - åœ¨ SMP åˆå§‹åŒ–å®Œæˆåå¯ç”¨
- [x] **Buddy System å†…å­˜åˆ†é…å™¨** - å·²è§£å†³ âœ… (2025-02-04)
  - å®Œæ•´å®ç°ä¼™ä¼´ç³»ç»Ÿç®—æ³•
  - æ”¯æŒ O(log n) åˆ†é…/é‡Šæ”¾
  - ä¼™ä¼´åˆå¹¶æœºåˆ¶å‡å°‘ç¢ç‰‡
  - çº¿ç¨‹å®‰å…¨ï¼ˆåŸå­æ“ä½œï¼‰
  - æµ‹è¯•éªŒè¯é€šè¿‡
- [x] **ELF åŠ è½½å™¨åŸºç¡€** - å·²è§£å†³ âœ… (2025-02-04)
  - PT_LOAD æ®µåŠ è½½åˆ°å†…å­˜
  - BSS æ®µæ¸…é›¶å¤„ç†
  - åŠ¨æ€é“¾æ¥å™¨è·¯å¾„æå–ï¼ˆPT_INTERPï¼‰
  - execve ä¸æ–‡ä»¶ç³»ç»Ÿé›†æˆ
  - å‚è€ƒ Linux fs/binfmt_elf.c
  - **é™åˆ¶**ï¼šåœ°å€ç©ºé—´ç®¡ç†å¾…å®Œå–„ï¼ˆPhase 13ï¼‰
- [x] **åœ°å€ç©ºé—´ç®¡ç†åŸºç¡€** - å·²è§£å†³ âœ… (2025-02-04)
  - pagemap::AddressSpace æ‰©å±• mmap/munmap/brk/allocate_stack
  - VMA ç®¡ç†å™¨é›†æˆï¼ˆVmaManagerï¼‰
  - mmap ç³»ç»Ÿè°ƒç”¨å®ç°
  - munmap ç³»ç»Ÿè°ƒç”¨å®ç°
  - brk ç³»ç»Ÿè°ƒç”¨å®ç°
  - ç”¨æˆ·æ ˆåˆ†é…ï¼ˆallocate_stackï¼‰
  - å‚è€ƒ Linux mm/mmap.c å’Œ mm/mm_types.h
  - **é™åˆ¶**ï¼šå®Œæ•´ PGD åˆå§‹åŒ–å¾…å®ç°ï¼ˆPhase 13ï¼‰

---

## Phase 10: RISC-V 64ä½æ¶æ„ âœ… **å·²å®Œæˆ** (2025-02-06)

### ç›®æ ‡
å®ç°å®Œæ•´çš„ RISC-V 64ä½æ¶æ„æ”¯æŒï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºé»˜è®¤æ„å»ºç›®æ ‡ã€‚

### å®ŒæˆçŠ¶æ€ âœ…

#### æ ¸å¿ƒåŠŸèƒ½å®ç° âœ…
- [x] **å¯åŠ¨æµç¨‹** (boot.rs)
  - [x] æ ˆæŒ‡é’ˆè®¾ç½®ï¼ˆ0x801F_C000ï¼Œ16KB æ ˆï¼‰
  - [x] BSS æ®µæ¸…é›¶
  - [x] trap å‘é‡è®¾ç½®ï¼ˆstvecï¼‰
  - [x] main() å‡½æ•°è°ƒç”¨
  - [x] OpenSBI é›†æˆ

- [x] **å¼‚å¸¸å¤„ç†** (trap.rs + trap.S)
  - [x] global_asm trap_entryï¼ˆæ±‡ç¼–å…¥å£ï¼‰
  - [x] å¯„å­˜å™¨ä¿å­˜/æ¢å¤ï¼ˆx1, x5-x31ï¼‰
  - [x] S-mode CSR ä¿å­˜ï¼ˆsstatus, sepc, stvalï¼‰
  - [x] trap_handler Rust å‡½æ•°
  - [x] å¼‚å¸¸åˆ†å‘ï¼ˆscause è§£æï¼‰
  - [x] sret è¿”å›æŒ‡ä»¤

- [x] **ä¸Šä¸‹æ–‡åˆ‡æ¢** (context.rs)
  - [x] TaskContext ç»“æ„ä½“
  - [x] cpu_switch_to æ±‡ç¼–å®ç°
  - [x] é€šç”¨å¯„å­˜å™¨åˆ‡æ¢
  - [x] SP/RA å¯„å­˜å™¨åˆ‡æ¢

- [x] **CPU æ“ä½œ** (cpu.rs)
  - [x] get_core_id() - mhartid è¯»å–
  - [x] enable_irq() - sie ä¸­æ–­ä½¿èƒ½
  - [x] disable_irq() - sie ä¸­æ–­ç¦ç”¨
  - [x] wfi() - Wait For Interrupt
  - [x] read_counter() - time CSR è¯»å–
  - [x] get_counter_freq() - 10MHz (QEMU virt)

- [x] **ç³»ç»Ÿè°ƒç”¨** (syscall.rs)
  - [x] syscall_handler å‡½æ•°
  - [x] ç³»ç»Ÿè°ƒç”¨å·è§£æï¼ˆa7 å¯„å­˜å™¨ï¼‰
  - [x] ç³»ç»Ÿè°ƒç”¨åˆ†å‘
  - [x] è¿”å›å€¼è®¾ç½®ï¼ˆa0 å¯„å­˜å™¨ï¼‰

- [x] **UART é©±åŠ¨** (console.rs)
  - [x] RISC-V UART åŸºå€ï¼ˆ0x10000000 - ns16550aï¼‰
  - [x] UART åˆå§‹åŒ–
  - [x] putc/getc å‡½æ•°
  - [x] å¹³å°æ¡ä»¶ç¼–è¯‘

- [x] **é“¾æ¥å™¨è„šæœ¬** (linker.ld)
  - [x] å†…å­˜å¸ƒå±€å®šä¹‰ï¼ˆ0x80200000ï¼‰
  - [x] é¿å¼€ OpenSBI åŒºåŸŸï¼ˆ0x80000000-0x8001ffffï¼‰
  - [x] .text æ®µï¼ˆä»£ç ï¼‰
  - [x] .data æ®µï¼ˆæ•°æ®ï¼‰
  - [x] .bss æ®µï¼ˆæœªåˆå§‹åŒ–æ•°æ®ï¼‰
  - [x] æ ˆç©ºé—´åˆ†é…ï¼ˆ16KBï¼‰

- [x] **è¿è¡Œè„šæœ¬** (test/run_riscv64.sh)
  - [x] QEMU å‘½ä»¤æ„å»º
  - [x] OpenSBI è‡ªåŠ¨åŠ è½½
  - [x] å•æ ¸/å¤šæ ¸æ¨¡å¼æ”¯æŒ
  - [x] å†…æ ¸äºŒè¿›åˆ¶æ£€æŸ¥

#### å…³é”®ä¿®å¤ âœ…
- [x] **M-mode â†’ S-mode CSR è½¬æ¢**
  - [x] mstatus â†’ sstatus
  - [x] mepc â†’ sepc
  - [x] mtval â†’ stval
  - [x] mtvec â†’ stvec
  - [x] mcause â†’ scause
  - [x] mret â†’ sret

- [x] **å†…å­˜å¸ƒå±€ä¼˜åŒ–**
  - [x] å†…æ ¸åŠ è½½åœ°å€ï¼š0x80200000
  - [x] æ ˆæŒ‡é’ˆï¼š0x801F_C000
  - [x] é¿å¼€ OpenSBIï¼š0x80000000-0x8001ffff

- [x] **é…ç½®æ–‡ä»¶æ›´æ–°**
  - [x] kernel/Cargo.toml - default = ["riscv64"]
  - [x] .cargo/config.toml - target = "riscv64gc-unknown-none-elf"
  - [x] riscv64gc-unknown-none-elf target å®šä¹‰

#### æµ‹è¯•éªŒè¯ âœ…
```
OpenSBI v0.9
...
Domain0 Next Mode: S-mode
...
Rux Kernel v0.1.0 starting...
Target platform: riscv64
Initializing architecture...
arch: Initializing RISC-V architecture...
trap: Initializing RISC-V trap handling...
trap: Exception vector table installed at stvec = 0x80204084
trap: RISC-V trap handling [OK]
```

#### æ–‡æ¡£æ›´æ–° âœ…
- [x] README.md - RISC-V è¯´æ˜
- [x] TODO.md - Phase 10 å®Œæˆ
- [x] é¡¹ç›®ç»“æ„æ›´æ–°
- [x] å¿«é€Ÿå¼€å§‹æŒ‡å—æ›´æ–°

### æŠ€æœ¯çªç ´

1. **æˆåŠŸè¿ç§»åˆ° RISC-V æ¶æ„**
   - ä» ARM aarch64 åˆ‡æ¢åˆ° RISC-V 64ä½
   - ä¿æŒç›¸åŒçš„å†…æ ¸æ¥å£å’ŒåŠŸèƒ½

2. **æ­£ç¡®å¤„ç†æƒé™åˆ†ç¦»**
   - OpenSBI è¿è¡Œåœ¨ M-mode
   - å†…æ ¸è¿è¡Œåœ¨ S-mode
   - æ­£ç¡®ä½¿ç”¨ S-mode CSR

3. **å†…å­˜å¸ƒå±€ä¼˜åŒ–**
   - é¿å¼€ OpenSBI å›ºä»¶åŒºåŸŸ
   - æ­£ç¡®çš„å†…æ ¸åŠ è½½åœ°å€
   - æœ‰æ•ˆçš„æ ˆç©ºé—´ç®¡ç†

4. **å®Œæ•´çš„å¼‚å¸¸å¤„ç†**
   - S-mode å¼‚å¸¸å‘é‡
   - CSR å¯„å­˜å™¨æ­£ç¡®è®¿é—®
   - å¼‚å¸¸åˆ†å‘å’Œå¤„ç†

### å·²çŸ¥é™åˆ¶

- **RISC-V ç‰¹å®š**ï¼š
  - â³ PLIC (Platform-Level Interrupt Controller) å¾…å®ç°
  - â³ CLINT (Core-Local Interrupt Controller) å¾…å®ç°
  - â³ å®šæ—¶å™¨ä¸­æ–­å¾…å®ç°
  - â³ SMP å¤šæ ¸æ”¯æŒå¾…å®ç°

- **é€šç”¨**ï¼š
  - â³ ç”¨æˆ·ç©ºé—´ç¨‹åºåŠ è½½å¾…å®Œå–„
  - â³ æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½æ‰©å±•
  - â³ ç½‘ç»œåè®®æ ˆå®ç°

### å‚è€ƒèµ„æ–™

- [RISC-V ç‰¹æƒæ¶æ„è§„èŒƒ](https://riscv.org/technical/specifications/)
- [RISC-V æŒ‡ä»¤é›†æ‰‹å†Œ](https://riscv.org/technical/specifications/)
- [OpenSBI æ–‡æ¡£](https://github.com/riscv/opensbi/blob/master/docs/)
- [QEMU RISC-V virt å¹³å°](https://www.qemu.org/docs/master/system/riscv/virt.html)

---

## å‚è€ƒèµ„æ–™

- [Linux ç³»ç»Ÿè°ƒç”¨è¡¨](https://man7.org/linux/man-pages/man2/syscalls.2.html)
- [ARMv8 æ¶æ„å‚è€ƒæ‰‹å†Œ](https://developer.arm.com/documentation/ddi0487/latest)
- [GICv3 è§„èŒƒ](https://developer.arm.com/documentation/ihi0069/latest)
- [OSDev Wiki](https://wiki.osdev.org/)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv0.4.0
**æœ€åæ›´æ–°**ï¼š2025-02-06
