# Rux å¼€å‘è·¯çº¿å›¾ä¸ŽTODO

## é¡¹ç›®æ¦‚è§ˆ

**å½“å‰çŠ¶æ€**ï¼šPhase 8 è¿›è¡Œä¸­ ðŸ”„ - æ–‡æ¡£å®Œå–„å’ŒåŠŸèƒ½ä¼˜åŒ–

**æœ€åŽæ›´æ–°**ï¼š2025-02-04

**æœ€æ–°æˆå°±**ï¼š
- âœ… **Per-CPU è¿è¡Œé˜Ÿåˆ—** (2025-02-04)
  - å…¨å±€ RQ æ”¹ä¸º per-CPU æ•°ç»„ï¼ˆMAX_CPUS=4ï¼‰
  - this_cpu_rq() / cpu_rq() è®¿é—®å‡½æ•°
  - init_per_cpu_rq() åˆå§‹åŒ–å‡½æ•°
  - æ¬¡æ ¸è°ƒåº¦å™¨è‡ªåŠ¨åˆå§‹åŒ–
- âœ… **å¯åŠ¨é¡ºåºä¼˜åŒ–** (2025-02-04)
  - å‚è€ƒ Linux ARM64 å†…æ ¸å¯åŠ¨é¡ºåº
  - GIC åˆå§‹åŒ–æå‰åˆ° scheduler/VFS ä¹‹å‰
  - æ¬¡æ ¸å®Œå–„åˆå§‹åŒ–ï¼ˆrunqueueã€æ ˆã€IRQï¼‰
  - åˆ›å»º BOOT_SEQUENCE.md è¯¦ç»†æ–‡æ¡£
- âœ… **SMP åŒæ ¸å¯åŠ¨æˆåŠŸ** (2025-02-04)
  - PSCI CPU å”¤é†’æœºåˆ¶
  - Per-CPU æ ˆç®¡ç†
  - æ¬¡æ ¸å¯åŠ¨å…¥å£ç‚¹
  - CPU æ•°é‡æ£€æµ‹
  - æ¬¡æ ¸ runqueue åˆå§‹åŒ–
- âœ… **GICv3 ä¸­æ–­æŽ§åˆ¶å™¨** (2025-02-04)
  - æœ€å°åˆå§‹åŒ–å®Œæˆ
  - ç³»ç»Ÿå¯„å­˜å™¨è®¿é—®ï¼ˆICC_IAR1_EL1, ICC_EOIR1_EL1ï¼‰
  - Spurious interrupt å¤„ç† (IRQ 1023)
  - ä¸­æ–­å±è”½/æ¢å¤æœºåˆ¶
  - æ­£ç¡®çš„åˆå§‹åŒ–é¡ºåºï¼ˆMMU â†’ GIC â†’ SMPï¼‰
- âœ… **IPI (æ ¸é—´ä¸­æ–­)** (2025-02-04)
  - åŸºäºŽ SGI çš„ IPI å‘é€ï¼ˆICC_SGI1R_EL1ï¼‰
  - IPI å¤„ç†æ¡†æž¶
  - Reschedule/Stop IPI ç±»åž‹
- âœ… **MMU å¤šçº§é¡µè¡¨** (2025-02-04)
  - 3 çº§é¡µè¡¨ç»“æž„ï¼ˆ4KB é¡µé¢ï¼‰
  - MMU æˆåŠŸå¯ç”¨
  - æ’ç­‰æ˜ å°„å’Œç”¨æˆ·ç©ºé—´æ˜ å°„
- âœ… **ä¸­æ–­é£Žæš´ä¿®å¤** (2025-02-04)
  - IRQ æ—¶åºæŽ§åˆ¶ä¼˜åŒ–
  - åœ¨ SMP åˆå§‹åŒ–å®ŒæˆåŽå¯ç”¨ IRQ
- âœ… **å…¨é¢ä»£ç å®¡æŸ¥** (2025-02-04)
  - å‘çŽ°å¹¶è®°å½• 15 ä¸ªé—®é¢˜
  - æ¸…ç† 50+ å¤„è°ƒè¯•è¾“å‡º
  - æ¡ä»¶ç¼–è¯‘ä¼˜åŒ–ï¼ˆ#[cfg(debug_assertions)]ï¼‰
- âœ… **æµ‹è¯•è„šæœ¬å®Œå–„** (2025-02-04)
  - test_suite.sh - å®Œæ•´æµ‹è¯•å¥—ä»¶
  - test_smp.sh - SMP åŠŸèƒ½æµ‹è¯•
  - test_ipi.sh - IPI åŠŸèƒ½æµ‹è¯•
  - test_qemu.sh - QEMU é…ç½®æµ‹è¯•
- âœ… æˆåŠŸè§£å†³ alloc crate ç¬¦å·å¯è§æ€§é—®é¢˜
- âœ… **Buddy System å†…å­˜åˆ†é…å™¨** (2025-02-04)
  - å®Œæ•´çš„ä¼™ä¼´ç³»ç»Ÿå®žçŽ°
  - æ”¯æŒå†…å­˜é‡Šæ”¾å’Œä¼™ä¼´åˆå¹¶
  - O(log n) åˆ†é…/é‡Šæ”¾å¤æ‚åº¦
  - æœ€å¤§æ”¯æŒ 4GB å†…å­˜å—
  - åŸºäºŽ 4KB é¡µé¢çš„åˆ†é…
  - çº¿ç¨‹å®‰å…¨ï¼ˆåŽŸå­æ“ä½œï¼‰
- âœ… å®žçŽ°è‡ªå®šä¹‰é›†åˆç±»åž‹ (SimpleBox/SimpleVec/SimpleString/SimpleArc)
- âœ… VFS æ¡†æž¶å°±ç»ªå¹¶æˆåŠŸåˆå§‹åŒ–
- âœ… RootFS å†…å­˜æ–‡ä»¶ç³»ç»Ÿå®Œæ•´å®žçŽ°

**å·²çŸ¥å¾…ä¿®å¤é—®é¢˜**ï¼ˆè¯¦è§ [CODE_REVIEW.md](CODE_REVIEW.md)ï¼‰ï¼š

**ðŸ”´ ä¸¥é‡ä¼˜å…ˆçº§**ï¼š
- ~~**å†…å­˜åˆ†é…å™¨æ— æ³•é‡Šæ”¾å†…å­˜**~~ - âœ… å·²è§£å†³ï¼šBuddy System å®žçŽ°å®Œæˆ
- ~~**å…¨å±€å•é˜Ÿåˆ—è°ƒåº¦å™¨**~~ - âœ… éƒ¨åˆ†å®Œæˆï¼šPer-CPU è¿è¡Œé˜Ÿåˆ—å·²å®žçŽ°
  - âœ… Per-CPU æ•°æ®ç»“æž„å®Œæˆ
  - â³ è´Ÿè½½å‡è¡¡æœºåˆ¶å¾…å®žçŽ°ï¼ˆPhase 9ï¼‰

**é«˜ä¼˜å…ˆçº§**ï¼š
- ~~â³ SimpleArc Clone æ”¯æŒ~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰
- ~~â³ RootFS write_data offset bug~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰

**ä¸­ä¼˜å…ˆçº§**ï¼š
- ~~â³ VFS å‡½æ•°æŒ‡é’ˆå®‰å…¨æ€§~~ âœ… å·²ä¿®å¤ï¼ˆ2025-02-04ï¼‰
- â³ Dentry/Inode ç¼“å­˜æœºåˆ¶
- â³ Task ç»“æž„ä½“è¿‡å¤§ï¼ˆ660+ bytesï¼‰

**ä½Žä¼˜å…ˆçº§**ï¼š
- â³ å‘½åçº¦å®šä¸ä¸€è‡´
- â³ IPI æµ‹è¯•ä»£ç æ¸…ç†
- â³ CpuContext åˆ†ç¦»ï¼ˆå†…æ ¸/ç”¨æˆ·å¯„å­˜å™¨ï¼‰
- â³ è·¯å¾„è§£æžå®Œå–„ï¼ˆç¬¦å·é“¾æŽ¥ã€ç›¸å¯¹è·¯å¾„ï¼‰

---

## Phase 1: åŸºç¡€æ¡†æž¶ âœ… **å·²å®Œæˆ**

### âœ… å·²å®Œæˆé¡¹ç›®

- [x] **é¡¹ç›®ç»“æž„æ­å»º**
  - [x] Workspace é…ç½®
  - [x] å†…æ ¸ crate é…ç½®ï¼ˆno_stdï¼‰
  - [x] äº¤å‰ç¼–è¯‘é…ç½®ï¼ˆaarch64-unknown-noneï¼‰
  - [x] é“¾æŽ¥å™¨è„šæœ¬
  - [x] æž„å»ºå’Œæµ‹è¯•è„šæœ¬

- [x] **å¹³å°å¯åŠ¨ä»£ç  (aarch64)**
  - [x] æ±‡ç¼–å¯åŠ¨ä»£ç  (`arch/aarch64/boot.S`)
  - [x] å¼‚å¸¸çº§åˆ«æ£€æµ‹å’Œå¤„ç†ï¼ˆEL1/EL2/EL3ï¼‰
  - [x] æ ˆè®¾ç½®
  - [x] BSS æ®µæ¸…é›¶
  - [x] ä¸Ž Rust ä»£ç çš„é“¾æŽ¥

- [x] **UART é©±åŠ¨**
  - [x] PL011 UART é©±åŠ¨å®žçŽ°
  - [x] å­—ç¬¦è¾“å…¥/è¾“å‡º
  - [x] æ³¢ç‰¹çŽ‡é…ç½®
  - [x] `println!` å®å®žçŽ°

- [x] **åŸºç¡€å†…å­˜ç®¡ç†**
  - [x] é¡µå¸§ç®¡ç†ï¼ˆPhysFrameã€VirtPageï¼‰
  - [x] é¡µè¡¨é¡¹ç»“æž„ï¼ˆPageTableEntryï¼‰
  - [x] MMU åŸºç¡€ä»£ç ï¼ˆaarch64ï¼‰
  - [x] å †åˆ†é…å™¨ï¼ˆé“¾è¡¨åˆ†é…å™¨ï¼‰

**éªŒè¯çŠ¶æ€**ï¼š
```
$ ./run.sh
Hello from Rust!
Rux Kernel v0.1.0 starting...
```

---

## Phase 2: ä¸­æ–­ä¸Žè¿›ç¨‹ **è¿›è¡Œä¸­**

### ðŸ”„ å½“å‰ä»»åŠ¡

#### 2.0 è¿›ç¨‹ç®¡ç†åŸºç¡€ âœ… **å·²å®Œæˆ**
- [x] **EL0 åˆ‡æ¢æœºåˆ¶** (`process/usermod.rs`, `arch/aarch64/context.rs`)
- [x] **EL0 åˆ‡æ¢æœºåˆ¶** (`process/usermod.rs`, `arch/aarch64/context.rs`)
  - [x] é€šè¿‡ `eret` æŒ‡ä»¤ä»Ž EL1 åˆ‡æ¢åˆ° EL0
  - [x] SPSR å’Œ ELR_EL1 æ­£ç¡®è®¾ç½®
  - [x] ç”¨æˆ·æ ˆï¼ˆSP_EL0ï¼‰æ­£ç¡®è®¾ç½®
  - [x] ç”¨æˆ·ä»£ç å¯ä»¥åœ¨ EL0 æ­£å¸¸æ‰§è¡Œ
  - [x] éªŒè¯æµ‹è¯•ï¼šNOPã€B . ç­‰æŒ‡ä»¤æ­£å¸¸å·¥ä½œ

- [x] **ç³»ç»Ÿè°ƒç”¨æ¡†æž¶éªŒè¯** (`arch/aarch64/syscall.rs`)
  - [x] ç³»ç»Ÿè°ƒç”¨å¤„ç†ç¨‹åºï¼ˆ`syscall_handler`ï¼‰æ­£å¸¸å·¥ä½œ
  - [x] ç³»ç»Ÿè°ƒç”¨åˆ†å‘æœºåˆ¶æ­£ç¡®
  - [x] `sys_read` ç­‰ç³»ç»Ÿè°ƒç”¨å®žçŽ°æ­£å¸¸
  - [x] ä»Žå†…æ ¸ç›´æŽ¥è°ƒç”¨ç³»ç»Ÿè°ƒç”¨éªŒè¯æˆåŠŸ

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**éªŒè¯çŠ¶æ€**ï¼š
```
Testing direct syscall call from kernel...
[SVC:00]
sys_read: invalid fd
Syscall returned error (expected)
```

**å·²çŸ¥é—®é¢˜**ï¼š
- HLT/SVC æŒ‡ä»¤ä»Ž EL0 è§¦å‘ SError è€Œä¸æ˜¯åŒæ­¥å¼‚å¸¸
  - å¼‚å¸¸ç±»åž‹ï¼š0x0B (SError from EL0 32-bit)
  - ESR_EL1ï¼šEC=0x00 (Trapped WFI/WFE)
  - è¿™å¯èƒ½æ˜¯ QEMU ç‰¹æœ‰è¡Œä¸ºæˆ–é…ç½®é—®é¢˜
  - ç³»ç»Ÿè°ƒç”¨æ¡†æž¶æœ¬èº«å·²éªŒè¯å¯æ­£å¸¸å·¥ä½œ

#### 2.0.1 è¿›ç¨‹åˆ›å»º (fork) âœ… **å·²å®Œæˆ (2025-02-03)**
- [x] **fork ç³»ç»Ÿè°ƒç”¨** (`arch/aarch64/syscall.rs`, `process/sched.rs`)
  - [x] `sys_fork` (ç³»ç»Ÿè°ƒç”¨å· 57) - åˆ›å»ºå­è¿›ç¨‹
  - [x] `sys_vfork` (ç³»ç»Ÿè°ƒç”¨å· 58) - åˆ›å»ºå…±äº«åœ°å€ç©ºé—´çš„å­è¿›ç¨‹
  - [x] é™æ€ä»»åŠ¡æ± å®žçŽ°ï¼ˆé¿å…æ ˆåˆ†é…é—®é¢˜ï¼‰
  - [x] `Task::new_task_at()` å‡½æ•°ç”¨äºŽåœ¨æŒ‡å®šä½ç½®æž„é€  Task
  - [x] **éªŒè¯æˆåŠŸ**ï¼šæˆåŠŸåˆ›å»ºå­è¿›ç¨‹ï¼ŒPID = 2

**éªŒè¯çŠ¶æ€**ï¼š
```
Testing fork syscall...
do_fork: start
do_fork: allocated pool slot
do_fork: creating task at pool slot
Task::new_task_at: start
Task::new_task_at: writing fields
Task::new_task_at: done
do_fork: task created at pool slot
do_fork: done
Fork success: child PID = 00000002
```

**å…³é”®æ”¹è¿›**ï¼š
- ä½¿ç”¨é™æ€ä»»åŠ¡æ± ï¼ˆ`TASK_POOL`ï¼‰ä»£æ›¿å †åˆ†é…
- ä»»åŠ¡æ± å¤§å°ï¼š16 ä¸ªæ§½ä½
- æ¯ä¸ªæ§½ä½ï¼š512 å­—èŠ‚ï¼ˆè¶³å¤Ÿå­˜å‚¨ Task ç»“æž„ä½“ï¼‰

#### 2.0.2 æ–‡ä»¶ç³»ç»Ÿç³»ç»Ÿè°ƒç”¨ âœ… **éƒ¨åˆ†å®Œæˆ (2025-02-03)**
- [x] **æ–‡ä»¶æè¿°ç¬¦ç®¡ç†** (`fs/file.rs`, `arch/aarch64/syscall.rs`)
  - [x] `sys_close` (ç³»ç»Ÿè°ƒç”¨å· 3) - å…³é—­æ–‡ä»¶æè¿°ç¬¦
  - [x] `sys_lseek` (ç³»ç»Ÿè°ƒç”¨å· 8) - é‡å®šä½æ–‡ä»¶è¯»å†™ä½ç½®
  - [x] `sys_dup` (ç³»ç»Ÿè°ƒç”¨å· 32) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦
  - [x] `sys_dup2` (ç³»ç»Ÿè°ƒç”¨å· 33) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦åˆ°æŒ‡å®šä½ç½®
  - [x] `close_file_fd()` å‡½æ•° - å…³é—­æ–‡ä»¶æè¿°ç¬¦çš„åº•å±‚å®žçŽ°

**å·²å®Œæˆç³»ç»Ÿè°ƒç”¨åˆ—è¡¨**ï¼š
- âœ… sys_read (0) - ä»Žæ–‡ä»¶æè¿°ç¬¦è¯»å–
- âœ… sys_write (1) - å†™å…¥åˆ°æ–‡ä»¶æè¿°ç¬¦
- âœ… sys_openat (2/245) - æ‰“å¼€æ–‡ä»¶
- âœ… sys_close (3) - å…³é—­æ–‡ä»¶æè¿°ç¬¦
- âœ… sys_lseek (8) - é‡å®šä½æ–‡ä»¶è¯»å†™ä½ç½®
- âœ… sys_pipe (22) - åˆ›å»ºç®¡é“
- âœ… sys_dup (32) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦
- âœ… sys_dup2 (33) - å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦åˆ°æŒ‡å®šä½ç½®
- âœ… sys_sigaction (48) - è®¾ç½®ä¿¡å·å¤„ç†å‡½æ•°
- âœ… sys_fork (57) - åˆ›å»ºå­è¿›ç¨‹
- âœ… sys_vfork (58) - åˆ›å»ºå…±äº«åœ°å€ç©ºé—´çš„å­è¿›ç¨‹
- âœ… sys_execve (59) - æ‰§è¡Œæ–°ç¨‹åº
- âœ… sys_exit (60) - é€€å‡ºè¿›ç¨‹
- âœ… sys_wait4 (61) - ç­‰å¾…å­è¿›ç¨‹
- âœ… sys_kill (62) - å‘é€ä¿¡å·
- âœ… sys_getpid (110) - èŽ·å–è¿›ç¨‹ ID
- âœ… sys_getppid (110) - èŽ·å–çˆ¶è¿›ç¨‹ ID
- âœ… sys_getuid (102) - èŽ·å–ç”¨æˆ· ID
- âœ… sys_getgid (104) - èŽ·å–ç»„ ID
- âœ… sys_geteuid (107) - èŽ·å–æœ‰æ•ˆç”¨æˆ· ID
- âœ… sys_getegid (108) - èŽ·å–æœ‰æ•ˆç»„ ID

**å¾…å®žçŽ°**ï¼š
- â³ sys_readv/sys_writev - å‘é‡è¯»å†™
- â³ sys_pread64/sys_pwrite64 - å¸¦åç§»é‡çš„è¯»å†™
- â³ sys_select/poll/epoll - I/O å¤šè·¯å¤ç”¨
- â³ sys_ioctl - è®¾å¤‡æŽ§åˆ¶
- â³ sys_fcntl - æ–‡ä»¶æŽ§åˆ¶æ“ä½œ

#### 2.1 ä¸­æ–­å’Œå¼‚å¸¸å¤„ç†æ¡†æž¶ âœ… **å¤§éƒ¨åˆ†å®Œæˆ**
- [x] **å¼‚å¸¸å‘é‡è¡¨** (`arch/aarch64/trap.S`)
  - [x] åŒæ­¥å¼‚å¸¸å¤„ç†
  - [x] IRQ å¤„ç†
  - [x] FIQ å¤„ç†
  - [x] SError å¤„ç†
  - [x] æ ˆå¸§å¸ƒå±€ä¿®å¤ï¼ˆelr/esr/spsr ä½ç½®ï¼‰
  - [x] å¯„å­˜å™¨æ¢å¤ä¿®å¤
- [x] **ä¸­æ–­æŽ§åˆ¶å™¨** (`drivers/intc/gicv3.rs`)
  - [x] GICv3 é©±åŠ¨åˆå§‹åŒ–
  - [x] ä¸­æ–­ä½¿èƒ½/ç¦ç”¨
  - [x] ä¸­æ–­åˆ†å‘
- [x] **å¼‚å¸¸å¤„ç†æ¡†æž¶** (`arch/aarch64/trap.rs`)
  - [x] ä¸Šä¸‹æ–‡ä¿å­˜/æ¢å¤
  - [x] å¼‚å¸¸åˆ†å‘
  - [x] ç³»ç»Ÿè°ƒç”¨å…¥å£
  - [x] SVC ç³»ç»Ÿè°ƒç”¨å¤„ç†
  - [x] å¼‚å¸¸ç±»åž‹è¯†åˆ«å’Œè°ƒè¯•è¾“å‡º
- [x] **å®šæ—¶å™¨é©±åŠ¨** (`drivers/timer/armv8.rs`)
  - [x] ARMv8 æž¶æž„å®šæ—¶å™¨
  - [x] å‘¨æœŸæ€§ä¸­æ–­
  - [x] æ—¶é—´æˆ³è®¡æ•°å™¨

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**ä¾èµ–å…³ç³»**ï¼šè¿›ç¨‹è°ƒåº¦ä¾èµ–äºŽä¸­æ–­æ¡†æž¶

---

#### 2.2 è¿›ç¨‹è°ƒåº¦å™¨ âœ… **åŸºç¡€æ¡†æž¶å®Œæˆ**
- [x] **è°ƒåº¦å™¨æ¡†æž¶** (`process/sched.rs`)
  - [x] è°ƒåº¦å™¨æŽ¥å£å®šä¹‰
  - [x] å°±ç»ªé˜Ÿåˆ—ç®¡ç†
  - [x] Round Robin è°ƒåº¦ç®—æ³•
- [x] **è¿›ç¨‹æŽ§åˆ¶å—** (`process/mod.rs`)
  - [x] PCB ç»“æž„å®šä¹‰
  - [x] è¿›ç¨‹çŠ¶æ€ç®¡ç†
  - [x] è¿›ç¨‹åˆ›å»º/é”€æ¯
- [x] **ä¸Šä¸‹æ–‡åˆ‡æ¢** (`arch/aarch64/context.rs`)
  - [x] ä¿å­˜é€šç”¨å¯„å­˜å™¨
  - [x] ä¿å­˜ç‰¹æ®Šå¯„å­˜å™¨ï¼ˆSPã€ELRã€SPSRï¼‰
  - [x] åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹
  - [x] switch_to_user å‡½æ•°
- [ ] **è°ƒåº¦ç­–ç•¥** (`process/sched_rr.rs`, `process/sched_cfs.rs`)
  - [x] Round Robin è°ƒåº¦
  - [ ] å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ˆCFSï¼‰
  - [ ] å®žæ—¶è°ƒåº¦ç­–ç•¥

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**ä¾èµ–å…³ç³»**ï¼šç³»ç»Ÿè°ƒç”¨ä¾èµ–äºŽè¿›ç¨‹ç®¡ç†

---

#### 2.3 è¿›ç¨‹åœ°å€ç©ºé—´ ðŸ”„ **è¿›è¡Œä¸­**
- [x] **åœ°å€ç©ºé—´ç®¡ç†** (`mm/vma.rs`)
  - [x] VMAï¼ˆè™šæ‹Ÿå†…å­˜åŒºåŸŸï¼‰ç»“æž„
  - [x] åœ°å€ç©ºé—´å¸ƒå±€
  - [ ] mmap/munmap æ”¯æŒ
- [x] **é¡µè¡¨ç®¡ç†** (`arch/aarch64/mm.rs`)
  - [x] é¡µè¡¨åˆ›å»º/é”€æ¯
  - [x] é¡µè¡¨æ¡ç›®ç»“æž„
  - [x] é¡µè¡¨æ˜ å°„è®¾ç½®
  - [ ] é¡µè¡¨å–æ¶ˆæ˜ å°„
  - [ ] å†™æ—¶å¤åˆ¶
- [ ] **å†…å­˜æ˜ å°„** (`mm/mmap.rs`)
  - [ ] åŒ¿åæ˜ å°„
  - [ ] æ–‡ä»¶æ˜ å°„
  - [ ] å…±äº«æ˜ å°„
- [ ] **ç¼ºé¡µå¼‚å¸¸å¤„ç†** (`mm/fault.rs`)
  - [ ] ç¼ºé¡µå¼‚å¸¸å¤„ç†
  - [ ] å»¶è¿Ÿåˆ†é…
  - [ ] å†™æ—¶å¤åˆ¶

**âš ï¸ MMU ä½¿èƒ½é—®é¢˜ - å·²å†³å®šæš‚æ—¶ç¦ç”¨**

**é—®é¢˜æè¿°**ï¼š
- å†…æ ¸åœ¨ `msr sctlr_el1, x0` æŒ‡ä»¤åŽæŒ‚èµ·
- é¡µè¡¨æè¿°ç¬¦æ ¼å¼å·²ä¿®å¤ï¼ˆAPã€SHã€AttrIndx å­—æ®µï¼‰
- MAIR é…ç½®å·²ä¿®å¤ï¼ˆNormal memory at AttrIdx 0, Device memory at AttrIdx 1ï¼‰
- æ’ç­‰æ˜ å°„å·²è®¾ç½®ï¼ˆ0x40000000-0x7FFFFFFFï¼‰
- TLB åˆ·æ–°å·²æ·»åŠ 
- ä½† MMU å¯ç”¨åŽç«‹å³æŒ‚èµ·ï¼Œæ— å¼‚å¸¸è¾“å‡º

**è°ƒæŸ¥ç»“æžœ**ï¼š
1. é¡µè¡¨æ¡ç›®æ ¼å¼å·²æŒ‰ ARMv8 è§„èŒƒä¿®æ­£
2. T0SZ å€¼å·²ä¿®æ­£ï¼ˆå°è¯•è¿‡ T0SZ=16 å’Œ T0SZ=0ï¼‰
3. é€šè¿‡ GDB è°ƒè¯•å‘çŽ°é€’å½’å¼‚å¸¸é—®é¢˜ï¼ˆå¼‚å¸¸å¤„ç†ç¨‹åºæœ¬èº«è§¦å‘å¼‚å¸¸ï¼‰
4. å¯¹äºŽ 64 ä½ VAï¼ˆT0SZ=0ï¼‰ï¼ŒEntry[0] æ˜ å°„åˆ° 0x0000_0000ï¼Œä¸åŒ…å«å†…æ ¸ä»£ç 

**å†³å®š**ï¼š
- **æš‚æ—¶ç¦ç”¨ MMU**ï¼Œå…ˆå®žçŽ°å…¶ä»–ä¸ä¾èµ– MMU çš„åŠŸèƒ½
- å†…æ ¸å½“å‰åœ¨ MMU ç¦ç”¨çŠ¶æ€ä¸‹è¿è¡Œæ­£å¸¸
- ç³»ç»Ÿè°ƒç”¨ã€è¿›ç¨‹è°ƒåº¦ç­‰åŠŸèƒ½å¯ä»¥ç»§ç»­å¼€å‘
- ç­‰å¾…æ›´å¤šåŠŸèƒ½å®žçŽ°åŽå†é‡æ–°å®¡è§† MMU é—®é¢˜

**å½“å‰çŠ¶æ€**ï¼š
- MMU å·²åœ¨ `mm.rs::init()` ä¸­æ˜Žç¡®ç¦ç”¨
- å†…æ ¸å¯æ­£å¸¸å¯åŠ¨ã€å¤„ç†ä¸­æ–­ã€æ‰§è¡Œç³»ç»Ÿè°ƒç”¨
- æ‰€æœ‰éžå†…å­˜æ˜ å°„ç›¸å…³çš„åŠŸèƒ½å¯ä»¥æ­£å¸¸å·¥ä½œ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šå»¶åŽè‡³ Phase 4 æˆ– Phase 5

---

#### 2.2 è¿›ç¨‹è°ƒåº¦å™¨
- [ ] **è°ƒåº¦å™¨æ¡†æž¶** (`process/scheduler.rs`)
  - [ ] è°ƒåº¦å™¨æŽ¥å£å®šä¹‰
  - [ ] å°±ç»ªé˜Ÿåˆ—ç®¡ç†
  - [ ] è°ƒåº¦ç®—æ³•ï¼ˆRound Robinã€CFSï¼‰
- [ ] **è¿›ç¨‹æŽ§åˆ¶å—** (`process/pcb.rs`)
  - [ ] PCB ç»“æž„å®šä¹‰
  - [ ] è¿›ç¨‹çŠ¶æ€ç®¡ç†
  - [ ] è¿›ç¨‹åˆ›å»º/é”€æ¯
- [ ] **ä¸Šä¸‹æ–‡åˆ‡æ¢** (`arch/aarch64/context.S`)
  - [ ] ä¿å­˜é€šç”¨å¯„å­˜å™¨
  - [ ] ä¿å­˜ç‰¹æ®Šå¯„å­˜å™¨ï¼ˆSPã€ELRã€SPSRï¼‰
  - [ ] åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹
- [ ] **è°ƒåº¦ç­–ç•¥** (`process/sched_rr.rs`, `process/sched_cfs.rs`)
  - [ ] Round Robin è°ƒåº¦
  - [ ] å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ˆCFSï¼‰
  - [ ] å®žæ—¶è°ƒåº¦ç­–ç•¥

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š3-5 å¤©

**ä¾èµ–å…³ç³»**ï¼šç³»ç»Ÿè°ƒç”¨ä¾èµ–äºŽè¿›ç¨‹ç®¡ç†

---

#### 2.3 è¿›ç¨‹åœ°å€ç©ºé—´
- [ ] **åœ°å€ç©ºé—´ç®¡ç†** (`mm/vma.rs`)
  - [ ] VMAï¼ˆè™šæ‹Ÿå†…å­˜åŒºåŸŸï¼‰ç»“æž„
  - [ ] åœ°å€ç©ºé—´å¸ƒå±€
  - [ ] mmap/munmap æ”¯æŒ
- [ ] **é¡µè¡¨ç®¡ç†** (`mm/page_table.rs`)
  - [ ] é¡µè¡¨åˆ›å»º/é”€æ¯
  - [ ] é¡µè¡¨æ˜ å°„/å–æ¶ˆæ˜ å°„
  - [ ] é¡µè¡¨å…±äº«ï¼ˆå†™æ—¶å¤åˆ¶ï¼‰
- [ ] **å†…å­˜æ˜ å°„** (`mm/mmap.rs`)
  - [ ] åŒ¿åæ˜ å°„
  - [ ] æ–‡ä»¶æ˜ å°„
  - [ ] å…±äº«æ˜ å°„
- [ ] **ç¼ºé¡µå¼‚å¸¸å¤„ç†** (`mm/fault.rs`)
  - [ ] ç¼ºé¡µå¼‚å¸¸å¤„ç†
  - [ ] å»¶è¿Ÿåˆ†é…
  - [ ] å†™æ—¶å¤åˆ¶

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š3-4 å¤©

---

## Phase 3: ç³»ç»Ÿè°ƒç”¨ä¸Žéš”ç¦» ðŸ”„ **è¿›è¡Œä¸­ (2025-02-03)**

### 3.1 ç³»ç»Ÿè°ƒç”¨æŽ¥å£ âœ… **éƒ¨åˆ†å®Œæˆ**

- [x] **ç³»ç»Ÿè°ƒç”¨æ¡†æž¶** (`arch/aarch64/syscall.rs`)
  - [x] ç³»ç»Ÿè°ƒç”¨è¡¨
  - [x] å‚æ•°è§£æž
  - [x] è¿”å›žå€¼å¤„ç†

- [x] **ç³»ç»Ÿè°ƒç”¨å®žçŽ°** - 25+ ç³»ç»Ÿè°ƒç”¨å·²å®žçŽ°
  - [x] è¿›ç¨‹ç›¸å…³ï¼š`fork` (57)ã€`vfork` (58)ã€`execve` (59)ã€`exit` (60)ã€`wait4` (61)ã€`getpid` (39)ã€`getppid` (110)
  - [x] æ–‡ä»¶ç›¸å…³ï¼š`read` (0)ã€`write` (1)ã€`openat` (2/245)ã€`close` (3)ã€`lseek` (8)ã€`pipe` (22)ã€`dup` (32)ã€`dup2` (33)
  - [x] å†…å­˜ç›¸å…³ï¼š`brk` (12)ã€`mmap` (9)ã€`munmap` (11)
  - [x] å…¶ä»–ï¼š`ioctl` (16)ã€`uname` (63)ã€`getuid` (102)ã€`getgid` (104)ã€`geteuid` (107)ã€`getegid` (108)

- [x] **ç”¨æˆ·/å†…æ ¸éš”ç¦»**
  - [x] åœ°å€éªŒè¯ï¼š`verify_user_ptr()`ã€`verify_user_ptr_array()`
  - [x] å‚æ•°å¤åˆ¶ï¼š`copy_user_string()`ã€`copy_from_user()`
  - [x] ç»“æžœå¤åˆ¶ï¼š`copy_to_user()`
  - [x] ç”¨æˆ·ç©ºé—´åœ°å€èŒƒå›´å®šä¹‰ï¼ˆUSER_SPACE_ENDï¼‰

**å®Œæˆæ—¶é—´**ï¼š2025-02-03

**å¾…å®žçŽ°**ï¼š
- â³ `gettimeofday` - èŽ·å–æ—¶é—´
- â³ `mprotect` - ä¿®æ”¹å†…å­˜ä¿æŠ¤
- â³ `mincore` - æŸ¥è¯¢é¡µé¢çŠ¶æ€
- â³ `madvise` - å†…å­˜å»ºè®®
- â³ `readv`/`writev` - å‘é‡ I/O
- â³ `select`/`poll` - I/O å¤šè·¯å¤ç”¨

---

### 3.2 ä¿¡å·å¤„ç† âœ… **éƒ¨åˆ†å®Œæˆ (2025-02-03)**

- [x] **ä¿¡å·æ¡†æž¶** (`signal/signal.rs`)
  - [x] ä¿¡å·å®šä¹‰ï¼ˆLinux å…¼å®¹ï¼ŒSignal æžšä¸¾ï¼‰
  - [x] ä¿¡å·æŽ©ç ï¼ˆSignalStruct.maskï¼‰
  - [x] ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆSigActionï¼‰
  - [x] å¾…å¤„ç†ä¿¡å·é˜Ÿåˆ—ï¼ˆSigPendingï¼‰

- [x] **ä¿¡å·å‘é€**
  - [x] `kill` ç³»ç»Ÿè°ƒç”¨ (62)
  - [x] `sigaction` ç³»ç»Ÿè°ƒç”¨ (48)
  - [x] ä¿¡å·é˜Ÿåˆ—ï¼ˆSigPendingï¼‰
  - [x] ä¿¡å·ä¼ é€’æœºåˆ¶ï¼ˆSigPending::add()ï¼‰

- [x] **ä¿¡å·å¤„ç†**
  - [x] `rt_sigreturn` ç³»ç»Ÿè°ƒç”¨ (15)
  - [ ] ä¿¡å·äº¤ä»˜ï¼ˆdo_signalï¼‰
  - [ ] ä¿¡å·å¤„ç†å‡½æ•°è°ƒç”¨
  - [ ] å®Œæ•´çš„ sigreturn å®žçŽ°ï¼ˆä¸Šä¸‹æ–‡æ¢å¤ï¼‰

**å®Œæˆæ—¶é—´**ï¼š2025-02-03ï¼ˆéƒ¨åˆ†ï¼‰

**å¾…å®žçŽ°**ï¼š
- â³ `sigprocmask` - ä¿¡å·æŽ©ç æ“ä½œ (14)
- â³ `rt_sigprocmask` - å®žæ—¶ä¿¡å·æŽ©ç  (14)
- â³ ä¿¡å·äº¤ä»˜æœºåˆ¶ï¼ˆåœ¨å¼‚å¸¸å¤„ç†ä¸­æ£€æŸ¥å¹¶è°ƒç”¨ï¼‰
- â³ ä¿¡å·ä¸Šä¸‹æ–‡ä¿å­˜/æ¢å¤
- â³ ä¿¡å·æ ˆï¼ˆsigaltstackï¼‰

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š1-2 å¤©

---

## Phase 4: æ–‡ä»¶ç³»ç»Ÿ ðŸ”„ **è¿›è¡Œä¸­ (2025-02-03)**

### 4.1 VFS è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ
- [x] **VFS æ¡†æž¶** (`fs/vfs.rs`)
  - [x] VFS åˆå§‹åŒ– (ä½¿ç”¨ SimpleArc)
  - [x] æ–‡ä»¶ç³»ç»ŸæŽ¥å£æ¡†æž¶
  - [x] åŸºç¡€æ–‡ä»¶æ“ä½œ (file_open, file_close, file_read, file_write)
  - [x] æ–‡ä»¶æŽ§åˆ¶æŽ¥å£ (file_fcntl)
  - [x] I/O å¤šè·¯å¤ç”¨æŽ¥å£ (io_poll)
- [x] **æ–‡ä»¶æè¿°ç¬¦ç®¡ç†** (`fs/file.rs`)
  - [x] FdTable å®žçŽ°
  - [x] fd åˆ†é…/é‡Šæ”¾ (alloc_fd, close_fd)
  - [x] fd å¤åˆ¶ (dup_fd)
  - [x] æ–‡ä»¶å¯¹è±¡ (File) å’Œæ–‡ä»¶æ“ä½œ (FileOps)
- [x] **è·¯å¾„è§£æž** (`fs/path.rs`)
  - [x] è·¯å¾„åè§£æž (filename_parentname, path_lookup)
  - [x] ç»å¯¹è·¯å¾„/ç›¸å¯¹è·¯å¾„åˆ¤æ–­
  - [x] è·¯å¾„ç»„ä»¶è¿­ä»£å™¨ (PathComponents)
  - [x] çˆ¶ç›®å½•å’Œæ–‡ä»¶åèŽ·å– (parent, file_name)
  - [ ] ç¬¦å·é“¾æŽ¥è§£æž (TODO: follow_link)
- [x] **VFS æ ¸å¿ƒå¯¹è±¡**
  - [x] File ç»“æž„å’Œ FileOps (fs/file.rs)
  - [x] Inode ç»“æž„å’Œ INodeOps (fs/inode.rs) - å·²å®žçŽ°ï¼Œä½¿ç”¨ alloc::sync::Arc
  - [x] Dentry ç»“æž„ (fs/dentry.rs) - å·²å®žçŽ°ï¼Œä½¿ç”¨ alloc::sync::Arc
  - [ ] éœ€è¦å°† Inode/Dentry æ›´æ–°ä¸ºä½¿ç”¨ SimpleArc
- [x] **æ–‡ä»¶ç³»ç»Ÿæ³¨å†Œæœºåˆ¶** (`fs/superblock.rs`)
  - [x] FileSystemType æ–‡ä»¶ç³»ç»Ÿç±»åž‹
  - [x] FsRegistry æ–‡ä»¶ç³»ç»Ÿæ³¨å†Œè¡¨
  - [x] SuperBlock è¶…çº§å—ç»“æž„
  - [x] FsContext æŒ‚è½½ä¸Šä¸‹æ–‡
  - [x] register_filesystem/unregister_filesystem
  - [x] get_fs_type æŸ¥æ‰¾æ–‡ä»¶ç³»ç»Ÿç±»åž‹
  - [x] do_mount/do_umount æŒ‚è½½å¸è½½æ“ä½œ
- [x] **æŒ‚è½½ç‚¹ç®¡ç†** (`fs/mount.rs`)
  - [x] VfsMount æŒ‚è½½ç‚¹ç»“æž„
  - [x] MntNamespace æŒ‚è½½å‘½åç©ºé—´
  - [x] MntFlags/MsFlags æŒ‚è½½æ ‡å¿—
  - [x] add_mount/remove_mount æŒ‚è½½ç‚¹æ“ä½œ
  - [x] find_mount/list_mounts æŒ‚è½½ç‚¹æŸ¥è¯¢
  - [x] MountTreeIter æŒ‚è½½ç‚¹éåŽ†
  - [x] get_init_namespace åˆå§‹å‘½åç©ºé—´
- [x] **RootFS å†…å­˜æ–‡ä»¶ç³»ç»Ÿ** (`fs/rootfs.rs`) ðŸ†•
  - [x] RootFSNode æ–‡ä»¶èŠ‚ç‚¹ï¼ˆç›®å½•/å¸¸è§„æ–‡ä»¶ï¼‰
  - [x] RootFSSuperBlock RootFS è¶…çº§å—
  - [x] create_file åˆ›å»ºæ–‡ä»¶
  - [x] lookup æŸ¥æ‰¾æ–‡ä»¶
  - [x] list_dir åˆ—å‡ºç›®å½•
  - [x] read_data/write_data æ–‡ä»¶è¯»å†™
  - [x] ROOTFS_FS_TYPE æ–‡ä»¶ç³»ç»Ÿç±»åž‹
  - [x] init_rootfs RootFS åˆå§‹åŒ–
  - [x] æ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°å‘½åç©ºé—´
  - [x] VfsMount æ·»åŠ è¶…çº§å—æŒ‡é’ˆ (mnt_sb)

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š5-7 å¤©

**å½“å‰çŠ¶æ€**ï¼šVFS æ ¸å¿ƒæ¡†æž¶å·²å®Œæ•´å®žçŽ°ï¼ŒåŒ…æ‹¬æ–‡ä»¶æè¿°ç¬¦ç®¡ç†ã€è·¯å¾„è§£æžã€æ–‡ä»¶ç³»ç»Ÿæ³¨å†Œã€è¶…çº§å—ç®¡ç†ã€æŒ‚è½½ç‚¹ç®¡ç†å’Œ RootFS å†…å­˜æ–‡ä»¶ç³»ç»Ÿã€‚ä¸‹ä¸€æ­¥æ˜¯å®Œæˆæ ¹æ–‡ä»¶ç³»ç»ŸæŒ‚è½½å’Œé›†æˆã€‚

---

### 4.2 ext4 æ–‡ä»¶ç³»ç»Ÿ
- [ ] **ext4 å®žçŽ°** (`fs/ext4/`)
  - [ ] è¶…çº§å—è¯»å–
  - [ ] inode å’Œå—ä½å›¾
  - [ ] ç›®å½•è§£æž
  - [ ] æ–‡ä»¶è¯»å–/å†™å…¥
  - [ ] æ—¥å¿—ï¼ˆjournalingï¼‰
- [ ] **ç¼“å­˜ç®¡ç†** (`fs/cache.rs`)
  - [ ] inode ç¼“å­˜
  - [ ] å—ç¼“å­˜
  - [ ] ç›®å½•é¡¹ç¼“å­˜

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 4.3 btrfs æ–‡ä»¶ç³»ç»Ÿ
- [ ] **btrfs å®žçŽ°** (`fs/btrfs/`)
  - [ ] B-tree ç»“æž„
  - [ ] å¿«ç…§
  - [ ] å†™æ—¶å¤åˆ¶
  - [ ] åŽ‹ç¼©

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š10-14 å¤©ï¼ˆå¯é€‰ï¼‰

---

## Phase 5: SMP æ”¯æŒ âœ… **å·²å®Œæˆ (2025-02-04)**

### 5.1 åŒæ ¸å¯åŠ¨ âœ… **å·²å®Œæˆ**
- [x] **æ¬¡æ ¸å¯åŠ¨å…¥å£ç‚¹** (`arch/aarch64/boot.S`)
  - [x] æ¬¡æ ¸å…¥å£ç‚¹ (secondary_entry)
  - [x] MPIDR è¯»å–å’Œ CPU ID åˆ¤æ–­
  - [x] Per-CPU æ ˆé€‰æ‹©
  - [x] è·³è½¬åˆ° Rust æ¬¡æ ¸å…¥å£
- [x] **SMP æ•°æ®ç»“æž„** (`arch/aarch64/smp.rs`)
  - [x] SmpData å…¨å±€æ•°æ®
  - [x] CpuBootInfo per-CPU ä¿¡æ¯
  - [x] CPU çŠ¶æ€ç®¡ç† (Unknown/Booting/Running)
  - [x] æ´»åŠ¨ CPU è®¡æ•° (get_active_cpu_count)
- [x] **Per-CPU æ ˆç®¡ç†**
  - [x] é“¾æŽ¥å™¨è„šæœ¬åˆ†é…æ ˆç©ºé—´
  - [x] æ¯ä¸ª CPU 16KB æ ˆ
  - [x] æ”¯æŒ 4 ä¸ª CPU
- [x] **PSCI CPU å”¤é†’** (`arch/aarch64/smp.rs`)
  - [x] PSCI_CPU_ON SMC/HVC è°ƒç”¨
  - [x] æ¬¡æ ¸å¯åŠ¨åœ°å€ä¼ é€’
  - [x] CPU 1 æˆåŠŸå¯åŠ¨

**æµ‹è¯•éªŒè¯**ï¼š
```
[SMP: Calling PSCI for CPU 1]
[SMP: PSCI result = 0000000000000000]
[CPU1 up]
SMP: 2 CPUs online
```

### 5.2 GICv3 ä¸­æ–­æŽ§åˆ¶å™¨ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **GICv3 æœ€å°åˆå§‹åŒ–** (`drivers/intc/gicv3.rs`)
  - [x] è·³è¿‡ GICD å†…å­˜è®¿é—®ï¼ˆä¼šå¯¼è‡´æŒ‚èµ·ï¼‰
  - [x] ä½¿ç”¨ç³»ç»Ÿå¯„å­˜å™¨è®¿é—®
  - [x] ICC_IAR1_EL1 - ä¸­æ–­ç¡®è®¤
  - [x] ICC_EOIR1_EL1 - ä¸­æ–­ç»“æŸ
  - [x] ICC_SGI1R_EL1 - SGI å‘é€
- [x] **ä¸­æ–­å¤„ç†** (`arch/aarch64/trap.rs`)
  - [x] IRQ å¤„ç†æ¡†æž¶
  - [x] SGI å¤„ç†ï¼ˆIPIï¼‰
  - [x] Spurious interrupt å¤„ç† (ID 1023)
- [x] **ä¸­æ–­å±è”½/æ¢å¤**
  - [x] mask_irq() - ä¿å­˜å¹¶å±è”½ IRQ
  - [x] restore_irq() - æ¢å¤ IRQ çŠ¶æ€
  - [x] DAIF å¯„å­˜å™¨æ“ä½œ

**æµ‹è¯•éªŒè¯**ï¼š
```
GIC: Minimal init complete
SMP: 2 CPUs online
IRQ enabled
```

### 5.3 IPI (æ ¸é—´ä¸­æ–­) âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **IPI æ¡†æž¶** (`arch/aarch64/ipi.rs`)
  - [x] IpiType æžšä¸¾ (Reschedule/Stop)
  - [x] send_ipi() - å‘é€ IPI
  - [x] handle_ipi() - å¤„ç† IPI
  - [x] smp_send_reschedule() - å‘é€è°ƒåº¦ IPI
- [x] **IPI æµ‹è¯•**
  - [x] CPU 0 â†’ CPU 1 IPI å‘é€æµ‹è¯•
  - [x] IPI æŽ¥æ”¶éªŒè¯

**æµ‹è¯•éªŒè¯**ï¼š
```
[IPI: Sending IPI 1 to CPU 1]
[IPI: CPU 1 received IPI 1]
[IPI: Reschedule]
```

### 5.4 MMU å¤šçº§é¡µè¡¨ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **3 çº§é¡µè¡¨ç»“æž„** (`arch/aarch64/mm.rs`)
  - [x] é¡µè¡¨åˆ›å»ºå’Œåˆå§‹åŒ–
  - [x] é¡µè¡¨é¡¹æ ¼å¼ (4KB é¡µé¢)
  - [x] æ’ç­‰æ˜ å°„ (0x4000_0000 - 0x7FFF_FFFF)
  - [x] ç”¨æˆ·ç©ºé—´æ˜ å°„ (0x0000_0000 - 0x3FFF_FFFF)
- [x] **MMU å¯ç”¨**
  - [x] TCR_EL1 é…ç½®
  - [x] MAIR_EL1 é…ç½®
  - [x] TTBR0_EL1 è®¾ç½®
  - [x] TLB åˆ·æ–°
  - [x] MMU æˆåŠŸå¯ç”¨

**æŠ€æœ¯è¦ç‚¹**ï¼š
- T0SZ = 16 (48 ä½ VA)
- 3 çº§é¡µè¡¨ (4KB é¡µç²’åº¦)
- Normal memory (AttrIdx 0)
- Device memory (AttrIdx 1)

### 5.5 ä¸­æ–­é£Žæš´ä¿®å¤ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] **IRQ æ—¶åºæŽ§åˆ¶**
  - [x] å¯åŠ¨æ—¶ç¦ç”¨ IRQ (boot.rs)
  - [x] GIC åˆå§‹åŒ–ï¼ˆIRQ ä»ç„¶ç¦ç”¨ï¼‰
  - [x] SMP å¯åŠ¨ï¼ˆIRQ ä»ç„¶ç¦ç”¨ï¼‰
  - [x] SMP å®ŒæˆåŽå¯ç”¨ IRQ
- [x] **ä¸­æ–­å¤„ç†ä¼˜åŒ–**
  - [x] handle_irq() ä¸­ä½¿ç”¨ä¸­æ–­å±è”½
  - [x] é˜²æ­¢é€’å½’ä¸­æ–­è°ƒç”¨

---

## Phase 6: ä»£ç å®¡æŸ¥ âœ… **å·²å®Œæˆ (2025-02-04)**

### 6.1 å…¨é¢ä»£ç å®¡æŸ¥ âœ… **å·²å®Œæˆ**
- [x] **ä»£ç å®¡æŸ¥** - æ•´ä¸ªé¡¹ç›®å®¡æŸ¥
  - [x] å‘çŽ°å¹¶è®°å½• 15 ä¸ªé—®é¢˜
  - [x] æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»ï¼ˆä¸¥é‡/ä¸­ç­‰/ä½Žï¼‰
  - [x] ä¸Ž Linux å†…æ ¸å¯¹æ¯”
  - [x] ä¿®å¤æ–¹æ¡ˆè®¾è®¡
- [x] **æ–‡æ¡£æ›´æ–°**
  - [x] CODE_REVIEW.md åˆ›å»º
  - [x] é—®é¢˜è¯¦ç»†è®°å½•
  - [x] ä¿®å¤ä¼˜å…ˆçº§æŽ’åº
  - [x] BOOT_SEQUENCE.md åˆ›å»º - å¯åŠ¨é¡ºåºåˆ†æžä¸Žä¼˜åŒ–æ–‡æ¡£
  - [x] Linux ARM64 å¯åŠ¨é¡ºåºå‚è€ƒ
  - [x] å…³é”®åŽŸåˆ™æ–‡æ¡£ï¼ˆMMU â†’ GIC â†’ SMPï¼‰
  - [x] æ¬¡æ ¸åˆå§‹åŒ–è¯¦ç»†æ­¥éª¤

### 6.2 è°ƒè¯•è¾“å‡ºæ¸…ç† âœ… **å·²å®Œæˆ**
- [x] **æ¸…ç† 50+ å¤„è°ƒè¯•è¾“å‡º**
  - [x] boot.rs - 2 å¤„
  - [x] gicv3.rs - 17 å¤„
  - [x] ipi.rs - 8 å¤„
  - [x] allocator.rs - 1 å¤„
  - [x] main.rs - 20+ å¤„
- [x] **æ¡ä»¶ç¼–è¯‘ä¼˜åŒ–**
  - [x] ä½¿ç”¨ #[cfg(debug_assertions)]
  - [x] åŒºåˆ†è°ƒè¯•å’Œç”Ÿäº§è¾“å‡º
  - [x] ä½¿ç”¨ println!/debug_println! å®

### 6.3 æµ‹è¯•è„šæœ¬å®Œå–„ âœ… **å·²å®Œæˆ**
- [x] **test_suite.sh** - å®Œæ•´æµ‹è¯•å¥—ä»¶
  - [x] é…ç½®æ–‡ä»¶æµ‹è¯•
  - [x] ç¼–è¯‘æµ‹è¯•
  - [x] SMP æµ‹è¯•
  - [x] MMU æµ‹è¯•
  - [x] å†…å­˜é…ç½®æµ‹è¯•
- [x] **test_smp.sh** - SMP åŠŸèƒ½æµ‹è¯•
  - [x] åŒæ ¸å¯åŠ¨éªŒè¯
  - [x] MMU/GIC åˆå§‹åŒ–éªŒè¯
  - [x] ç³»ç»Ÿç¨³å®šæ€§éªŒè¯
- [x] **test_ipi.sh** - IPI åŠŸèƒ½æµ‹è¯•
  - [x] åŒæ ¸å¯åŠ¨æµ‹è¯•
  - [x] GIC åˆå§‹åŒ–æµ‹è¯•
  - [x] IRQ æŽ§åˆ¶æµ‹è¯•
  - [x] ç³»ç»Ÿç¨³å®šæ€§æµ‹è¯•
- [x] **test_qemu.sh** - QEMU é…ç½®æµ‹è¯•
  - [x] å•æ ¸æµ‹è¯•
  - [x] åŒæ ¸æµ‹è¯•
  - [x] å››æ ¸æµ‹è¯•
  - [x] å†…å­˜é…ç½®æµ‹è¯•

### 6.4 Makefile å¢žå¼º âœ… **å·²å®Œæˆ**
- [x] **å¿«æ·å‘½ä»¤**
  - [x] `make smp` - è¿è¡Œ SMP æµ‹è¯•
  - [x] `make ipi` - è¿è¡Œ IPI æµ‹è¯•
  - [x] `make test` - è¿è¡Œæµ‹è¯•å¥—ä»¶
  - [x] `make run` - å¿«é€Ÿè¿è¡Œå†…æ ¸

---

## Phase 7: å†…å­˜ç®¡ç†ä¼˜åŒ– âœ… **å·²å®Œæˆ (2025-02-04)**

### 7.1 Buddy System å†…å­˜åˆ†é…å™¨ âœ… **å·²å®Œæˆ**
- [x] **Buddy System å®žçŽ°** ([kernel/src/mm/buddy_allocator.rs](kernel/src/mm/buddy_allocator.rs))
  - [x] BlockHeader æ•°æ®ç»“æž„ï¼ˆorder, free, prev, nextï¼‰
  - [x] BuddyAllocator ç»“æž„ä½“ï¼ˆ21 ä¸ªç©ºé—²é“¾è¡¨ï¼‰
  - [x] alloc_blocks() - O(log n) åˆ†é…ï¼Œæ”¯æŒå—åˆ†å‰²
  - [x] free_blocks() - é‡Šæ”¾ç®—æ³•ï¼Œæ”¯æŒä¼™ä¼´åˆå¹¶
  - [x] get_buddy() - ä¼™ä¼´åœ°å€è®¡ç®—
  - [x] GlobalAlloc trait å®žçŽ°
- [x] **å†…å­˜å¸ƒå±€è°ƒæ•´**
  - [x] å †åœ°å€ï¼š0x6000_0000ï¼ˆä»Ž 0x8800_0000 è¿ç§»ï¼‰
  - [x] MMU é¡µè¡¨æ˜ å°„ï¼ˆL2 entries 3-10ï¼Œ16MBï¼‰
- [x] **çº¿ç¨‹å®‰å…¨**
  - [x] åŽŸå­æ“ä½œï¼ˆAtomicUsize, CASï¼‰
  - [x] æ— é”å¹¶å‘è®¿é—®

**æŠ€æœ¯ç‰¹æ€§**ï¼š
- æœ€å°åˆ†é…ï¼š4KB (order 0)
- æœ€å¤§åˆ†é…ï¼š4GB (order 20)
- å †å¤§å°ï¼š16MB
- ç®—æ³•å¤æ‚åº¦ï¼šO(log n)

**æµ‹è¯•éªŒè¯**ï¼š
```
âœ“ Direct alloc works!
âœ“ SimpleVec::push works!
âœ“ SimpleBox works!
âœ“ SimpleString works!
âœ“ SimpleArc works!
âœ“ Fork success: child PID = 2
```

---

## Phase 8: Per-CPU ä¼˜åŒ– âœ… **å·²å®Œæˆ (2025-02-04)**

### 8.1 Per-CPU è¿è¡Œé˜Ÿåˆ— âœ… **å·²å®Œæˆ**
- [x] **è°ƒåº¦å™¨é‡æž„** ([kernel/src/process/sched.rs](kernel/src/process/sched.rs))
  - [x] å…¨å±€ RQ æ”¹ä¸º per-CPU æ•°ç»„ï¼ˆPER_CPU_RQ[4]ï¼‰
  - [x] this_cpu_rq() å‡½æ•° - èŽ·å–å½“å‰ CPU çš„è¿è¡Œé˜Ÿåˆ—
  - [x] cpu_rq(cpu_id) å‡½æ•° - èŽ·å–æŒ‡å®š CPU çš„è¿è¡Œé˜Ÿåˆ—
  - [x] init_per_cpu_rq(cpu_id) å‡½æ•° - åˆå§‹åŒ– per-CPU é˜Ÿåˆ—
  - [x] Per-CPU ä»»åŠ¡é˜Ÿåˆ—
  - [x] æ¬¡æ ¸è°ƒåº¦å™¨åˆå§‹åŒ–ï¼ˆåœ¨ secondary_cpu_start ä¸­è°ƒç”¨ï¼‰
  - [x] schedule() ä½¿ç”¨ this_cpu_rq()
- [ ] **è´Ÿè½½å‡è¡¡** (Phase 9)
  - [ ] è´Ÿè½½æ£€æµ‹æœºåˆ¶
  - [ ] ä»»åŠ¡è¿ç§»ï¼ˆsteal taskï¼‰
  - [ ] ç®€å•è´Ÿè½½å‡è¡¡ç®—æ³•

**å®žæ–½æ­¥éª¤**ï¼š
1. âœ… ä¿®æ”¹ RunQueue æ•°æ®ç»“æž„ - å®Œæˆ
2. âœ… å®žçŽ° this_cpu_rq() è®¿é—®å‡½æ•° - å®Œæˆ
3. âœ… åœ¨ SMP åˆå§‹åŒ–æ—¶è°ƒç”¨ init_per_cpu_rq() - å®Œæˆ
4. âœ… æ›´æ–° schedule() å‡½æ•°ä½¿ç”¨ this_cpu_rq() - å®Œæˆ
5. â³ å®žçŽ°åŸºç¡€è´Ÿè½½å‡è¡¡ï¼ˆå¾… Phase 9ï¼‰

**å®Œæˆæ—¶é—´**ï¼š2025-02-04
**éš¾åº¦**ï¼šâ­â­â­â­ (é«˜)
**ä¼˜å…ˆçº§**ï¼šðŸ”´ ä¸¥é‡ï¼ˆSMP æ€§èƒ½ç“¶é¢ˆï¼‰

**éªŒè¯çŠ¶æ€**ï¼š
```
sched: Initializing CPU 0 runqueue
sched: CPU 0 runqueue [OK]
[CPU1 up]
[CPU1] init: runqueue
sched: Initializing CPU 1 runqueue
sched: CPU 1 runqueue [OK]
[CPU1] init: IRQ enabled
[CPU1] idle: waiting for work
SMP: 2 CPUs online
```

### 8.2 å¿«é€Ÿèƒœåˆ© âœ… **å·²å®Œæˆ (2025-02-04)**

#### Quick Win 1: SimpleArc Clone æ”¯æŒ âœ… **å·²å®Œæˆ**
**é—®é¢˜**ï¼šå¯¼è‡´å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿæ“ä½œè¿”å›ž `None`
**ä½ç½®**ï¼š[kernel/src/collection.rs:390](kernel/src/collection.rs:390)
**å®žæ–½**ï¼šClone trait å·²åœ¨ collection.rs å®žçŽ°
**ä¿®å¤**ï¼š
- RootFSNode::find_child() - ç§»é™¤ TODOï¼Œä½¿ç”¨ child.clone()
- RootFSNode::list_children() - å®žçŽ°æ­£ç¡®çš„å­èŠ‚ç‚¹å…‹éš†
**éªŒè¯**ï¼šâœ… ç¼–è¯‘é€šè¿‡

#### Quick Win 2: RootFS write_data offset bug âœ… **å·²å®Œæˆ**
**é—®é¢˜**ï¼šæ–‡ä»¶å†™å…¥å¿½ç•¥ offset å‚æ•°
**ä½ç½®**ï¼š[kernel/src/fs/rootfs.rs:185](kernel/src/fs/rootfs.rs:185)
**ä¿®å¤**ï¼š
```rust
pub fn write_data(&mut self, offset: usize, data: &[u8]) -> usize {
    if let Some(ref mut existing_data) = self.data {
        let required_size = offset + data.len();
        if existing_data.len() < required_size {
            existing_data.resize(required_size, 0);
        }
        existing_data[offset..offset + data.len()].copy_from_slice(data);
        data.len()
    } else {
        0
    }
}
```
**éªŒè¯**ï¼šâœ… ç¼–è¯‘é€šè¿‡

**å®Œæˆæ—¶é—´**ï¼š2025-02-04
**éš¾åº¦**ï¼šâ­â­ (ä½Ž)
**ä¼˜å…ˆçº§**ï¼šðŸŸ¡ é«˜ï¼ˆå½±å“æ­£ç¡®æ€§ï¼‰

---

## Phase 9: ç½‘ç»œä¸Žé«˜çº§åŠŸèƒ½ â³

---

## Phase 8: ç½‘ç»œä¸Žé«˜çº§åŠŸèƒ½

### 5.1 ç½‘ç»œåè®®æ ˆ
- [ ] **ç½‘ç»œæ¡†æž¶** (`net/net.rs`)
  - [ ] socket æŽ¥å£
  - [ ] åè®®æ—ç®¡ç†
  - [ ] ç½‘ç»œè®¾å¤‡æŠ½è±¡
- [ ] **ä»¥å¤ªç½‘é©±åŠ¨** (`drivers/net/virtio-net.rs`)
  - [ ] virtio-net é©±åŠ¨
  - [ ] æ•°æ®åŒ…å‘é€/æŽ¥æ”¶
  - [ ] ä¸­æ–­å¤„ç†
- [ ] **IP åè®®** (`net/ip.rs`)
  - [ ] IPv4
  - [ ] è·¯ç”±
  - [ ] åˆ†ç‰‡é‡ç»„
- [ ] **TCP/UDP** (`net/tcp.rs`, `net/udp.rs`)
  - [ ] è¿žæŽ¥ç®¡ç†
  - [ ] æ»‘åŠ¨çª—å£
  - [ ] æ‹¥å¡žæŽ§åˆ¶

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š14-21 å¤©

---

### 5.2 IPC æœºåˆ¶
- [ ] **ç®¡é“** (`ipc/pipe.rs`)
  - [ ] åŒ¿åç®¡é“
  - [ ] å‘½åç®¡é“ï¼ˆFIFOï¼‰
- [ ] **æ¶ˆæ¯é˜Ÿåˆ—** (`ipc/msg.rs`)
  - [ ] System V æ¶ˆæ¯é˜Ÿåˆ—
  - [ ] POSIX æ¶ˆæ¯é˜Ÿåˆ—
- [ ] **å…±äº«å†…å­˜** (`ipc/shm.rs`)
  - [ ] System V å…±äº«å†…å­˜
  - [ ] POSIX å…±äº«å†…å­˜
- [ ] **ä¿¡å·é‡** (`ipc/sem.rs`)
  - [ ] System V ä¿¡å·é‡
  - [ ] POSIX ä¿¡å·é‡

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 5.3 åŒæ­¥åŽŸè¯­
- [ ] **é”æœºåˆ¶** (`sync/lock.rs`)
  - [ ] Mutexï¼ˆè‡ªæ—‹é”ï¼‰
  - [ ] RwLockï¼ˆè¯»å†™é”ï¼‰
  - [ ] SeqLockï¼ˆåºåˆ—é”ï¼‰
  - [ ] RCUï¼ˆè¯»-æ‹·è´-æ›´æ–°ï¼‰
- [ ] **å¹¶å‘åŽŸè¯­** (`sync/atomic.rs`)
  - [ ] Atomic ç±»åž‹
  - [ ] å†…å­˜å±éšœ
  - [ ] åŽŸå­æ“ä½œ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š3-5 å¤©

---

## Phase 6: å¤šå¹³å°æ”¯æŒ

### 6.1 x86_64 å¹³å°
- [ ] **x86_64 å¯åŠ¨ä»£ç **
  - [ ] æ±‡ç¼–å¯åŠ¨ä»£ç 
  - [ ] é•¿æ¨¡å¼è®¾ç½®
- [ ] **x86_64 å†…å­˜ç®¡ç†**
  - [ ] é¡µè¡¨è®¾ç½®ï¼ˆ4çº§é¡µè¡¨ï¼‰
  - [ ] MMU é…ç½®
- [ ] **x86_64 ä¸­æ–­å¤„ç†**
  - [ ] IDT è®¾ç½®
  - [ ] ä¸­æ–­å¤„ç†
- [ ] **x86_64 é©±åŠ¨**
  - [ ] UARTï¼ˆ8250/16550ï¼‰
  - [ ] APIC
  - [ ] HPET å®šæ—¶å™¨

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š10-14 å¤©

---

### 6.2 riscv64 å¹³å°
- [ ] **riscv64 å¯åŠ¨ä»£ç **
- [ ] **riscv64 å†…å­˜ç®¡ç†**
- [ ] **riscv64 ä¸­æ–­å¤„ç†**
- [ ] **riscv64 é©±åŠ¨**

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

## Phase 7: è®¾å¤‡é©±åŠ¨

### 7.1 PCIe æ”¯æŒ
- [ ] **PCIe æžšä¸¾** (`drivers/pci/`)
  - [ ] PCI æ€»çº¿æžšä¸¾
  - [ ] è®¾å¤‡é…ç½®
  - [ ] èµ„æºåˆ†é…
- [ ] **PCIe é©±åŠ¨æ¡†æž¶**
  - [ ] é©±åŠ¨æ³¨å†Œ
  - [ ] è®¾å¤‡åŒ¹é…
  - [ ] èµ„æºæ˜ å°„

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 7.2 å­˜å‚¨æŽ§åˆ¶å™¨
- [ ] **AHCI é©±åŠ¨** (`drivers/ahci.rs`)
  - [ ] SATA æŽ§åˆ¶å™¨
  - [ ] å‘½ä»¤é˜Ÿåˆ—
  - [ ] DMA æ”¯æŒ
- [ ] **NVMe é©±åŠ¨** (`drivers/nvme.rs`)
  - [ ] NVMe æŽ§åˆ¶å™¨
  - [ ] å‘½ä»¤æäº¤å’Œå®Œæˆ
  - [ ] å¤šé˜Ÿåˆ—æ”¯æŒ

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 7.3 å›¾å½¢å’Œè¾“å…¥
- [ ] **å¸§ç¼“å†²** (`drivers/framebuffer.rs`)
  - [ ] vesafb/efifb
  - [ ] å›¾å½¢æ¨¡å¼è®¾ç½®
- [ ] **é”®ç›˜é©±åŠ¨** (`drivers/keyboard.rs`)
  - [ ] PS/2 é”®ç›˜
  - [ ] USB é”®ç›˜
- [ ] **é¼ æ ‡é©±åŠ¨** (`drivers/mouse.rs`)

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š5-7 å¤©ï¼ˆå¯é€‰ï¼‰

---

## Phase 8: ç”¨æˆ·ç©ºé—´

### 8.1 ç”¨æˆ·ç©ºé—´å·¥å…·
- [ ] **init è¿›ç¨‹**
  - [ ] PID 1 init
  - [ ] å¯åŠ¨è„šæœ¬è§£æž
  - [ ] è¿›ç¨‹ç®¡ç†
- [ ] **shell**
  - [ ] åŸºç¡€å‘½ä»¤æ”¯æŒ
  - [ ] ç®¡é“å’Œé‡å®šå‘
  - [ ] ä½œä¸šæŽ§åˆ¶
- [ ] **åŸºç¡€å‘½ä»¤**
  - [ ] `ls`ã€`cd`ã€`pwd`
  - [ ] `cat`ã€`echo`ã€`cp`ã€`mv`
  - [ ] `mkdir`ã€`rm`
  - [ ] `ps`ã€`top`ã€`kill`

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š7-10 å¤©

---

### 8.2 ç”¨æˆ·ç©ºé—´åº“
- [ ] **libc å…¼å®¹å±‚**
  - [ ] musl libc ç§»æ¤
  - [ ] æ ‡å‡†åº“å‡½æ•°
- [ ] **åŠ¨æ€é“¾æŽ¥å™¨**
  - [ ] ELF åŠ è½½å™¨
  - [ ] åŠ¨æ€é“¾æŽ¥
  - [ ] ç¬¦å·è§£æž

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼š14-21 å¤©

---

## Phase 9: ä¼˜åŒ–ä¸Žå®Œå–„

### 9.1 æ€§èƒ½ä¼˜åŒ–
- [ ] **æ€§èƒ½åˆ†æž**
  - [ ] ç«ç„°å›¾ç”Ÿæˆ
  - [ ] çƒ­ç‚¹åˆ†æž
- [ ] **å…³é”®è·¯å¾„ä¼˜åŒ–**
  - [ ] è°ƒåº¦å™¨ä¼˜åŒ–
  - [ ] å†…å­˜åˆ†é…ä¼˜åŒ–
  - [ ] ç³»ç»Ÿè°ƒç”¨ä¼˜åŒ–
- [ ] **å¹¶å‘ä¼˜åŒ–**
  - [ ] æ— é”ç®—æ³•
  - [ ] æ‰¹é‡å¤„ç†
  - [ ] ä¸­æ–­åˆå¹¶

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šæŒç»­è¿›è¡Œ**

---

### 9.2 ç¨³å®šæ€§æå‡
- [ ] **é”™è¯¯å¤„ç†**
  - [ ] é”™è¯¯æ¢å¤
  - [ ] æ•…éšœéš”ç¦»
  - [ ] å†…æ ¸è½¬å‚¨
- [ ] **æµ‹è¯•è¦†ç›–**
  - [ ] å•å…ƒæµ‹è¯•
  - [ ] é›†æˆæµ‹è¯•
  - [ ] åŽ‹åŠ›æµ‹è¯•
- [ ] **è°ƒè¯•å·¥å…·**
  - [ ] å†…æ ¸è°ƒè¯•å™¨
  - [ ] è¿è¡Œæ—¶è·Ÿè¸ª
  - [ ] æ€§èƒ½å‰–æž

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šæŒç»­è¿›è¡Œ**

---

### 9.3 æ–‡æ¡£å®Œå–„
- [ ] **ç”¨æˆ·æ–‡æ¡£**
  - [ ] å®‰è£…æŒ‡å—
  - [ ] ä½¿ç”¨æ‰‹å†Œ
  - [ ] æ•…éšœæŽ’æŸ¥
- [ ] **å¼€å‘è€…æ–‡æ¡£**
  - [ ] æž¶æž„è®¾è®¡
  - [ ] API æ–‡æ¡£
  - [ ] è´¡çŒ®æŒ‡å—
- [ ] **ç¤ºä¾‹ä»£ç **
  - [ ] é©±åŠ¨å¼€å‘ç¤ºä¾‹
  - [ ] åº”ç”¨ç¨‹åºç¤ºä¾‹

**é¢„è®¡å®Œæˆæ—¶é—´**ï¼šæŒç»­è¿›è¡Œ

---

## è¿›åº¦è¿½è¸ª

### å®Œæˆåº¦ç»Ÿè®¡

| Phase | æè¿° | å®Œæˆåº¦ | é¢„è®¡å·¥ä½œé‡ |
|-------|------|--------|-----------|
| Phase 1 | åŸºç¡€æ¡†æž¶ | âœ… 100% | 5 å¤© |
| Phase 2 | ä¸­æ–­ä¸Žè¿›ç¨‹ | âœ… 90% | 10 å¤© |
| Phase 3 | ç³»ç»Ÿè°ƒç”¨ä¸Žéš”ç¦» | âœ… 80% | 8 å¤© |
| Phase 4 | æ–‡ä»¶ç³»ç»Ÿ | âœ… 75% | 12 å¤© |
| Phase 5 | SMP æ”¯æŒ | âœ… 100% | 7 å¤© |
| Phase 6 | ä»£ç å®¡æŸ¥ | âœ… 100% | 3 å¤© |
| Phase 7 | å†…å­˜ç®¡ç†ä¼˜åŒ– | âœ… 100% | 1 å¤© |
| Phase 8 | Per-CPU ä¼˜åŒ– | âœ… 80% | 1 å¤© |
| Phase 9 | å¿«é€Ÿèƒœåˆ© | â³ 0% | 1.5-3 å¤© |
| Phase 10 | ç½‘ç»œä¸ŽIPC | â³ 0% | 21-31 å¤© |
| Phase 11 | å¤šå¹³å°æ”¯æŒ | â³ 0% | 17-24 å¤© |
| Phase 12 | è®¾å¤‡é©±åŠ¨ | â³ 0% | 12-17 å¤© |
| Phase 13 | ç”¨æˆ·ç©ºé—´ | â³ 0% | 21-31 å¤© |
| Phase 14 | ä¼˜åŒ–ä¸Žå®Œå–„ | â³ 0% | æŒç»­ |

**æ€»ä½“è¿›åº¦**ï¼šçº¦ 40%ï¼ˆPhase 1-8 åŸºæœ¬å®Œæˆï¼ŒPhase 9 å¿«é€Ÿèƒœåˆ©å¾…å®žçŽ°ï¼‰

---

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**å½“å‰é‡ç‚¹**ï¼ˆWeek 4-5ï¼ŒæŒ‰ä¼˜å…ˆçº§æŽ’åºï¼‰ï¼š

#### âœ… P0 - ä¸¥é‡ä¼˜å…ˆçº§ï¼ˆå·²å®Œæˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

**~~1. Per-CPU è¿è¡Œé˜Ÿåˆ—~~** âœ… **å·²å®Œæˆ (2025-02-04)**
- âœ… åˆ›å»º feature åˆ†æ”¯ï¼š`git checkout -b feat/per-cpu-runqueue`
- âœ… ä¿®æ”¹æ•°æ®ç»“æž„ï¼šå…¨å±€ RQ â†’ per-CPU æ•°ç»„
- âœ… å®žçŽ° `this_cpu_rq()` å‡½æ•°
- âœ… å®žçŽ° `cpu_rq(cpu_id)` å‡½æ•°
- âœ… å®žçŽ° `init_per_cpu_rq(cpu_id)` å‡½æ•°
- âœ… æ¬¡æ ¸è°ƒåº¦å™¨åˆå§‹åŒ–ï¼ˆåœ¨ `secondary_cpu_start` ä¸­è°ƒç”¨ï¼‰
- âœ… æ›´æ–° `schedule()` ä½¿ç”¨ `this_cpu_rq()`
- â³ è´Ÿè½½å‡è¡¡ï¼ˆä»»åŠ¡çªƒå–ï¼‰ - å»¶åŽè‡³ Phase 9
- âœ… éªŒè¯ï¼šåŒæ ¸ç‹¬ç«‹è°ƒåº¦ï¼Œæ— æ­»é”

**æäº¤è®°å½•**ï¼š
- commit b687710: "ä¼˜åŒ–å¯åŠ¨é¡ºåºï¼šGIC æå‰ï¼Œæ¬¡æ ¸åˆå§‹åŒ–å®Œå–„"

**å¾…å®Œæˆä¼˜åŒ–**ï¼ˆPhase 9ï¼‰ï¼š
- è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼ˆä»»åŠ¡è¿ç§»ï¼‰
- è´Ÿè½½æ£€æµ‹ç®—æ³•

---

#### ðŸ”´ P0 - é«˜ä¼˜å…ˆçº§ï¼ˆå½±å“æ­£ç¡®æ€§ï¼‰

**~~2. SimpleArc Clone æ”¯æŒ~~** âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] Clone trait å·²åœ¨ `collection.rs` å®žçŽ°
- [x] ä¿®å¤ RootFS æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- [x] éªŒè¯ï¼šç¼–è¯‘é€šè¿‡

**~~3. RootFS write_data offset bug~~** âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] ä¿®å¤ `write_data()` å‡½æ•°
- [x] æ”¯æŒä»Ž offset å¼€å§‹å†™å…¥
- [x] éªŒè¯ï¼šç¼–è¯‘é€šè¿‡

---

#### ðŸŸ¢ P2 - ä¸­ä¼˜å…ˆçº§ï¼ˆä¼˜åŒ–å’Œå®‰å…¨ï¼‰

~~**4. VFS å‡½æ•°æŒ‡é’ˆå®‰å…¨æ€§**ï¼ˆ2-3 å¤©ï¼‰~~ âœ… **å·²å®Œæˆ (2025-02-04)**
- [x] ä½¿ç”¨å¼•ç”¨å’Œåˆ‡ç‰‡æ›¿ä»£è£¸æŒ‡é’ˆ
- [x] FileOps å’Œ INodeOps æ”¹è¿›
- [x] æ›´æ–°æ‰€æœ‰å®žçŽ°ï¼ˆregã€pipeã€uartï¼‰

**5. Dentry/Inode ç¼“å­˜**ï¼ˆ2-3 å¤©ï¼‰
- [ ] å®žçŽ°å“ˆå¸Œè¡¨ç¼“å­˜
- [ ] LRU æ·˜æ±°ç­–ç•¥

**6. Task ç»“æž„ä½“ä¼˜åŒ–**ï¼ˆ1-2 å¤©ï¼‰
- [ ] CpuContext åˆ†ç¦»
- [ ] ä½¿ç”¨ Box åŒ…è£…å¤§åž‹å­—æ®µ
- [ ] ä¼˜åŒ–å­—æ®µå¸ƒå±€

---

#### âš¡ å¿«é€Ÿèƒœåˆ©ï¼ˆ1 å¤©å†…å®Œæˆï¼‰

å¦‚æžœæ—¶é—´æœ‰é™ï¼Œå»ºè®®æŒ‰æ­¤é¡ºåºï¼š
1. **RootFS write_data bug**ï¼ˆ30åˆ†é’Ÿï¼‰
2. **SimpleArc Clone**ï¼ˆ1-2å°æ—¶ï¼‰

---

**åŽç»­ç›®æ ‡**ï¼ˆPhase 8-9 å®ŒæˆåŽï¼‰ï¼š
1. è¿›ç¨‹è°ƒåº¦ç®—æ³•ä¼˜åŒ–ï¼ˆCFSï¼‰
2. å®Œå–„ä¿¡å·å¤„ç†æœºåˆ¶
3. å®Œæ•´çš„ IPC å®žçŽ°

---

## æŠ€æœ¯å€ºåŠ¡

### éœ€è¦é‡æž„çš„éƒ¨åˆ†
- ~~[ ] å®žçŽ°çœŸæ­£çš„å†…å­˜åˆ†é…å™¨~~ âœ… å·²å®Œæˆ - Buddy System å®žçŽ°å®Œæˆ
- ~~[ ] å®žçŽ°Per-CPU è¿è¡Œé˜Ÿåˆ—~~ âœ… å·²å®Œæˆ - Per-CPU æ•°æ®ç»“æž„å®Œæˆ
  - âœ… per-CPU è¿è¡Œé˜Ÿåˆ—æ•°ç»„ï¼ˆPER_CPU_RQ[4]ï¼‰
  - âœ… this_cpu_rq() / cpu_rq() è®¿é—®å‡½æ•°
  - âœ… æ¬¡æ ¸è‡ªåŠ¨åˆå§‹åŒ–
  - â³ è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼ˆPhase 9ï¼‰
- [ ] ç»Ÿä¸€é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] å®Œå–„æ—¥å¿—ç³»ç»Ÿ

### å·²çŸ¥é—®é¢˜

**ðŸ”´ ä¸¥é‡é—®é¢˜**ï¼ˆå¾…ä¿®å¤ï¼‰ï¼š
- ~~[ ] **å†…å­˜åˆ†é…å™¨æ— æ³•é‡Šæ”¾~~ âœ… å·²è§£å†³ - Buddy System å®Œæ•´å®žçŽ°
  - ~~å½“å‰ä½¿ç”¨ bump allocator~~ å·²æ›¿æ¢ä¸º Buddy System
  - ~~dealloc() æ˜¯ç©ºå®žçŽ°~~ å·²æ”¯æŒä¼™ä¼´åˆå¹¶
  - ~~éœ€è¦ï¼šBuddy System / Slab Allocator~~ âœ… Buddy System å·²å®žçŽ°
- ~~[ ] **å…¨å±€å•é˜Ÿåˆ—è°ƒåº¦å™¨~~ âœ… éƒ¨åˆ†å®Œæˆ - Per-CPU è¿è¡Œé˜Ÿåˆ—å®žçŽ°
  - âœ… æ‰€æœ‰ CPU æœ‰ç‹¬ç«‹çš„è¿è¡Œé˜Ÿåˆ—
  - âœ… this_cpu_rq() / cpu_rq() è®¿é—®å‡½æ•°
  - âœ… æ¬¡æ ¸è‡ªåŠ¨åˆå§‹åŒ–
  - â³ è´Ÿè½½å‡è¡¡æœºåˆ¶å¾…å®žçŽ°
  - **çŠ¶æ€**ï¼šâœ… åŸºç¡€å®Œæˆï¼ˆPhase 8ï¼‰ï¼Œè´Ÿè½½å‡è¡¡å¾…å®žæ–½ï¼ˆPhase 9ï¼‰

**ðŸŸ¡ ä¸­ç­‰é—®é¢˜**ï¼š
- [x] ~~SimpleArc Clone æ”¯æŒ~~ âœ… å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
- [x] ~~RootFS write_data offset bug~~ âœ… å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
- [x] ~~VFS å‡½æ•°æŒ‡é’ˆå®‰å…¨æ€§~~ âœ… å·²å®Œæˆï¼ˆ2025-02-04ï¼‰
  - ä½¿ç”¨å¼•ç”¨å’Œåˆ‡ç‰‡æ›¿ä»£è£¸æŒ‡é’ˆ
- [ ] Dentry/Inode ç¼“å­˜ - æ€§èƒ½é—®é¢˜
  - **è®¡åˆ’**ï¼šPhase 10 ä¸­ä¼˜å…ˆçº§

**ðŸŸ¢ ä½Žä¼˜å…ˆçº§**ï¼š
- [ ] Task ç»“æž„ä½“è¿‡å¤§ï¼ˆ660+ bytesï¼‰
- [ ] å‘½åçº¦å®šä¸ä¸€è‡´
- [ ] IPI æµ‹è¯•ä»£ç æ¸…ç†
- [ ] CpuContext åˆ†ç¦»ï¼ˆå†…æ ¸/ç”¨æˆ·å¯„å­˜å™¨ï¼‰

### å·²è§£å†³é—®é¢˜ âœ…
- [x] **MMU ä½¿èƒ½é—®é¢˜** - å·²è§£å†³ âœ…
  - ä½¿ç”¨ 3 çº§é¡µè¡¨ç»“æž„
  - æ­£ç¡®é…ç½® TCR_EL1ã€MAIR_EL1
  - MMU å·²æˆåŠŸå¯ç”¨
- [x] **GIC åˆå§‹åŒ–æŒ‚èµ·** - å·²è§£å†³ âœ…
  - è·³è¿‡ GICD å†…å­˜è®¿é—®
  - ä½¿ç”¨ç³»ç»Ÿå¯„å­˜å™¨æ›¿ä»£
- [x] **ä¸­æ–­é£Žæš´** - å·²è§£å†³ âœ…
  - ä¼˜åŒ– IRQ å¯ç”¨æ—¶åº
  - åœ¨ SMP åˆå§‹åŒ–å®ŒæˆåŽå¯ç”¨
- [x] **Buddy System å†…å­˜åˆ†é…å™¨** - å·²è§£å†³ âœ… (2025-02-04)
  - å®Œæ•´å®žçŽ°ä¼™ä¼´ç³»ç»Ÿç®—æ³•
  - æ”¯æŒ O(log n) åˆ†é…/é‡Šæ”¾
  - ä¼™ä¼´åˆå¹¶æœºåˆ¶å‡å°‘ç¢Žç‰‡
  - çº¿ç¨‹å®‰å…¨ï¼ˆåŽŸå­æ“ä½œï¼‰
  - æµ‹è¯•éªŒè¯é€šè¿‡

---

## å‚è€ƒèµ„æ–™

- [Linux ç³»ç»Ÿè°ƒç”¨è¡¨](https://man7.org/linux/man-pages/man2/syscalls.2.html)
- [ARMv8 æž¶æž„å‚è€ƒæ‰‹å†Œ](https://developer.arm.com/documentation/ddi0487/latest)
- [GICv3 è§„èŒƒ](https://developer.arm.com/documentation/ihi0069/latest)
- [OSDev Wiki](https://wiki.osdev.org/)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv0.3.0
**æœ€åŽæ›´æ–°**ï¼š2025-02-04
