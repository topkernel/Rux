# Rux 开发路线图与功能清单

## 项目概览

**当前状态**：Phase 21 完成 ✅ - 启动输出重构与结构化状态显示

**最后更新**：2026-02-17

**支持架构**：RISC-V 64位（RV64GC）- 唯一支持的架构

**代码统计**：45,204 行 Rust 代码

---

## 功能实现状态总表

| 一级功能 | 二级功能 | 三级功能 | 实现状态 | 测试状态 | 优先级 |
|---------|---------|---------|---------|---------|--------|
| **1. 启动与初始化** | | | | | |
| | 1.1 OpenSBI 集成 | M-mode 固件加载 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 内存布局（0x80200000） | ✅ 已实现 | ✅ 已测试 | P0 |
| | | S-mode 入口 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 设备树解析 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 1.2 启动代码 | 汇编启动入口 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 栈设置（16KB） | ✅ 已实现 | ✅ 已测试 | P0 |
| | | BSS 段清零 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Rust 代码跳转 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 数据段初始化 | ✅ 已实现 | ✅ 已测试 | P0 |
| | 1.3 UART 驱动 | ns16550a 驱动 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 字符输出 (putc) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 字符输入 (getc) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | println! 宏 | ✅ 已实现 | ✅ 已测试 | P0 |
| | |波特率配置 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | 1.4 CSR 管理 | sstatus | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sepc | ✅ 已实现 | ✅ 已测试 | P0 |
| | | stval | ✅ 已实现 | ✅ 已测试 | P0 |
| | | stvec | ✅ 已实现 | ✅ 已测试 | P0 |
| | | scause | ✅ 已实现 | ✅ 已测试 | P0 |
| | | satp | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sie/sip | ✅ 已实现 | ✅ 已测试 | P0 |
| | 1.5 早期打印 | boot 打印 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 错误输出 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 调试输出 | ⏳ 部分实现 | ⏳ 部分测试 | P2 |
| **2. 异常处理** | | | | | |
| | 2.1 异常向量表 | Direct 模式 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Vectored 模式 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 异常入口 | ✅ 已实现 | ✅ 已测试 | P0 |
| | 2.2 Trap 处理 | TrapFrame 保存 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 用户栈/内核栈切换 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 原始 sp 保存 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | CSR 寄存器保存 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | TrapFrame 恢复 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sret 返回 | ✅ 已实现 | ✅ 已测试 | P0 |
| | 2.3 异常类型 | 系统调用 (ecall) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 断点 (breakpoint) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 页错误 (page fault) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 缺页异常 (load/store) | ✅ 已实现 | ⏳ 部分测试 | P0 |
| | | 非法指令 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 用户态环保 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 对齐错误 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 浮点异常 | ❌ 未实现 | ❌ 未测试 | P2 |
| **3. 系统调用** | | | | | |
| | 3.1 系统调用框架 | 系统调用分发 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | SyscallFrame | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 系统调用号映射 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 返回值处理 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 参数验证 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | 3.2 文件系统系统调用 | sys_openat | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_close | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_read | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_write | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_lseek | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_fstat | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_fstatat | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_statx | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_access | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_ioctl | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_fcntl | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_fsync | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_fdatasync | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.3 进程管理系统调用 | sys_fork | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_vfork | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_execve | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_wait4 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_waitid | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_exit | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_exit_group | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_getpid | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_getppid | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_gettid | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_set_tid_address | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_kill | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_tgkill | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_getpriority | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_setpriority | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_prctl | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.4 信号系统调用 | sys_sigaction | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_rt_sigreturn | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_sigprocmask | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_sigpending | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_sigsuspend | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_sigaltstack | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_kill | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_pause | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.5 内存管理系统调用 | sys_brk | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_mmap | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_munmap | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_mprotect | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_mremap | ❌ 未实现 | ❌ 未测试 | P3 |
| | | sys_madvise | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_mincore | ❌ 未实现 | ❌ 未测试 | P3 |
| | 3.6 IPC 系统调用 | sys_pipe | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sys_pipe2 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_dup | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_dup2 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_dup3 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_select | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_pselect6 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_poll | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_epoll_create | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_epoll_ctl | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_epoll_wait | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_eventfd | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.7 消息队列 | sys_msgget | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_msgsnd | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_msgrcv | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_msgctl | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.8 共享内存 | sys_shmget | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_shmat | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_shmdt | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_shmctl | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.9 信号量 | sys_semget | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_semop | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_semctl | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.10 Socket 系统 | sys_socket | ✅ 已实现 | ✅ 已测试 | P1 |
| | | sys_bind | ✅ 已实现 | ✅ 已测试 | P1 |
| | | sys_connect | ✅ 已实现 | ✅ 已测试 | P1 |
| | | sys_listen | ✅ 已实现 | ✅ 已测试 | P1 |
| | | sys_accept | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_accept4 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_getsockname | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_getpeername | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_socketpair | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_send | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_recv | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_sendto | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_recvfrom | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sys_shutdown | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_setsockopt | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_getsockopt | ❌ 未实现 | ❌ 未测试 | P2 |
| | 3.11 其他系统调用 | sys_uname | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_sysinfo | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_getrlimit | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_setrlimit | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_getrusage | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_times | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_gettimeofday | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_clock_gettime | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_clock_settime | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_sched_yield | ❌ 未实现 | ❌ 未测试 | P2 |
| | | sys_clone | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sys_setns | ❌ 未实现 | ❌ 未测试 | P3 |
| | | sys_unshare | ❌ 未实现 | ❌ 未测试 | P3 |
| **4. 内存管理** | | | | | |
| | 4.1 物理内存管理 | PhysFrame | ✅ 已实现 | ✅ 已测试 | P0 |
| | | VirtPage | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 页大小 (4KB) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | FrameAllocator | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 物理内存区域检测 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 内存区域管理 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 热插拔 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 4.2 虚拟内存 (Sv39) | 3级页表结构 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 39位虚拟地址 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | PageTableEntry | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 页表创建 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 页表映射 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 区域映射 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 恒等映射 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | MMU 使能 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 平台无关接口 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 页表复制 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 页表共享 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 巨页支持 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 4.3 堆内存管理 | BuddyAllocator | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 伙伴合并算法 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 分配/释放 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 最大块 (order 12) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 边界检查修复 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Slab 分配器 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 对象缓存 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 4.4 用户内存管理 | 用户地址空间 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 地址空间布局 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | VMA 管理 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | mmap/munmap | ✅ 已实现 | ✅ 已测试 | P1 |
| | | brk 系统调用 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | fork 地址空间 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 栈扩展 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | guard 页 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 4.5 Copy-on-Write | 写时复制 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | fork COW | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 页保护 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 4.6 内存回收 | 页回收 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | LRU 换页 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | kswapd | ❌ 未实现 | ❌ 未测试 | P2 |
| | | OOM killer | ❌ 未实现 | ❌ 未测试 | P3 |
| **5. 进程管理** | | | | | |
| | 5.1 进程控制块 (PCB) | Task 结构 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | CpuContext | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 进程状态枚举 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 进程 ID 管理 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | PID 命名空间 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | Thread ID | ❌ 未实现 | ❌ 未测试 | P1 |
| | 5.2 进程树管理 | 父子关系 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 兄弟关系 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ListHead 双向链表 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 进程树遍历 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | init 进程 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 孤儿进程 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | 5.3 进程调度 | Per-CPU 运行队列 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Round Robin 算法 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 负载均衡 | ✅ 已实现 | ⏳ 部分测试 | P1 |
| | | 任务迁移 | ✅ 已实现 | ⏳ 部分测试 | P1 |
| | | 抢占式调度基础 | ✅ 已实现 | ⏳ 部分测试 | P1 |
| | | 时间片轮转 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | CFS 调度器 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 实时调度 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 调度域 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 5.4 上下文切换 | context_switch | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 通用寄存器保存 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ra/sp 保存 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 浮点寄存器保存 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 快速路径优化 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 5.5 用户模式支持 | U-mode 切换 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sstatus.SPP | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sepc 设置 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 用户栈设置 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | UXL 配置 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 用户程序加载 | ✅ 已实现 | ✅ 已测试 | P0 |
| | 5.6 信号处理 | SignalStruct | ✅ 已实现 | ✅ 已测试 | P0 |
| | | SigAction | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 信号掩码 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | SIGKILL/SIGSTOP | ✅ 已实现 | ✅ 已测试 | P0 |
| | | SIGCHLD 默认忽略 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 信号发送 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 信号处理函数 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 信号队列 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 实时信号 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 5.7 线程支持 | pthread 实现 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 线程本地存储 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 线程同步 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | set_tid_address | ❌ 未实现 | ❌ 未测试 | P2 |
| | 5.8 进程资源限制 | RLIMIT | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 资源限制管理 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | cgroup | ❌ 未实现 | ❌ 未测试 | P3 |
| **6. 中断与定时器** | | | | | |
| | 6.1 PLIC 中断控制器 | PLIC 初始化 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 中断优先级 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 中断使能 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Claim/Complete | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Spurious 处理 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 中断屏蔽 | ✅ 已实现 | ✅ 已测试 | P0 |
| | 6.2 外部中断 | UART 中断 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | VirtIO-blk 中断 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 外设中断支持 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 中断共享 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 中断线程化 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 6.3 定时器中断 | SBI TIMER | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sie.STIE | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 周期性中断 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | stvec Direct 模式 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 高精度定时器 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 定时器列表 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | itimer | ❌ 未实现 | ❌ 未测试 | P2 |
| | | posight timer | ❌ 未实现 | ❌ 未测试 | P1 |
| | 6.4 IPI 核间中断 | SGI 发送 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Reschedule IPI | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Stop IPI | ✅ 已实现 | ✅ 已测试 | P0 |
| | | IPI 处理 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | IPI 广播 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 6.5 软中断 | 软中断触发 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 软中断处理 | ❌ 未实现 | ❌ 未测试 | P2 |
| **7. SMP 多核** | | | | | |
| | 7.1 多核启动 | SBI HSM | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Hart ID 检测 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Boot Hart 识别 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 次核启动 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | CPU 数量检测 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 热插拔 CPU | ❌ 未实现 | ❌ 未测试 | P3 |
| | 7.2 Per-CPU 数据 | Per-CPU 栈 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Per-CPU 栈指针 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Per-CPU 运行队列 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | cpu_rq() 访问 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Per-CPU 变量 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | CPU 掩码 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 7.3 同步机制 | spin::Mutex | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 控制台同步 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 行级别锁 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | RwLock | ❌ 未实现 | ❌ 未测试 | P1 |
| | | SeqLock | ❌ 未实现 | ❌ 未测试 | P2 |
| | 7.4 原子操作 | AtomicUsize | ✅ 已实现 | ✅ 已测试 | P0 |
| | | AtomicPtr | ✅ 已实现 | ✅ 已测试 | P0 |
| | | CAS 操作 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | AtomicBool | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 原子位操作 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 7.5 RCU | RCU 实现 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 读拷贝更新 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | srcu_read_lock | ❌ 未实现 | ❌ 未测试 | P2 |
| | 7.6 内存屏障 | 编译器屏障 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 内存屏障指令 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | acquire/release | ❌ 未实现 | ❌ 未测试 | P2 |
| **8. 同步原语** | | | | | |
| | 8.1 信号量 | Semaphore | ✅ 已实现 | ✅ 已测试 | P0 |
| | | down() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | down_interruptible() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | down_trylock() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | up() | ✅ 已实现 | ✅ 已测试 | P0 |
| | 8.2 条件变量 | ConditionVariable | ✅ 已实现 | ✅ 已测试 | P0 |
| | | wait() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | wait_interruptible() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | signal() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | broadcast() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | wait_timeout | ❌ 未实现 | ❌ 未测试 | P1 |
| | 8.3 Mutex | Mutex (二值信号量) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | MutexGuard | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 死锁检测 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 8.4 读写锁 | RwLock | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 读锁 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 写锁 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 升级/降级 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 8.5 完成变量 | Completion | ❌ 未实现 | ❌ 未测试 | P1 |
| | | complete() | ❌ 未实现 | ❌ 未测试 | P1 |
| | | wait_for() | ❌ 未实现 | ❌ 未测试 | P1 |
| **9. 文件系统** | | | | | |
| | 9.1 VFS 框架 | file_open | ✅ 已实现 | ✅ 已测试 | P0 |
| | | file_close | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件标志 (FileFlags) | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 路径解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 绝对/相对路径 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | `.` 和 `..` | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 符号链接解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 路径规范化 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 路径验证 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 9.2 文件描述符 | FdTable | ✅ 已实现 | ✅ 已测试 | P0 |
| | | alloc_fd | ✅ 已实现 | ✅ 已测试 | P0 |
| | | install_fd | ✅ 已实现 | ✅ 已测试 | P0 |
| | | get_file | ✅ 已实现 | ✅ 已测试 | P0 |
| | | close_fd | ✅ 已实现 | ✅ 已测试 | P0 |
| | | fd 重用 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | fd 标志 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 文件锁 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 9.3 RootFS | 内存文件系统 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件创建 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件删除 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 目录创建 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 目录删除 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件查找 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件读取 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件写入 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件定位 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 目录遍历 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 权限管理 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 9.4 Dentry 缓存 | Dentry 结构 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | dcache_add | ✅ 已实现 | ✅ 已测试 | P0 |
| | | dcache_lookup | ✅ 已实现 | ✅ 已测试 | P0 |
| | | dcache_remove | ✅ 已实现 | ✅ 已测试 | P0 |
| | | LRU 淘汰 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 哈希表索引 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | dentry 复用 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | dentry 散列 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 9.5 Inode 缓存 | Inode 结构 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | icache_add | ✅ 已实现 | ✅ 已测试 | P0 |
| | | icache_lookup | ✅ 已实现 | ✅ 已测试 | P0 |
| | | icache_remove | ✅ 已实现 | ✅ 已测试 | P0 |
| | | LRU 淘汰 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 不同 Inode 类型 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Inode 回写 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | Inode 同步 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 9.6 超级块 | SuperBlock | ✅ 已实现 | ✅ 已测试 | P0 |
| | | superblock 操作 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 挂载点管理 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | VFS 挂载 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | VFS 卸载 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | bind mount | ❌ 未实现 | ❌ 未测试 | P2 |
| | | shared subtree | ❌ 未实现 | ❌ 未测试 | P3 |
| | 9.7 文件锁 | flock | ❌ 未实现 | ❌ 未测试 | P2 |
| | | fcntl 锁 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 租赁锁 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 强制锁 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 锁超时 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 9.8 文件权限 | 权限位 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | uid/gid | ❌ 未实现 | ❌ 未测试 | P2 |
| | | setuid/setgid | ❌ 未实现 | ❌ 未测试 | P2 |
| | | capability | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 访问控制列表 | ❌ 未实现 | ❌ 未测试 | P3 |
| **10. ELF 加载器** | | | | | |
| | 10.1 ELF 解析 | ELF 头解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 程序头解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 节头解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 动态链接 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 解释器 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | RISC-V EM_RISCV | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 其他架构支持 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 10.2 用户地址空间 | 页表创建 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | PT_LOAD 映射 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 用户栈分配 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 用户权限设置 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 地址随机化 (ASLR) | ❌ 未实现 | ❌ 未测试 | P2 |
| | 10.3 程序执行 | 入口点验证 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ELF 加载 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | mret 跳转 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 解释器执行 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | shebang | ❌ 未实现 | ❌ 未测试 | P2 |
| | 10.4 动态链接 | LD.so 加载 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | PLT/GOT | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 延迟绑定 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 全局偏移表 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 10.5 Core Dump | coredump | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 信号处理集成 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 寄存器保存 | ❌ 未实现 | ❌ 未测试 | P3 |
| **11. 块设备驱动** | | | | | |
| | 11.1 VirtIO 框架 | VirtIO 设备检测 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | VirtQueue | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 描述符链 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 通知机制 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 完成等待 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Modern VirtIO PCI | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Legacy VirtIO | ❌ 已移除 | ❌ 已移除 | - |
| | | MSI 支持 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 11.2 VirtIO-blk | 设备初始化 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 读块操作 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 写块操作 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 请求/响应 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | PCI 设备支持 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 多队列支持 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 丢弃支持 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 11.3 Buffer I/O | BufferHead | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 块缓存 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | bread() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | brelse() | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sync_dirty_buffer | ✅ 已实现 | ✅ 已测试 | P0 |
| | | bwrite() | ❌ 未实现 | ❌ 未测试 | P1 |
| | | bio_read() | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 提前读 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 回写策略 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 11.4 块设备框架 | GenDisk | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Request 队列 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | BlockDeviceOps | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 请求调度 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 电梯算法 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | CFQ 调度 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 11.5 其他设备 | VirtIO-net | ❌ 未实现 | ❌ 未测试 | P1 |
| | | VirtIO-console | ❌ 未实现 | ❌ 未测试 | P2 |
| | | VirtIO-balloon | ❌ 未实现 | ❌ 未测试 | P3 |
| | | VirtIO-gpu | ❌ 未实现 | ❌ 未测试 | P3 |
| | | NVMe 驱动 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | AHCI/SATA | ❌ 未实现 | ❌ 未测试 | P3 |
| | | SCSI 驱动 | ❌ 未实现 | ❌ 未测试 | P3 |
| **12. ext4 文件系统** | | | | | |
| | 12.1 ext4 基础 | 超级块解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 块组描述符 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Inode 结构 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 数据块提取 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ext4 挂载 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ext4 卸载 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 12.2 ext4 分配器 | BlockAllocator | ✅ 已实现 | ✅ 已测试 | P0 |
| | | alloc_block | ✅ 已实现 | ✅ 已测试 | P0 |
| | | free_block | ✅ 已实现 | ✅ 已测试 | P0 |
| | | InodeAllocator | ✅ 已实现 | ✅ 已测试 | P0 |
| | | alloc_inode | ✅ 已实现 | ✅ 已测试 | P0 |
| | | free_inode | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 位图管理 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 预分配 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 延迟初始化 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 12.3 ext4 操作 | 目录解析 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件查找 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件读取 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件写入 | ✅ 已实现 | ⏳ 部分测试 | P1 |
| | | 文件截断 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 文件扩展 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 文件定位 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 目录创建 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 目录删除 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 硬链接 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 软链接 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 权限更新 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 扩展属性 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 12.4 间接块 | 单级间接 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 索引计算 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 间接块遍历 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 双级间接 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 三级间接 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | Extent 树 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 块位图 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 目录索引 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 12.5 日志 | Journaling | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 事务 | ❌ | ❌ 未测试 | P3 |
| | | fsync | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 恢复 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 检查点 | ❌ 未实现 | ❌ 未测试 | P3 |
| **13. 进程状态扩展** | | | | | |
| | 13.1 TaskState | Running | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Interruptible | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Uninterruptible | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Zombie | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | Stopped | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | Dead/Traced | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 13.2 睡眠唤醒 | set_state | ✅ 已实现 | ✅ 已测试 | P0 |
| | | wake_up | ✅ 已实现 | ✅ 已测试 | P0 |
| | | sleep_on | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | interruptible_sleep | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | sleep_on_timeout | ❌ 未实现 | ❌ 未测试 | P1 |
| | | wait_queue | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | prepare_to_wait | ❌ 未实现 | ❌ 未测试 | P1 |
| | | finish_wait | ❌ 未实现 | ❌ 未测试 | P1 |
| | 13.3 时间管理 | jiffies 计数器 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | need_resched 标志 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 时间片管理 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 调度延迟统计 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 运行时间统计 | ❌ 未实现 | ❌ 未测试 | P2 |
| **14. 网络协议栈** | | | | | |
| | 14.1 Socket 层 | socket() | ✅ 已实现 | ✅ 已测试 | P1 |
| | | bind() | ✅ 已实现 | ✅ 已测试 | P1 |
| | | listen() | ✅ 已实现 | ✅ 已测试 | P1 |
| | | accept() | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | connect() | ✅ 已实现 | ✅ 已测试 | P1 |
| | | send/recv | ❌ 未实现 | ❌ 未测试 | P1 |
| | | sendto/recvfrom | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | shutdown() | ❌ 未实现 | ❌ 未测试 | P2 |
| | | getsockopt/setsockopt | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 14.2 TCP 协议 | TCP 连接 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 三次握手 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 四次挥手 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | 滑动窗口 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 拥塞控制 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 重传机制 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | TCP 状态机 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 14.3 UDP 协议 | UDP 数据报 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 校验和 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 广播/多播 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 14.4 IP 层 | IPv4 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | IPv6 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 路由表 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 分片 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | ICMP | ❌ 未实现 | ❌ 未测试 | P2 |
| | | ping/pong | ❌ 未实现 | ❌ 未测试 | P2 |
| | | ARP | ✅ 已实现 | ✅ 已测试 | P2 |
| | 14.5 网卡驱动 | VirtIO-net | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 数据包接收 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 数据包发送 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | 中断处理 | ✅ 已实现 | ✅ 已测试 | P1 |
| | | DMA | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 14.6 协议栈集成 | Socket 缓冲区 | ✅ 已实现 | ✅ 已测试 | P2 |
| | | skb 管理 | ✅ 已实现 | ✅ 已测试 | P2 |
| | | 协议分层 | ✅ 已实现 | ✅ 已测试 | P2 |
| **15. 单元测试** | | | | | |
| | 15.1 测试框架 | unit-test feature | ✅ 已实现 | ✅ 已测试 | P0 |
| | | test_* 模块 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 测试用例 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 测试输出 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 断言支持 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | mock 支持 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 15.2 数据结构测试 | ListHead 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Path 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | FileFlags 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | String 测试 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | HashMap 测试 | ❌ 未实现 | ❌ 未测试 | P1 |
| | 15.3 内存测试 | heap_allocator 测试 | ✅ 已实现 | ⏳ 部分测试 | P0 |
| | | page_allocator 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | BuddyAllocator 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 内存泄漏检测 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 15.4 进程测试 | scheduler 测试 | ✅ 已实现 | ⏳ 部分测试 | P0 |
| | | signal 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | process_tree 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | fork 测试 | ✅ 已实现 | ⏳ 部分测试 | P0 |
| | | execve 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | wait4 测试 | ✅ 已实现 | ⏳ 部分测试 | P0 |
| | | getpid 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 竞态测试 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 15.5 文件系统测试 | file_open 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | fdtable 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | dcache 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | icache 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 文件系统压力测试 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 15.6 设备驱动测试 | virtio_queue 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ext4_allocator 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | ext4_file_write 测试 | ✅ 已实现 | ⏳ 部分测试 | P0 |
| | | ext4_indirect_blocks 测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | 15.7 集成测试 | 系统启动测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 多核测试 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 压力测试 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 稳定性测试 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 回归测试 | ❌ 未实现 | ❌ 未测试 | P3 |
| **16. 构建与开发工具** | | | | | |
| | 16.1 构建系统 | Workspace | ✅ 已实现 | ✅ 已测试 | P0 |
| | | build.rs | ✅ 已实现 | ✅ 已测试 | P0 |
| | | Makefile | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 交叉编译 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 增量编译 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | release 优化 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 16.2 配置系统 | Kernel.toml | ✅ 已实现 | ✅ 已测试 | P0 |
| | | menuconfig | ✅ 已实现 | ✅ 已测试 | P0 |
| | | config.rs 生成 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 符号依赖 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 16.3 测试脚本 | test/run.sh | ✅ 已实现 | ✅ 已测试 | P0 |
| | | test/debug.sh | ✅ 已实现 | ✅ 已测试 | P0 |
| | | test/quick_test.sh | ✅ 已实现 | ✅ 已测试 | P0 |
| | | test/test_*.sh | ✅ 已实现 | ⏳ 部分测试 | P1 |
| | | test/all.sh | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | 16.4 调试工具 | GDB 支持 | ❌ 未实现 | ❌ | P1 |
| | | QEMU GDB | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 符号表 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 调试宏 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 日志系统 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 16.5 性能分析 | 性能计数器 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | flame graph | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 内存分析 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | CPU 使用率 | ❌ 未实现 | ❌ 未测试 | P2 |
| | 16.6 文档 | README | ✅ 已实现 | ✅ 已测试 | P0 |
| | | API 文档 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 开发指南 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 设计文档 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 代码注释 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| **17. 安全与隔离** | | | | | |
| | 17.1 用户态隔离 | 用户模式保护 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 权限检查 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | 特权指令 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | CSRs 保护 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 页保护 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | 17.2 地址空间 | 地址空间隔离 | ⏳ 部分实现 | ⏳ 部分测试 | P1 |
| | | ASLR | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 栈保护 | ❌ 未实现 | ❌ 未测试 | P1 |
| | | guard page | ❌ 未实现 | ❌ 未测试 | P1 |
| | 17.3 能力 | capability | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 权限检查 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 最小权限原则 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 17.4 审计 | selinux | ❌ 未实现 | ❌ 未测试 | P3 |
| | | apparmor | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 安全钩子 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 17.5 入侵检测 | 系统调用审计 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 行为分析 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 异常检测 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 17.6 加密 | 磁盘加密 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 文件加密 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 密钥管理 | ❌ 未实现 | ❌ 未测试 | P3 |
| **18. 电源管理** | | | | | |
| | 18.1 CPU 电源管理 | CPU idle | ✅ 已实现 | ✅ 已测试 | P0 |
| | | wfi 指令 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | 频率调节 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | CPU 热插拔 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 18.2 设备电源管理 | 设备休眠 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 设备唤醒 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 电源状态 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 18.3 系统睡眠 | suspend to RAM | ❌ 未实现 | ❌ 未测试 | P3 |
| | | hibernate | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 电源管理事件 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 18.4 休眠唤醒 | 唤醒源 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 唤醒定时器 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | rtc 驱动 | ❌ 未实现 | ❌ 未测试 | P3 |
| **19. 虚拟化** | | | | | |
| | 19.1 半虚拟化 | VirtIO 设备 | ✅ 已实现 | ✅ 已测试 | P0 |
| | | virtio-net | ✅ 已实现 | ✅ 已测试 | P1 |
| | | virtio-blk | ✅ 已实现 | ✅ 已测试 | P0 |
| | | virtio-console | ❌ 未实现 | ❌ 未测试 | P2 |
| | 19.2 完全虚拟化 | KVM | ❌ 未实现 | ❌ 未测试 | P3 |
| | | QEMU | ❌ 未实现 | ❌ 未测试 | P3 |
| | | HVM | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 19.3 容器支持 | namespace | ❌ 未实现 | ❌ 未测试 | P2 |
| | | cgroup | ❌ 未实现 | ❌ 未测试 | P2 |
| | | chroot | ❌ 未实现 | ❌ 未测试 | P1 |
| | | pivot_root | ❌ 未实现 | ❌ 未测试 | P2 |
| | 19.4 快照 | 内存快照 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 磁盘快照 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 恢复 | ❌ 未实现 | ❌ 未测试 | P3 |
| **20. 图形与多媒体** | | | | | |
| | 20.1 图形驱动 | framebuffer | ❌ 未实现 | ❌ 未测试 | P2 |
| | | VESA | ❌ 未实现 | ❌ 未测试 | P3 |
| | | display | ❌ 未实现 | ❌ 未测试 | P2 |
| | | GPU 驱动 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 20.2 输入设备 | 键盘驱动 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 鼠标驱动 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 触摸屏 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 游戏手柄 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 20.3 音频 | 音频驱动 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 混音器 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 编解码器 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 音频协议 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 20.4 视频 | 解码器 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 编码器 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 图形加速 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 20.5 桌面 | Wayland | ❌ 未实现 | ❌ 未测试 | P3 |
| | | X11 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | frame buffer | ❌ 未实现 | ❌ 未测试 | P2 |
| **21. 实时性** | | | | | |
| | 21.1 实时调度 | RT 调度器 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 优先级调度 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | EDF 调度 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 21.2 实时信号 | posix 信号 | ⏳ 部分实现 | ⏳ 部分测试 | P2 |
| | | 实时队列 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 优先级继承 | ❌ 未实现 | ❌ 未测试 | P2 |
| | | 21.3 同步原语 | 优先级继承锁 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 优先级天花板 | ❌ 未实现 | ❌ 未测试 | P3 |
| | 21.4 中断延迟 | 中断延迟优化 | ❌ 未实现 | ❌ 未测试 | P3 |
| | | 硬中断保护 | ❌ 未实现 | ❌ 未测试 | P2 |

---

## 功能统计

### 实现状态统计
- **✅ 已实现**: ~210 项功能 (+30 网络相关)
- **⏳ 部分实现**: ~85 项功能 (+5 网络相关)
- **❌ 未实现**: ~385 项功能

### 测试状态统计
- **✅ 已测试**: ~190 项功能 (+30 网络相关)
- **⏳ 部分测试**: ~65 项功能 (+5 网络相关)
- **❌ 未测试**: ~425 项功能

### 完成度
- **一级功能**: 21 个
- **二级功能**: 90 个
- **三级功能**: ~680 个

### 优先级分布
- **P0 (核心)**: ~180 项
- **P1 (重要)**: ~115 项 (-5 网络已完成)
- **P2 (增强)**: ~150 项
- **P3 (高级)**: ~230 项

---

## 开发阶段规划

### Phase 1-5: 基础内核 ✅ (已完成)
- 启动与初始化
- 异常处理
- 基础系统调用
- 内存管理
- 进程管理基础

### Phase 6-10: 核心功能 ✅ (已完成)
- 中断与定时器
- SMP 多核
- 同步原语
- 文件系统基础
- ELF 加载器

### Phase 11-15: 进阶功能 ✅ (已完成)
- 用户模式支持
- 进程管理完善
- 信号处理
- 管道与 IPC
- 单元测试框架

### Phase 16-17: 高级功能 ✅ (已完成)
- 抢占式调度基础
- 块设备驱动
- ext4 文件系统

### Phase 18: 网络协议栈 ✅ (已完成)
- **网络缓冲区** - SkBuff 实现
- **以太网层** - 帧收发、MAC 地址
- **ARP 协议** - 地址解析、缓存
- **IPv4 协议** - IP 头部、路由表、校验和
- **UDP 协议** - 数据报、Socket、校验和
- **TCP 协议** - 状态机、Socket、连接管理
- **VirtIO-net** - 网络设备驱动
- **Socket 系统调用** - socket/bind/listen/accept/connect/sendto/recvfrom

### Phase 18.5: 平台无关内存管理 ✅ (已完成)
- **pagemap 重构** - 平台无关接口（79行薄包装层）
- **VMA 操作** - mmap/munmap/brk/fork/allocate_stack 移至平台实现
- **类型统一** - AddressSpace 使用 mm/page 类型
- **测试修复** - SkBuff headroom 修复，测试通过率 163/166

### Phase 18.6: 代码重构和测试修复 ✅ (已完成)
- **VirtIO 探测代码重构** - virtio_probe 移至 drivers/virtio/ 目录
- **代码组织优化** - VirtIO 相关代码集中管理
- **单元测试修复** - network 测试 PANIC、SMP 测试编译错误
- **测试通过率** - 175/176 (99.4%)，仅 1 个预期失败

### Phase 19: Modern VirtIO PCI & Shell 运行 ✅ (已完成 - 2026-02-14)
- **Modern VirtIO PCI 驱动** - VirtIO 1.0+ PCI 传输层实现
  - 移除 Legacy VirtIO (v0.9.5) 支持，仅支持 Modern VirtIO
  - VirtIO PCI 设备探测和能力解析
  - 队列地址设置（queue_desc/driver/device 寄存器）
  - DMA 物理地址映射
- **ext4 extent 树支持** - 支持读取 extent 形式的文件数据块映射
- **Shell 运行成功** - 从 PCI VirtIO ext4 文件系统加载并运行 `/bin/sh`
  - Init 进程创建和调度
  - 用户模式 ELF 加载
  - Shell 提示符显示并可交互

### Phase 20: 多 Shell 支持和 cmdline 修复 ✅ (已完成 - 2026-02-15)
- **cmdline 解析修复**
  - 修复 DTB 指针传递问题（boot.S 通过 s0 保存 DTB 指针）
  - 修复 FDT 解析中的字符串匹配问题
  - 支持 `init=/bin/sh` 等启动参数配置
- **多 Shell 支持**
  - 默认 Shell (no_std Rust) - 完全可用，内置命令：echo/help/exit/time/pid
  - C Shell (musl libc) - 已移植到 musl libc，需要 argc/argv 初始化修复
  - Rust std Shell - 已支持 Rust std，需要 argc/argv 初始化修复
- **musl libc 工具链**
  - 添加 musl libc 构建脚本 (toolchain/build-musl.sh)
  - 添加 musl 程序链接器脚本 (userspace/musl.ld)
  - 支持静态链接的 musl C 程序
- **已知问题**
  - cshell 和 rust-shell 需要 UserContext 设置 argc/argv/栈初始化
  - musl libc 的 `__init_libc` 期望从栈读取 argc/argv

### Phase 21-22: 扩展功能 (规划中)
- **Shell 命令完善** - 支持更多内置命令
- **更多系统调用** - mmap/select 等
- **高级内存管理** - COW、缺页处理
- **安全机制** - capability、权限
- **电源管理** - CPU 频率调节、休眠

### Phase 23-25: 企业级特性 (远期)
- **虚拟化** - KVM、容器
- **图形界面** - framebuffer、Wayland
- **多媒体** - 音频、视频
- **实时性** - RT 调度器
- **高级安全** - selinux、审计

---

## 待实现功能详细列表

### 高优先级 (P1)
1. **内存管理**
   - [ ] sys_mmap - 系统调用接口
   - [x] sys_brk - 堆扩展 ✅ 已实现
   - [ ] sys_munmap - 系统调用接口
   - [ ] Copy-on-Write - 写时复制
   - [ ] 页错误处理完整实现
   - [x] 用户地址空间管理 ✅ 已实现（VMA 操作）

2. **进程管理**
   - [ ] sys_clone - 完整 clone
   - [ ] sys_set_tid_address - 线程 ID
   - [ ] sys_gettid - 获取线程 ID
   - [ ] sys_tgkill - 线程信号
   - [ ] 完整的僵尸进程回收
   - [ ] 进程资源限制

3. **文件系统**
   - [ ] sys_ioctl - 设备控制
   - [ ] sys_fcntl - 文件控制
   - [ ] 文件锁 (flock/fcntl)
   - [ ] 硬链接
   - [ ] 权限管理 (uid/gid)
   - [ ] 文件截断/扩展
   - [ ] 目录创建/删除

4. **IPC**
   - [ ] sys_pipe2 - pipe2
   - [ ] sys_select - I/O 多路复用
   - [ ] sys_poll - 事件轮询
   - [ ] sys_eventfd - 事件通知

5. **信号**
   - [ ] sys_sigprocmask - 信号掩码
   - [ ] sys_sigpending - 待处理信号
   - [ ] sys_rt_sigreturn - 信号返回
   - [ ] 信号队列
   - [ ] 实时信号

### 中优先级 (P2)
1. **高级系统调用**
   - [ ] sys_mprotect - 内存保护
   - [ ] sys_mremap - 重新映射
   - [ ] sys_mincore - 页查询
   - [ ] sys_getrlimit/setrlimit - 资源限制
   - [ ] sys_prctl - 进程控制
   - [ ] sys_uname - 系统信息

2. **高级 IPC**
   - [ ] sys_msgget - 消息队列
   - [ ] sys_shmget - 共享内存
   - [ ] sys_semget - 信号量
   - [ ] epoll 系列

3. **内存管理**
   - [ ] Slab 分配器
   - [ ] 对象缓存
   - [ ] 页回收
   - [ ] LRU 换页
   - [ ] OOM killer

4. **定时器**
   - [ ] POSIX 定时器
   - [ ] 高精度定时器
   - [ ] 定时器列表
   - [ ] itimer

5. **同步原语**
   - [ ] RwLock - 读写锁
   - [ ] SeqLock - 顺序锁
   - [ ] Completion - 完成变量
   - [ ] wait_timeout - 超时等待

### 低优先级 (P3)
1. **虚拟化**
   - [ ] KVM 支持
   - [ ] 容器支持
   - [ ] namespace
   - [ ] cgroup

2. **安全**
   - [ ] capability
   - [ ] selinux
   - [ ] 审计
   - [ ] 加密

3. **电源管理**
   - [ ] CPU 频率调节
   - [ ] 休眠/唤醒
   - [ ] 热插拔 CPU

4. **图形**
   - [ ] framebuffer
   - [ ] Wayland/X11
   - [ ] GPU 驱动

---

## 图例

- ✅ **已完成/已测试** - 功能完整实现并通过测试
- ⏳ **部分实现/部分测试** - 功能基本实现但有限制或测试未完全通过
- ❌ **未实现/未测试** - 功能尚未实现

**优先级**:
- **P0**: 核心功能，必须实现
- **P1**: 重要功能，应该实现
- **P2**: 增强功能，可以添加
- **P3**: 高级功能，可选实现

---

**文档版本**: v3.5
**最后更新**: 2026-02-15
**维护者**: Rux 开发团队
